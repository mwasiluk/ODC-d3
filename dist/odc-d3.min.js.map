{"version":3,"sources":["node_modules/browser-pack/_prelude.js","odc-d3.js","bower_components/d3-legend/no-extend.js","bower_components/d3-legend/src/color.js","bower_components/d3-legend/src/legend.js","bower_components/d3-legend/src/size.js","bower_components/d3-legend/src/symbol.js","bower_components/simple-statistics/src/error_function.js","bower_components/simple-statistics/src/linear_regression.js","bower_components/simple-statistics/src/linear_regression_line.js","bower_components/simple-statistics/src/mean.js","bower_components/simple-statistics/src/sample_correlation.js","bower_components/simple-statistics/src/sample_covariance.js","bower_components/simple-statistics/src/sample_standard_deviation.js","bower_components/simple-statistics/src/sample_variance.js","bower_components/simple-statistics/src/standard_deviation.js","bower_components/simple-statistics/src/sum.js","bower_components/simple-statistics/src/sum_nth_power_deviations.js","bower_components/simple-statistics/src/variance.js","bower_components/simple-statistics/src/z_score.js","src/chart.js","src/correlation-matrix.js","src/d3-extensions.js","src/index.js","src/legend.js","src/regression.js","src/scatterplot-matrix.js","src/scatterplot.js","src/statistics-distributions.js","src/statistics-utils.js","src/utils.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","ODCD3","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","color","size","symbol","./src/color","./src/size","./src/symbol","2","helper","legend","svg","type","d3_calcType","scale","ascending","cells","labels","labelFormat","labelDelimiter","legendG","selectAll","data","enter","append","attr","classPrefix","cell","cellEnter","style","shapes","shape","select","d3_addEvents","legendDispatcher","exit","transition","remove","d3_drawShapes","shapeHeight","shapeWidth","shapeRadius","path","d3_addText","text","shapeSize","map","d","getBBox","useClass","feature","cellTrans","textTrans","textAlign","labelAlign","orient","height","shapePadding","width","x","labelOffset","y","d3_placement","d3_title","title","d3","linear","format","dispatch","_","arguments","toLowerCase","rebind","./legend","3","d3_identity","d3_mergeLabels","gen","push","d3_linearLegend","domain","increment","d3_quantLegend","range","invert","invertExtent","d3_ordinalLegend","ticks","d3_reverse","arr","mirror","dispatcher","on","d3_cellOver","d3_cellOut","d3_cellClick","cellDispatcher","obj","cellover","cellout","cellclick","cellsSvg","titleText","yOffset","xOffset","4","shapeEnter","bbox","stroke","maxH","max","maxW","sum","slice","5","6","errorFunction","Math","abs","tau","exp","pow","7","linearRegression","m","b","dataLength","point","sumX","sumY","sumXX","sumXY","8","linearRegressionLine","mb","9","mean","NaN","./sum","10","sampleCorrelation","cov","sampleCovariance","xstd","sampleStandardDeviation","ystd","./sample_covariance","./sample_standard_deviation","11","xmean","ymean","besselsCorrection","./mean","12","sampleVarianceX","sampleVariance","isNaN","sqrt","./sample_variance","13","sumSquaredDeviationsValue","sumNthPowerDeviations","./sum_nth_power_deviations","14","standardDeviation","v","variance","./variance","15","correctedCurrentValue","nextSum","errorCompensation","16","meanValue","17","18","zScore","19","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","Chart","ChartConfig","undefined","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_utils","custom","cssClassPrefix","svgClass","margin","left","right","top","bottom","tooltip","Utils","deepExtend","base","config","utils","plot","_attached","_layers","_events","_isInitialized","_isAttached","baseContainer","setConfig","setData","init","postInit","initPlot","initSvg","initTooltip","draw","svgG","selectOrAppend","attachmentData","attachmentName","update","chart","name","callback","context","events","_chart","once","off","apply","names","event","j","keys","splice","ev","args","Array","getBaseContainer","node","clazz","addDot","availableWidth","availableHeight","./utils","20","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","CorrelationMatrix","CorrelationMatrixConfig","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","_statisticsUtils","_legend","_scatterplot","_ChartConfig","_this","guides","highlightLabels","variables","variableKey","correlation","xValues","yValues","StatisticsUtils","sizeMin","sizeMax","padding","_Chart","placeholderSelector","conf","matrix","setupVariables","placeholderNode","getBaseContainerNode","parentWidth","getBoundingClientRect","cellSize","min","setupVariablesScales","setupCorrelationScales","setupCorrelationMatrix","rangeBands","corrConf","cellConf","radiusMax","radiusScale","radius","c","radiusX","radiusY","rotateVal","variablesConf","domainByVariable","inferVariables","groups","includeInPlot","labelByVariable","forEach","index","extent","label","matrixCells","variableToValues","v1","row","v2","corr","rowVar","colVar","col","newData","updateCells","updateVariableLabels","updateLegend","labelClass","prefixClass","labelXClass","labelYClass","labelsX","labelsY","cellClass","cellShape","classed","scatterPlot","selector","wrongShapes","mouseoverCallbacks","mouseoutCallbacks","duration","html","pageX","pageY","highlightClass","xLabelClass","yLabelClass","trigger","legendX","legendY","barWidth","barHeight","Legend","linearGradientBar","containerSelector","_this3","scatterPlotConfig","showLegend","ScatterPlot","attach","./chart","./scatterplot","./statistics-utils","21","D3Extensions","selection","insertSelector","before","appendSelector","selectOrInsert","22","RegressionConfig","Regression","ScatterPlotMatrixConfig","ScatterPlotMatrix","ScatterPlotConfig","_scatterplotMatrix","_correlationMatrix","_regression","_d3Extensions","extend","./correlation-matrix","./d3-extensions","./regression","./scatterplot-matrix","23","_noExtend","legendParent","legendClass","container","gradientId","linearGradient","ticksNumber","../bower_components/d3-legend/no-extend","24","_ScatterPlotConfig","mainRegression","groupRegression","confidence","level","criticalValue","degreesOfFreedom","criticalProbability","tValue","marginOfError","_ScatterPlot","initRegressionLines","groupsAvailable","regressions","regression","initRegression","initGroupRegression","dataByGroup","groupVal","hasOwnProperty","values","points","parseFloat","extentX","linePoints","line","interpolate","dot","defaultColor","isFunction","computeConfidence","group","alpha","meanX","xMySum","xSum","xPowSum","ySum","yPowSum","p","Sa2","Sy2","errorFn","computeConfidenceAreaPoint","moe","confDown","confUp","y0","y1","centerX","confidenceAreaPoints","fitInPlot","confidenceArea","area","updateRegressionLines","regressionContainerClass","regressionContainerSelector","clipPathId","regressionContainer","dotsContainerClass","regressionContainerClip","regressionClass","confidenceAreaClass","regressionSelector","25","brush","boundingClientRect","maxWidth","setupX","setupY","d3ColorCategory","colorCategory","colorValue","String","subplots","variable","axis","tickSize","plotSubplot","frameClass","subplot","dots","axisClass","axisXClass","axisYClass","xAxisSelector","yAxisSelector","noGuidesClass","each","cross","drawBrush","filter","brushstart","brushCell","clear","brushmove","brushend","empty","legendLinear","26","computePlotSize","drawAxisX","drawAxisY","axisConf","updateDots","dotClass","dotsContainer","dotsT","27","tdistr","$n","$p","integer","precision_string","_subt","_subu","$y","log","$x","$u","$u2","$a","$b","$c","$d","$e","log10","$round","$p1","_subtprob","$n1","$delta","PI","round_to_precision","$w","atan2","$z","cos","$i","sin","$max","precision","SIGNIFICANT","round","floor","ceil","28","_statisticsDistributions","su","standardError","../bower_components/simple-statistics/src/error_function","../bower_components/simple-statistics/src/linear_regression","../bower_components/simple-statistics/src/linear_regression_line","../bower_components/simple-statistics/src/mean","../bower_components/simple-statistics/src/sample_correlation","../bower_components/simple-statistics/src/sample_standard_deviation","../bower_components/simple-statistics/src/standard_deviation","../bower_components/simple-statistics/src/variance","../bower_components/simple-statistics/src/z_score","./statistics-distributions","29","_defineProperty","_typeof","Symbol","iterator","out","isArray","source","isObject","srcObj","output","assign","isObjectNotArray","mergeDeep","groupKey","includeGroup","res","prop","indexOf","item","operation","selectorParts","split","element","shift","selectorModifier","selectorItem","insertOrAppendSelector","x1","x2","y2","defs","stops","sanitizeHeight","parseInt","sanitizeWidth"],"mappings":"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","file":"odc-d3.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.ODCD3 = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nmodule.exports = {\n  color: require('./src/color'),\n  size: require('./src/size'),\n  symbol: require('./src/symbol')\n};\n\n},{\"./src/color\":2,\"./src/size\":4,\"./src/symbol\":5}],2:[function(require,module,exports){\n\"use strict\";\n\nvar helper = require('./legend');\n\nmodule.exports = function () {\n\n  var scale = d3.scale.linear(),\n      shape = \"rect\",\n      shapeWidth = 15,\n      shapeHeight = 15,\n      shapeRadius = 10,\n      shapePadding = 2,\n      cells = [5],\n      labels = [],\n      classPrefix = \"\",\n      useClass = false,\n      title = \"\",\n      labelFormat = d3.format(\".01f\"),\n      labelOffset = 10,\n      labelAlign = \"middle\",\n      labelDelimiter = \"to\",\n      orient = \"vertical\",\n      ascending = false,\n      path,\n      legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\n\n  function legend(svg) {\n\n    var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\n        legendG = svg.selectAll('g').data([scale]);\n\n    legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\n\n    var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6),\n        shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"),\n        shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\n\n    //add event handlers\n    helper.d3_addEvents(cellEnter, legendDispatcher);\n\n    cell.exit().transition().style(\"opacity\", 0).remove();\n\n    helper.d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, path);\n\n    helper.d3_addText(legendG, cellEnter, type.labels, classPrefix);\n\n    // sets placement\n    var text = cell.select(\"text\"),\n        shapeSize = shapes[0].map(function (d) {\n      return d.getBBox();\n    });\n\n    //sets scale\n    //everything is fill except for line which is stroke,\n    if (!useClass) {\n      if (shape == \"line\") {\n        shapes.style(\"stroke\", type.feature);\n      } else {\n        shapes.style(\"fill\", type.feature);\n      }\n    } else {\n      shapes.attr(\"class\", function (d) {\n        return classPrefix + \"swatch \" + type.feature(d);\n      });\n    }\n\n    var cellTrans,\n        textTrans,\n        textAlign = labelAlign == \"start\" ? 0 : labelAlign == \"middle\" ? 0.5 : 1;\n\n    //positions cells and text\n    if (orient === \"vertical\") {\n      cellTrans = function cellTrans(d, i) {\n        return \"translate(0, \" + i * (shapeSize[i].height + shapePadding) + \")\";\n      };\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (shapeSize[i].width + shapeSize[i].x + labelOffset) + \",\" + (shapeSize[i].y + shapeSize[i].height / 2 + 5) + \")\";\n      };\n    } else if (orient === \"horizontal\") {\n      cellTrans = function cellTrans(d, i) {\n        return \"translate(\" + i * (shapeSize[i].width + shapePadding) + \",0)\";\n      };\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (shapeSize[i].width * textAlign + shapeSize[i].x) + \",\" + (shapeSize[i].height + shapeSize[i].y + labelOffset + 8) + \")\";\n      };\n    }\n\n    helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\n    helper.d3_title(svg, legendG, title, classPrefix);\n\n    cell.transition().style(\"opacity\", 1);\n  }\n\n  legend.scale = function (_) {\n    if (!arguments.length) return scale;\n    scale = _;\n    return legend;\n  };\n\n  legend.cells = function (_) {\n    if (!arguments.length) return cells;\n    if (_.length > 1 || _ >= 2) {\n      cells = _;\n    }\n    return legend;\n  };\n\n  legend.shape = function (_, d) {\n    if (!arguments.length) return shape;\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\" || _ == \"path\" && typeof d === 'string') {\n      shape = _;\n      path = d;\n    }\n    return legend;\n  };\n\n  legend.shapeWidth = function (_) {\n    if (!arguments.length) return shapeWidth;\n    shapeWidth = +_;\n    return legend;\n  };\n\n  legend.shapeHeight = function (_) {\n    if (!arguments.length) return shapeHeight;\n    shapeHeight = +_;\n    return legend;\n  };\n\n  legend.shapeRadius = function (_) {\n    if (!arguments.length) return shapeRadius;\n    shapeRadius = +_;\n    return legend;\n  };\n\n  legend.shapePadding = function (_) {\n    if (!arguments.length) return shapePadding;\n    shapePadding = +_;\n    return legend;\n  };\n\n  legend.labels = function (_) {\n    if (!arguments.length) return labels;\n    labels = _;\n    return legend;\n  };\n\n  legend.labelAlign = function (_) {\n    if (!arguments.length) return labelAlign;\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _;\n    }\n    return legend;\n  };\n\n  legend.labelFormat = function (_) {\n    if (!arguments.length) return labelFormat;\n    labelFormat = _;\n    return legend;\n  };\n\n  legend.labelOffset = function (_) {\n    if (!arguments.length) return labelOffset;\n    labelOffset = +_;\n    return legend;\n  };\n\n  legend.labelDelimiter = function (_) {\n    if (!arguments.length) return labelDelimiter;\n    labelDelimiter = _;\n    return legend;\n  };\n\n  legend.useClass = function (_) {\n    if (!arguments.length) return useClass;\n    if (_ === true || _ === false) {\n      useClass = _;\n    }\n    return legend;\n  };\n\n  legend.orient = function (_) {\n    if (!arguments.length) return orient;\n    _ = _.toLowerCase();\n    if (_ == \"horizontal\" || _ == \"vertical\") {\n      orient = _;\n    }\n    return legend;\n  };\n\n  legend.ascending = function (_) {\n    if (!arguments.length) return ascending;\n    ascending = !!_;\n    return legend;\n  };\n\n  legend.classPrefix = function (_) {\n    if (!arguments.length) return classPrefix;\n    classPrefix = _;\n    return legend;\n  };\n\n  legend.title = function (_) {\n    if (!arguments.length) return title;\n    title = _;\n    return legend;\n  };\n\n  d3.rebind(legend, legendDispatcher, \"on\");\n\n  return legend;\n};\n\n},{\"./legend\":3}],3:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n\n  d3_identity: function d3_identity(d) {\n    return d;\n  },\n\n  d3_mergeLabels: function d3_mergeLabels(gen, labels) {\n\n    if (labels.length === 0) return gen;\n\n    gen = gen ? gen : [];\n\n    var i = labels.length;\n    for (; i < gen.length; i++) {\n      labels.push(gen[i]);\n    }\n    return labels;\n  },\n\n  d3_linearLegend: function d3_linearLegend(scale, cells, labelFormat) {\n    var data = [];\n\n    if (cells.length > 1) {\n      data = cells;\n    } else {\n      var domain = scale.domain(),\n          increment = (domain[domain.length - 1] - domain[0]) / (cells - 1),\n          i = 0;\n\n      for (; i < cells; i++) {\n        data.push(domain[0] + i * increment);\n      }\n    }\n\n    var labels = data.map(labelFormat);\n\n    return { data: data,\n      labels: labels,\n      feature: function feature(d) {\n        return scale(d);\n      } };\n  },\n\n  d3_quantLegend: function d3_quantLegend(scale, labelFormat, labelDelimiter) {\n    var labels = scale.range().map(function (d) {\n      var invert = scale.invertExtent(d),\n          a = labelFormat(invert[0]),\n          b = labelFormat(invert[1]);\n\n      // if (( (a) && (a.isNan()) && b){\n      //   console.log(\"in initial statement\")\n      return labelFormat(invert[0]) + \" \" + labelDelimiter + \" \" + labelFormat(invert[1]);\n      // } else if (a || b) {\n      //   console.log('in else statement')\n      //   return (a) ? a : b;\n      // }\n    });\n\n    return { data: scale.range(),\n      labels: labels,\n      feature: this.d3_identity\n    };\n  },\n\n  d3_ordinalLegend: function d3_ordinalLegend(scale) {\n    return { data: scale.domain(),\n      labels: scale.domain(),\n      feature: function feature(d) {\n        return scale(d);\n      } };\n  },\n\n  d3_drawShapes: function d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, path) {\n    if (shape === \"rect\") {\n      shapes.attr(\"height\", shapeHeight).attr(\"width\", shapeWidth);\n    } else if (shape === \"circle\") {\n      shapes.attr(\"r\", shapeRadius); //.attr(\"cx\", shapeRadius).attr(\"cy\", shapeRadius);\n    } else if (shape === \"line\") {\n      shapes.attr(\"x1\", 0).attr(\"x2\", shapeWidth).attr(\"y1\", 0).attr(\"y2\", 0);\n    } else if (shape === \"path\") {\n      shapes.attr(\"d\", path);\n    }\n  },\n\n  d3_addText: function d3_addText(svg, enter, labels, classPrefix) {\n    enter.append(\"text\").attr(\"class\", classPrefix + \"label\");\n    svg.selectAll(\"g.\" + classPrefix + \"cell text\").data(labels).text(this.d3_identity);\n  },\n\n  d3_calcType: function d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter) {\n    var type = scale.ticks ? this.d3_linearLegend(scale, cells, labelFormat) : scale.invertExtent ? this.d3_quantLegend(scale, labelFormat, labelDelimiter) : this.d3_ordinalLegend(scale);\n\n    type.labels = this.d3_mergeLabels(type.labels, labels);\n\n    if (ascending) {\n      type.labels = this.d3_reverse(type.labels);\n      type.data = this.d3_reverse(type.data);\n    }\n\n    return type;\n  },\n\n  d3_reverse: function d3_reverse(arr) {\n    var mirror = [];\n    for (var i = 0, l = arr.length; i < l; i++) {\n      mirror[i] = arr[l - i - 1];\n    }\n    return mirror;\n  },\n\n  d3_placement: function d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign) {\n    cell.attr(\"transform\", cellTrans);\n    text.attr(\"transform\", textTrans);\n    if (orient === \"horizontal\") {\n      text.style(\"text-anchor\", labelAlign);\n    }\n  },\n\n  d3_addEvents: function d3_addEvents(cells, dispatcher) {\n    var _ = this;\n\n    cells.on(\"mouseover.legend\", function (d) {\n      _.d3_cellOver(dispatcher, d, this);\n    }).on(\"mouseout.legend\", function (d) {\n      _.d3_cellOut(dispatcher, d, this);\n    }).on(\"click.legend\", function (d) {\n      _.d3_cellClick(dispatcher, d, this);\n    });\n  },\n\n  d3_cellOver: function d3_cellOver(cellDispatcher, d, obj) {\n    cellDispatcher.cellover.call(obj, d);\n  },\n\n  d3_cellOut: function d3_cellOut(cellDispatcher, d, obj) {\n    cellDispatcher.cellout.call(obj, d);\n  },\n\n  d3_cellClick: function d3_cellClick(cellDispatcher, d, obj) {\n    cellDispatcher.cellclick.call(obj, d);\n  },\n\n  d3_title: function d3_title(svg, cellsSvg, title, classPrefix) {\n    if (title !== \"\") {\n\n      var titleText = svg.selectAll('text.' + classPrefix + 'legendTitle');\n\n      titleText.data([title]).enter().append('text').attr('class', classPrefix + 'legendTitle');\n\n      svg.selectAll('text.' + classPrefix + 'legendTitle').text(title);\n\n      var yOffset = svg.select('.' + classPrefix + 'legendTitle').map(function (d) {\n        return d[0].getBBox().height;\n      })[0],\n          xOffset = -cellsSvg.map(function (d) {\n        return d[0].getBBox().x;\n      })[0];\n\n      cellsSvg.attr('transform', 'translate(' + xOffset + ',' + (yOffset + 10) + ')');\n    }\n  }\n};\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\n\nvar helper = require('./legend');\n\nmodule.exports = function () {\n\n  var scale = d3.scale.linear(),\n      shape = \"rect\",\n      shapeWidth = 15,\n      shapePadding = 2,\n      cells = [5],\n      labels = [],\n      useStroke = false,\n      classPrefix = \"\",\n      title = \"\",\n      labelFormat = d3.format(\".01f\"),\n      labelOffset = 10,\n      labelAlign = \"middle\",\n      labelDelimiter = \"to\",\n      orient = \"vertical\",\n      ascending = false,\n      path,\n      legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\n\n  function legend(svg) {\n\n    var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\n        legendG = svg.selectAll('g').data([scale]);\n\n    legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\n\n    var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6);\n    shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"), shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\n\n    //add event handlers\n    helper.d3_addEvents(cellEnter, legendDispatcher);\n\n    cell.exit().transition().style(\"opacity\", 0).remove();\n\n    //creates shape\n    if (shape === \"line\") {\n      helper.d3_drawShapes(shape, shapes, 0, shapeWidth);\n      shapes.attr(\"stroke-width\", type.feature);\n    } else {\n      helper.d3_drawShapes(shape, shapes, type.feature, type.feature, type.feature, path);\n    }\n\n    helper.d3_addText(legendG, cellEnter, type.labels, classPrefix);\n\n    //sets placement\n    var text = cell.select(\"text\"),\n        shapeSize = shapes[0].map(function (d, i) {\n      var bbox = d.getBBox();\n      var stroke = scale(type.data[i]);\n\n      if (shape === \"line\" && orient === \"horizontal\") {\n        bbox.height = bbox.height + stroke;\n      } else if (shape === \"line\" && orient === \"vertical\") {\n        bbox.width = bbox.width;\n      }\n\n      return bbox;\n    });\n\n    var maxH = d3.max(shapeSize, function (d) {\n      return d.height + d.y;\n    }),\n        maxW = d3.max(shapeSize, function (d) {\n      return d.width + d.x;\n    });\n\n    var cellTrans,\n        textTrans,\n        textAlign = labelAlign == \"start\" ? 0 : labelAlign == \"middle\" ? 0.5 : 1;\n\n    //positions cells and text\n    if (orient === \"vertical\") {\n\n      cellTrans = function cellTrans(d, i) {\n        var height = d3.sum(shapeSize.slice(0, i + 1), function (d) {\n          return d.height;\n        });\n        return \"translate(0, \" + (height + i * shapePadding) + \")\";\n      };\n\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (maxW + labelOffset) + \",\" + (shapeSize[i].y + shapeSize[i].height / 2 + 5) + \")\";\n      };\n    } else if (orient === \"horizontal\") {\n      cellTrans = function cellTrans(d, i) {\n        var width = d3.sum(shapeSize.slice(0, i + 1), function (d) {\n          return d.width;\n        });\n        return \"translate(\" + (width + i * shapePadding) + \",0)\";\n      };\n\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (shapeSize[i].width * textAlign + shapeSize[i].x) + \",\" + (maxH + labelOffset) + \")\";\n      };\n    }\n\n    helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\n    helper.d3_title(svg, legendG, title, classPrefix);\n\n    cell.transition().style(\"opacity\", 1);\n  }\n\n  legend.scale = function (_) {\n    if (!arguments.length) return scale;\n    scale = _;\n    return legend;\n  };\n\n  legend.cells = function (_) {\n    if (!arguments.length) return cells;\n    if (_.length > 1 || _ >= 2) {\n      cells = _;\n    }\n    return legend;\n  };\n\n  legend.shape = function (_, d) {\n    if (!arguments.length) return shape;\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\") {\n      shape = _;\n      path = d;\n    }\n    return legend;\n  };\n\n  legend.shapeWidth = function (_) {\n    if (!arguments.length) return shapeWidth;\n    shapeWidth = +_;\n    return legend;\n  };\n\n  legend.shapePadding = function (_) {\n    if (!arguments.length) return shapePadding;\n    shapePadding = +_;\n    return legend;\n  };\n\n  legend.labels = function (_) {\n    if (!arguments.length) return labels;\n    labels = _;\n    return legend;\n  };\n\n  legend.labelAlign = function (_) {\n    if (!arguments.length) return labelAlign;\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _;\n    }\n    return legend;\n  };\n\n  legend.labelFormat = function (_) {\n    if (!arguments.length) return labelFormat;\n    labelFormat = _;\n    return legend;\n  };\n\n  legend.labelOffset = function (_) {\n    if (!arguments.length) return labelOffset;\n    labelOffset = +_;\n    return legend;\n  };\n\n  legend.labelDelimiter = function (_) {\n    if (!arguments.length) return labelDelimiter;\n    labelDelimiter = _;\n    return legend;\n  };\n\n  legend.orient = function (_) {\n    if (!arguments.length) return orient;\n    _ = _.toLowerCase();\n    if (_ == \"horizontal\" || _ == \"vertical\") {\n      orient = _;\n    }\n    return legend;\n  };\n\n  legend.ascending = function (_) {\n    if (!arguments.length) return ascending;\n    ascending = !!_;\n    return legend;\n  };\n\n  legend.classPrefix = function (_) {\n    if (!arguments.length) return classPrefix;\n    classPrefix = _;\n    return legend;\n  };\n\n  legend.title = function (_) {\n    if (!arguments.length) return title;\n    title = _;\n    return legend;\n  };\n\n  d3.rebind(legend, legendDispatcher, \"on\");\n\n  return legend;\n};\n\n},{\"./legend\":3}],5:[function(require,module,exports){\n\"use strict\";\n\nvar helper = require('./legend');\n\nmodule.exports = function () {\n\n  var scale = d3.scale.linear(),\n      shape = \"path\",\n      shapeWidth = 15,\n      shapeHeight = 15,\n      shapeRadius = 10,\n      shapePadding = 5,\n      cells = [5],\n      labels = [],\n      classPrefix = \"\",\n      useClass = false,\n      title = \"\",\n      labelFormat = d3.format(\".01f\"),\n      labelAlign = \"middle\",\n      labelOffset = 10,\n      labelDelimiter = \"to\",\n      orient = \"vertical\",\n      ascending = false,\n      legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\n\n  function legend(svg) {\n\n    var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\n        legendG = svg.selectAll('g').data([scale]);\n\n    legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\n\n    var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6);\n    shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"), shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\n\n    //add event handlers\n    helper.d3_addEvents(cellEnter, legendDispatcher);\n\n    //remove old shapes\n    cell.exit().transition().style(\"opacity\", 0).remove();\n\n    helper.d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, type.feature);\n    helper.d3_addText(legendG, cellEnter, type.labels, classPrefix);\n\n    // sets placement\n    var text = cell.select(\"text\"),\n        shapeSize = shapes[0].map(function (d) {\n      return d.getBBox();\n    });\n\n    var maxH = d3.max(shapeSize, function (d) {\n      return d.height;\n    }),\n        maxW = d3.max(shapeSize, function (d) {\n      return d.width;\n    });\n\n    var cellTrans,\n        textTrans,\n        textAlign = labelAlign == \"start\" ? 0 : labelAlign == \"middle\" ? 0.5 : 1;\n\n    //positions cells and text\n    if (orient === \"vertical\") {\n      cellTrans = function cellTrans(d, i) {\n        return \"translate(0, \" + i * (maxH + shapePadding) + \")\";\n      };\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (maxW + labelOffset) + \",\" + (shapeSize[i].y + shapeSize[i].height / 2 + 5) + \")\";\n      };\n    } else if (orient === \"horizontal\") {\n      cellTrans = function cellTrans(d, i) {\n        return \"translate(\" + i * (maxW + shapePadding) + \",0)\";\n      };\n      textTrans = function textTrans(d, i) {\n        return \"translate(\" + (shapeSize[i].width * textAlign + shapeSize[i].x) + \",\" + (maxH + labelOffset) + \")\";\n      };\n    }\n\n    helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\n    helper.d3_title(svg, legendG, title, classPrefix);\n    cell.transition().style(\"opacity\", 1);\n  }\n\n  legend.scale = function (_) {\n    if (!arguments.length) return scale;\n    scale = _;\n    return legend;\n  };\n\n  legend.cells = function (_) {\n    if (!arguments.length) return cells;\n    if (_.length > 1 || _ >= 2) {\n      cells = _;\n    }\n    return legend;\n  };\n\n  legend.shapePadding = function (_) {\n    if (!arguments.length) return shapePadding;\n    shapePadding = +_;\n    return legend;\n  };\n\n  legend.labels = function (_) {\n    if (!arguments.length) return labels;\n    labels = _;\n    return legend;\n  };\n\n  legend.labelAlign = function (_) {\n    if (!arguments.length) return labelAlign;\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _;\n    }\n    return legend;\n  };\n\n  legend.labelFormat = function (_) {\n    if (!arguments.length) return labelFormat;\n    labelFormat = _;\n    return legend;\n  };\n\n  legend.labelOffset = function (_) {\n    if (!arguments.length) return labelOffset;\n    labelOffset = +_;\n    return legend;\n  };\n\n  legend.labelDelimiter = function (_) {\n    if (!arguments.length) return labelDelimiter;\n    labelDelimiter = _;\n    return legend;\n  };\n\n  legend.orient = function (_) {\n    if (!arguments.length) return orient;\n    _ = _.toLowerCase();\n    if (_ == \"horizontal\" || _ == \"vertical\") {\n      orient = _;\n    }\n    return legend;\n  };\n\n  legend.ascending = function (_) {\n    if (!arguments.length) return ascending;\n    ascending = !!_;\n    return legend;\n  };\n\n  legend.classPrefix = function (_) {\n    if (!arguments.length) return classPrefix;\n    classPrefix = _;\n    return legend;\n  };\n\n  legend.title = function (_) {\n    if (!arguments.length) return title;\n    title = _;\n    return legend;\n  };\n\n  d3.rebind(legend, legendDispatcher, \"on\");\n\n  return legend;\n};\n\n},{\"./legend\":3}],6:[function(require,module,exports){\n'use strict';\n/* @flow */\n\n/**\r\n * **[Gaussian error function](http://en.wikipedia.org/wiki/Error_function)**\r\n *\r\n * The `errorFunction(x/(sd * Math.sqrt(2)))` is the probability that a value in a\r\n * normal distribution with standard deviation sd is within x of the mean.\r\n *\r\n * This function returns a numerical approximation to the exact value.\r\n *\r\n * @param {number} x input\r\n * @return {number} error estimation\r\n * @example\r\n * errorFunction(1); //= 0.8427\r\n */\n\nfunction errorFunction(x /*: number */) /*: number */{\n    var t = 1 / (1 + 0.5 * Math.abs(x));\n    var tau = t * Math.exp(-Math.pow(x, 2) - 1.26551223 + 1.00002368 * t + 0.37409196 * Math.pow(t, 2) + 0.09678418 * Math.pow(t, 3) - 0.18628806 * Math.pow(t, 4) + 0.27886807 * Math.pow(t, 5) - 1.13520398 * Math.pow(t, 6) + 1.48851587 * Math.pow(t, 7) - 0.82215223 * Math.pow(t, 8) + 0.17087277 * Math.pow(t, 9));\n    if (x >= 0) {\n        return 1 - tau;\n    } else {\n        return tau - 1;\n    }\n}\n\nmodule.exports = errorFunction;\n\n},{}],7:[function(require,module,exports){\n'use strict';\n/* @flow */\n\n/**\r\n * [Simple linear regression](http://en.wikipedia.org/wiki/Simple_linear_regression)\r\n * is a simple way to find a fitted line\r\n * between a set of coordinates. This algorithm finds the slope and y-intercept of a regression line\r\n * using the least sum of squares.\r\n *\r\n * @param {Array<Array<number>>} data an array of two-element of arrays,\r\n * like `[[0, 1], [2, 3]]`\r\n * @returns {Object} object containing slope and intersect of regression line\r\n * @example\r\n * linearRegression([[0, 0], [1, 1]]); // { m: 1, b: 0 }\r\n */\n\nfunction linearRegression(data /*: Array<Array<number>> */) /*: { m: number, b: number } */{\n\n    var m, b;\n\n    // Store data length in a local variable to reduce\n    // repeated object property lookups\n    var dataLength = data.length;\n\n    //if there's only one point, arbitrarily choose a slope of 0\n    //and a y-intercept of whatever the y of the initial point is\n    if (dataLength === 1) {\n        m = 0;\n        b = data[0][1];\n    } else {\n        // Initialize our sums and scope the `m` and `b`\n        // variables that define the line.\n        var sumX = 0,\n            sumY = 0,\n            sumXX = 0,\n            sumXY = 0;\n\n        // Use local variables to grab point values\n        // with minimal object property lookups\n        var point, x, y;\n\n        // Gather the sum of all x values, the sum of all\n        // y values, and the sum of x^2 and (x*y) for each\n        // value.\n        //\n        // In math notation, these would be SS_x, SS_y, SS_xx, and SS_xy\n        for (var i = 0; i < dataLength; i++) {\n            point = data[i];\n            x = point[0];\n            y = point[1];\n\n            sumX += x;\n            sumY += y;\n\n            sumXX += x * x;\n            sumXY += x * y;\n        }\n\n        // `m` is the slope of the regression line\n        m = (dataLength * sumXY - sumX * sumY) / (dataLength * sumXX - sumX * sumX);\n\n        // `b` is the y-intercept of the line.\n        b = sumY / dataLength - m * sumX / dataLength;\n    }\n\n    // Return both values as an object.\n    return {\n        m: m,\n        b: b\n    };\n}\n\nmodule.exports = linearRegression;\n\n},{}],8:[function(require,module,exports){\n'use strict';\n/* @flow */\n\n/**\r\n * Given the output of `linearRegression`: an object\r\n * with `m` and `b` values indicating slope and intercept,\r\n * respectively, generate a line function that translates\r\n * x values into y values.\r\n *\r\n * @param {Object} mb object with `m` and `b` members, representing\r\n * slope and intersect of desired line\r\n * @returns {Function} method that computes y-value at any given\r\n * x-value on the line.\r\n * @example\r\n * var l = linearRegressionLine(linearRegression([[0, 0], [1, 1]]));\r\n * l(0) //= 0\r\n * l(2) //= 2\r\n */\n\nfunction linearRegressionLine(mb /*: { b: number, m: number }*/) /*: Function */{\n    // Return a function that computes a `y` value for each\n    // x value it is given, based on the values of `b` and `a`\n    // that we just computed.\n    return function (x) {\n        return mb.b + mb.m * x;\n    };\n}\n\nmodule.exports = linearRegressionLine;\n\n},{}],9:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar sum = require('./sum');\n\n/**\r\n * The mean, _also known as average_,\r\n * is the sum of all values over the number of values.\r\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\r\n * a method of finding a typical or central value of a set of numbers.\r\n *\r\n * This runs on `O(n)`, linear time in respect to the array\r\n *\r\n * @param {Array<number>} x input values\r\n * @returns {number} mean\r\n * @example\r\n * console.log(mean([0, 10])); // 5\r\n */\nfunction mean(x /*: Array<number> */) /*:number*/{\n    // The mean of no numbers is null\n    if (x.length === 0) {\n        return NaN;\n    }\n\n    return sum(x) / x.length;\n}\n\nmodule.exports = mean;\n\n},{\"./sum\":15}],10:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar sampleCovariance = require('./sample_covariance');\nvar sampleStandardDeviation = require('./sample_standard_deviation');\n\n/**\r\n * The [correlation](http://en.wikipedia.org/wiki/Correlation_and_dependence) is\r\n * a measure of how correlated two datasets are, between -1 and 1\r\n *\r\n * @param {Array<number>} x first input\r\n * @param {Array<number>} y second input\r\n * @returns {number} sample correlation\r\n * @example\r\n * var a = [1, 2, 3, 4, 5, 6];\r\n * var b = [2, 2, 3, 4, 5, 60];\r\n * sampleCorrelation(a, b); //= 0.691\r\n */\nfunction sampleCorrelation(x /*: Array<number> */, y /*: Array<number> */) /*:number*/{\n    var cov = sampleCovariance(x, y),\n        xstd = sampleStandardDeviation(x),\n        ystd = sampleStandardDeviation(y);\n\n    return cov / xstd / ystd;\n}\n\nmodule.exports = sampleCorrelation;\n\n},{\"./sample_covariance\":11,\"./sample_standard_deviation\":12}],11:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar mean = require('./mean');\n\n/**\r\n * [Sample covariance](https://en.wikipedia.org/wiki/Sample_mean_and_sampleCovariance) of two datasets:\r\n * how much do the two datasets move together?\r\n * x and y are two datasets, represented as arrays of numbers.\r\n *\r\n * @param {Array<number>} x first input\r\n * @param {Array<number>} y second input\r\n * @returns {number} sample covariance\r\n * @example\r\n * var x = [1, 2, 3, 4, 5, 6];\r\n * var y = [6, 5, 4, 3, 2, 1];\r\n * sampleCovariance(x, y); //= -3.5\r\n */\nfunction sampleCovariance(x /*:Array<number>*/, y /*:Array<number>*/) /*:number*/{\n\n    // The two datasets must have the same length which must be more than 1\n    if (x.length <= 1 || x.length !== y.length) {\n        return NaN;\n    }\n\n    // determine the mean of each dataset so that we can judge each\n    // value of the dataset fairly as the difference from the mean. this\n    // way, if one dataset is [1, 2, 3] and [2, 3, 4], their covariance\n    // does not suffer because of the difference in absolute values\n    var xmean = mean(x),\n        ymean = mean(y),\n        sum = 0;\n\n    // for each pair of values, the covariance increases when their\n    // difference from the mean is associated - if both are well above\n    // or if both are well below\n    // the mean, the covariance increases significantly.\n    for (var i = 0; i < x.length; i++) {\n        sum += (x[i] - xmean) * (y[i] - ymean);\n    }\n\n    // this is Bessels' Correction: an adjustment made to sample statistics\n    // that allows for the reduced degree of freedom entailed in calculating\n    // values from samples rather than complete populations.\n    var besselsCorrection = x.length - 1;\n\n    // the covariance is weighted by the length of the datasets.\n    return sum / besselsCorrection;\n}\n\nmodule.exports = sampleCovariance;\n\n},{\"./mean\":9}],12:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar sampleVariance = require('./sample_variance');\n\n/**\r\n * The [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)\r\n * is the square root of the variance.\r\n *\r\n * @param {Array<number>} x input array\r\n * @returns {number} sample standard deviation\r\n * @example\r\n * ss.sampleStandardDeviation([2, 4, 4, 4, 5, 5, 7, 9]);\r\n * //= 2.138\r\n */\nfunction sampleStandardDeviation(x /*:Array<number>*/) /*:number*/{\n  // The standard deviation of no numbers is null\n  var sampleVarianceX = sampleVariance(x);\n  if (isNaN(sampleVarianceX)) {\n    return NaN;\n  }\n  return Math.sqrt(sampleVarianceX);\n}\n\nmodule.exports = sampleStandardDeviation;\n\n},{\"./sample_variance\":13}],13:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar sumNthPowerDeviations = require('./sum_nth_power_deviations');\n\n/*\r\n * The [sample variance](https://en.wikipedia.org/wiki/Variance#Sample_variance)\r\n * is the sum of squared deviations from the mean. The sample variance\r\n * is distinguished from the variance by the usage of [Bessel's Correction](https://en.wikipedia.org/wiki/Bessel's_correction):\r\n * instead of dividing the sum of squared deviations by the length of the input,\r\n * it is divided by the length minus one. This corrects the bias in estimating\r\n * a value from a set that you don't know if full.\r\n *\r\n * References:\r\n * * [Wolfram MathWorld on Sample Variance](http://mathworld.wolfram.com/SampleVariance.html)\r\n *\r\n * @param {Array<number>} x input array\r\n * @return {number} sample variance\r\n * @example\r\n * sampleVariance([1, 2, 3, 4, 5]); //= 2.5\r\n */\nfunction sampleVariance(x /*: Array<number> */) /*:number*/{\n    // The variance of no numbers is null\n    if (x.length <= 1) {\n        return NaN;\n    }\n\n    var sumSquaredDeviationsValue = sumNthPowerDeviations(x, 2);\n\n    // this is Bessels' Correction: an adjustment made to sample statistics\n    // that allows for the reduced degree of freedom entailed in calculating\n    // values from samples rather than complete populations.\n    var besselsCorrection = x.length - 1;\n\n    // Find the mean value of that list\n    return sumSquaredDeviationsValue / besselsCorrection;\n}\n\nmodule.exports = sampleVariance;\n\n},{\"./sum_nth_power_deviations\":16}],14:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar variance = require('./variance');\n\n/**\r\n * The [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)\r\n * is the square root of the variance. It's useful for measuring the amount\r\n * of variation or dispersion in a set of values.\r\n *\r\n * Standard deviation is only appropriate for full-population knowledge: for\r\n * samples of a population, {@link sampleStandardDeviation} is\r\n * more appropriate.\r\n *\r\n * @param {Array<number>} x input\r\n * @returns {number} standard deviation\r\n * @example\r\n * var scores = [2, 4, 4, 4, 5, 5, 7, 9];\r\n * variance(scores); //= 4\r\n * standardDeviation(scores); //= 2\r\n */\nfunction standardDeviation(x /*: Array<number> */) /*:number*/{\n  // The standard deviation of no numbers is null\n  var v = variance(x);\n  if (isNaN(v)) {\n    return 0;\n  }\n  return Math.sqrt(v);\n}\n\nmodule.exports = standardDeviation;\n\n},{\"./variance\":17}],15:[function(require,module,exports){\n'use strict';\n/* @flow */\n\n/**\r\n * Our default sum is the [Kahan summation algorithm](https://en.wikipedia.org/wiki/Kahan_summation_algorithm) is\r\n * a method for computing the sum of a list of numbers while correcting\r\n * for floating-point errors. Traditionally, sums are calculated as many\r\n * successive additions, each one with its own floating-point roundoff. These\r\n * losses in precision add up as the number of numbers increases. This alternative\r\n * algorithm is more accurate than the simple way of calculating sums by simple\r\n * addition.\r\n *\r\n * This runs on `O(n)`, linear time in respect to the array\r\n *\r\n * @param {Array<number>} x input\r\n * @return {number} sum of all input numbers\r\n * @example\r\n * console.log(sum([1, 2, 3])); // 6\r\n */\n\nfunction sum(x /*: Array<number> */) /*: number */{\n\n    // like the traditional sum algorithm, we keep a running\n    // count of the current sum.\n    var sum = 0;\n\n    // but we also keep three extra variables as bookkeeping:\n    // most importantly, an error correction value. This will be a very\n    // small number that is the opposite of the floating point precision loss.\n    var errorCompensation = 0;\n\n    // this will be each number in the list corrected with the compensation value.\n    var correctedCurrentValue;\n\n    // and this will be the next sum\n    var nextSum;\n\n    for (var i = 0; i < x.length; i++) {\n        // first correct the value that we're going to add to the sum\n        correctedCurrentValue = x[i] - errorCompensation;\n\n        // compute the next sum. sum is likely a much larger number\n        // than correctedCurrentValue, so we'll lose precision here,\n        // and measure how much precision is lost in the next step\n        nextSum = sum + correctedCurrentValue;\n\n        // we intentionally didn't assign sum immediately, but stored\n        // it for now so we can figure out this: is (sum + nextValue) - nextValue\n        // not equal to 0? ideally it would be, but in practice it won't:\n        // it will be some very small number. that's what we record\n        // as errorCompensation.\n        errorCompensation = nextSum - sum - correctedCurrentValue;\n\n        // now that we've computed how much we'll correct for in the next\n        // loop, start treating the nextSum as the current sum.\n        sum = nextSum;\n    }\n\n    return sum;\n}\n\nmodule.exports = sum;\n\n},{}],16:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar mean = require('./mean');\n\n/**\r\n * The sum of deviations to the Nth power.\r\n * When n=2 it's the sum of squared deviations.\r\n * When n=3 it's the sum of cubed deviations.\r\n *\r\n * @param {Array<number>} x\r\n * @param {number} n power\r\n * @returns {number} sum of nth power deviations\r\n * @example\r\n * var input = [1, 2, 3];\r\n * // since the variance of a set is the mean squared\r\n * // deviations, we can calculate that with sumNthPowerDeviations:\r\n * var variance = sumNthPowerDeviations(input) / input.length;\r\n */\nfunction sumNthPowerDeviations(x /*: Array<number> */, n /*: number */) /*:number*/{\n    var meanValue = mean(x),\n        sum = 0;\n\n    for (var i = 0; i < x.length; i++) {\n        sum += Math.pow(x[i] - meanValue, n);\n    }\n\n    return sum;\n}\n\nmodule.exports = sumNthPowerDeviations;\n\n},{\"./mean\":9}],17:[function(require,module,exports){\n'use strict';\n/* @flow */\n\nvar sumNthPowerDeviations = require('./sum_nth_power_deviations');\n\n/**\r\n * The [variance](http://en.wikipedia.org/wiki/Variance)\r\n * is the sum of squared deviations from the mean.\r\n *\r\n * This is an implementation of variance, not sample variance:\r\n * see the `sampleVariance` method if you want a sample measure.\r\n *\r\n * @param {Array<number>} x a population\r\n * @returns {number} variance: a value greater than or equal to zero.\r\n * zero indicates that all values are identical.\r\n * @example\r\n * ss.variance([1, 2, 3, 4, 5, 6]); //= 2.917\r\n */\nfunction variance(x /*: Array<number> */) /*:number*/{\n    // The variance of no numbers is null\n    if (x.length === 0) {\n        return NaN;\n    }\n\n    // Find the mean of squared deviations between the\n    // mean value and each value.\n    return sumNthPowerDeviations(x, 2) / x.length;\n}\n\nmodule.exports = variance;\n\n},{\"./sum_nth_power_deviations\":16}],18:[function(require,module,exports){\n'use strict';\n/* @flow */\n\n/**\r\n * The [Z-Score, or Standard Score](http://en.wikipedia.org/wiki/Standard_score).\r\n *\r\n * The standard score is the number of standard deviations an observation\r\n * or datum is above or below the mean. Thus, a positive standard score\r\n * represents a datum above the mean, while a negative standard score\r\n * represents a datum below the mean. It is a dimensionless quantity\r\n * obtained by subtracting the population mean from an individual raw\r\n * score and then dividing the difference by the population standard\r\n * deviation.\r\n *\r\n * The z-score is only defined if one knows the population parameters;\r\n * if one only has a sample set, then the analogous computation with\r\n * sample mean and sample standard deviation yields the\r\n * Student's t-statistic.\r\n *\r\n * @param {number} x\r\n * @param {number} mean\r\n * @param {number} standardDeviation\r\n * @return {number} z score\r\n * @example\r\n * ss.zScore(78, 80, 5); //= -0.4\r\n */\n\nfunction zScore(x /*:number*/, mean /*:number*/, standardDeviation /*:number*/) /*:number*/{\n  return (x - mean) / standardDeviation;\n}\n\nmodule.exports = zScore;\n\n},{}],19:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Chart = exports.ChartConfig = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _utils = require('./utils');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ChartConfig = exports.ChartConfig = function ChartConfig(custom) {\n    _classCallCheck(this, ChartConfig);\n\n    this.cssClassPrefix = \"odc-\";\n    this.svgClass = this.cssClassPrefix + 'mw-d3-chart';\n    this.width = undefined;\n    this.height = undefined;\n    this.margin = {\n        left: 50,\n        right: 30,\n        top: 30,\n        bottom: 50\n    };\n    this.tooltip = false;\n\n    if (custom) {\n        _utils.Utils.deepExtend(this, custom);\n    }\n};\n\nvar Chart = exports.Chart = function () {\n    function Chart(base, data, config) {\n        _classCallCheck(this, Chart);\n\n        this.utils = _utils.Utils;\n        this.plot = {\n            margin: {}\n        };\n        this._attached = {};\n        this._layers = {};\n        this._events = {};\n        this._isInitialized = false;\n\n\n        this._isAttached = base instanceof Chart;\n\n        this.baseContainer = base;\n\n        this.setConfig(config);\n\n        if (data) {\n            this.setData(data);\n        }\n\n        this.init();\n        this.postInit();\n    }\n\n    _createClass(Chart, [{\n        key: 'setConfig',\n        value: function setConfig(config) {\n            if (!config) {\n                this.config = new ChartConfig();\n            } else {\n                this.config = config;\n            }\n\n            return this;\n        }\n    }, {\n        key: 'setData',\n        value: function setData(data) {\n            this.data = data;\n            return this;\n        }\n    }, {\n        key: 'init',\n        value: function init() {\n            var self = this;\n\n            self.initPlot();\n            self.initSvg();\n\n            self.initTooltip();\n            self.draw();\n            this._isInitialized = true;\n            return this;\n        }\n    }, {\n        key: 'postInit',\n        value: function postInit() {}\n    }, {\n        key: 'initSvg',\n        value: function initSvg() {\n            var self = this;\n            var config = this.config;\n            void 0;\n\n            var margin = self.plot.margin;\n            var width = self.plot.width + margin.left + margin.right;\n            var height = self.plot.height + margin.top + margin.bottom;\n            var aspect = width / height;\n            if (!self._isAttached) {\n                if (!this._isInitialized) {\n                    d3.select(self.baseContainer).select(\"svg\").remove();\n                }\n                self.svg = d3.select(self.baseContainer).selectOrAppend(\"svg\");\n\n                self.svg.attr(\"width\", width).attr(\"height\", height).attr(\"viewBox\", \"0 0 \" + \" \" + width + \" \" + height).attr(\"preserveAspectRatio\", \"xMidYMid meet\").attr(\"class\", config.svgClass);\n                self.svgG = self.svg.selectOrAppend(\"g.main-group\");\n            } else {\n                void 0;\n                self.svg = self.baseContainer.svg;\n                self.svgG = self.svg.selectOrAppend(\"g.main-group.\" + config.svgClass);\n            }\n\n            self.svgG.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n            if (!config.width || config.height) {\n                d3.select(window).on(\"resize\", function () {\n                    //TODO add responsiveness if width/height not specified\n                });\n            }\n        }\n    }, {\n        key: 'initTooltip',\n        value: function initTooltip() {\n            var self = this;\n            if (self.config.tooltip) {\n                if (!self._isAttached) {\n                    self.plot.tooltip = d3.select(self.baseContainer).selectOrAppend('div.' + self.config.cssClassPrefix + 'tooltip').style(\"opacity\", 0);\n                } else {\n                    self.plot.tooltip = self.baseContainer.plot.tooltip;\n                }\n            }\n        }\n    }, {\n        key: 'initPlot',\n        value: function initPlot() {\n            var margin = this.config.margin;\n            this.plot = {\n                margin: {\n                    top: margin.top,\n                    bottom: margin.bottom,\n                    left: margin.left,\n                    right: margin.right\n                }\n            };\n        }\n    }, {\n        key: 'update',\n        value: function update(data) {\n            if (data) {\n                this.setData(data);\n            }\n            var layerName, attachmentData;\n            for (var attachmentName in this._attached) {\n\n                attachmentData = data;\n\n                this._attached[attachmentName].update(attachmentData);\n            }\n            void 0;\n            return this;\n        }\n    }, {\n        key: 'draw',\n        value: function draw(data) {\n            this.update(data);\n\n            return this;\n        }\n\n        //Borrowed from d3.chart\n        /**\r\n         * Register or retrieve an \"attachment\" Chart. The \"attachment\" chart's `draw`\r\n         * method will be invoked whenever the containing chart's `draw` method is\r\n         * invoked.\r\n         *\r\n         * @externalExample chart-attach\r\n         *\r\n         * @param {String} attachmentName Name of the attachment\r\n         * @param {Chart} [chart] Chart to register as a mix in of this chart. When\r\n         *        unspecified, this method will return the attachment previously\r\n         *        registered with the specified `attachmentName` (if any).\r\n         *\r\n         * @returns {Chart} Reference to this chart (chainable).\r\n         */\n\n    }, {\n        key: 'attach',\n        value: function attach(attachmentName, chart) {\n            if (arguments.length === 1) {\n                return this._attached[attachmentName];\n            }\n\n            this._attached[attachmentName] = chart;\n            return chart;\n        }\n    }, {\n        key: 'on',\n\n\n        //Borrowed from d3.chart\n        /**\r\n         * Subscribe a callback function to an event triggered on the chart. See {@link\r\n            * Chart#once} to subscribe a callback function to an event for one occurence.\r\n         *\r\n         * @externalExample {runnable} chart-on\r\n         *\r\n         * @param {String} name Name of the event\r\n         * @param {ChartEventHandler} callback Function to be invoked when the event\r\n         *        occurs\r\n         * @param {Object} [context] Value to set as `this` when invoking the\r\n         *        `callback`. Defaults to the chart instance.\r\n         *\r\n         * @returns {Chart} A reference to this chart (chainable).\r\n         */\n        value: function on(name, callback, context) {\n            var events = this._events[name] || (this._events[name] = []);\n            events.push({\n                callback: callback,\n                context: context || this,\n                _chart: this\n            });\n            return this;\n        }\n\n        //Borrowed from d3.chart\n        /**\r\n         *\r\n         * Subscribe a callback function to an event triggered on the chart. This\r\n         * function will be invoked at the next occurance of the event and immediately\r\n         * unsubscribed. See {@link Chart#on} to subscribe a callback function to an\r\n         * event indefinitely.\r\n         *\r\n         * @externalExample {runnable} chart-once\r\n         *\r\n         * @param {String} name Name of the event\r\n         * @param {ChartEventHandler} callback Function to be invoked when the event\r\n         *        occurs\r\n         * @param {Object} [context] Value to set as `this` when invoking the\r\n         *        `callback`. Defaults to the chart instance\r\n         *\r\n         * @returns {Chart} A reference to this chart (chainable)\r\n         */\n\n    }, {\n        key: 'once',\n        value: function once(name, callback, context) {\n            var self = this;\n            var once = function once() {\n                self.off(name, once);\n                callback.apply(this, arguments);\n            };\n            return this.on(name, once, context);\n        }\n\n        //Borrowed from d3.chart\n        /**\r\n         * Unsubscribe one or more callback functions from an event triggered on the\r\n         * chart. When no arguments are specified, *all* handlers will be unsubscribed.\r\n         * When only a `name` is specified, all handlers subscribed to that event will\r\n         * be unsubscribed. When a `name` and `callback` are specified, only that\r\n         * function will be unsubscribed from that event. When a `name` and `context`\r\n         * are specified (but `callback` is omitted), all events bound to the given\r\n         * event with the given context will be unsubscribed.\r\n         *\r\n         * @externalExample {runnable} chart-off\r\n         *\r\n         * @param {String} [name] Name of the event to be unsubscribed\r\n         * @param {ChartEventHandler} [callback] Function to be unsubscribed\r\n         * @param {Object} [context] Contexts to be unsubscribe\r\n         *\r\n         * @returns {Chart} A reference to this chart (chainable).\r\n         */\n\n    }, {\n        key: 'off',\n        value: function off(name, callback, context) {\n            var names, n, events, event, i, j;\n\n            // remove all events\n            if (arguments.length === 0) {\n                for (name in this._events) {\n                    this._events[name].length = 0;\n                }\n                return this;\n            }\n\n            // remove all events for a specific name\n            if (arguments.length === 1) {\n                events = this._events[name];\n                if (events) {\n                    events.length = 0;\n                }\n                return this;\n            }\n\n            // remove all events that match whatever combination of name, context\n            // and callback.\n            names = name ? [name] : Object.keys(this._events);\n            for (i = 0; i < names.length; i++) {\n                n = names[i];\n                events = this._events[n];\n                j = events.length;\n                while (j--) {\n                    event = events[j];\n                    if (callback && callback === event.callback || context && context === event.context) {\n                        events.splice(j, 1);\n                    }\n                }\n            }\n\n            return this;\n        }\n    }, {\n        key: 'trigger',\n\n\n        //Borrowed from d3.chart\n        /**\r\n         * Publish an event on this chart with the given `name`.\r\n         *\r\n         * @externalExample {runnable} chart-trigger\r\n         *\r\n         * @param {String} name Name of the event to publish\r\n         * @param {...*} arguments Values with which to invoke the registered\r\n         *        callbacks.\r\n         *\r\n         * @returns {Chart} A reference to this chart (chainable).\r\n         */\n        value: function trigger(name) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            var events = this._events[name];\n            var i, ev;\n\n            if (events !== undefined) {\n                for (i = 0; i < events.length; i++) {\n                    ev = events[i];\n                    ev.callback.apply(ev.context, args);\n                }\n            }\n\n            return this;\n        }\n    }, {\n        key: 'getBaseContainer',\n        value: function getBaseContainer() {\n            if (this._isAttached) {\n                return this.baseContainer.svg;\n            }\n            return d3.select(this.baseContainer);\n        }\n    }, {\n        key: 'getBaseContainerNode',\n        value: function getBaseContainerNode() {\n\n            return this.getBaseContainer().node();\n        }\n    }, {\n        key: 'prefixClass',\n        value: function prefixClass(clazz, addDot) {\n            return addDot ? '.' : '' + this.config.cssClassPrefix + clazz;\n        }\n    }, {\n        key: 'computePlotSize',\n        value: function computePlotSize() {\n            this.plot.width = _utils.Utils.availableWidth(this.config.width, this.getBaseContainer(), this.plot.margin);\n            this.plot.height = _utils.Utils.availableHeight(this.config.height, this.getBaseContainer(), this.plot.margin);\n        }\n    }]);\n\n    return Chart;\n}();\n\n},{\"./utils\":29}],20:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.CorrelationMatrix = exports.CorrelationMatrixConfig = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _chart = require('./chart');\n\nvar _utils = require('./utils');\n\nvar _statisticsUtils = require('./statistics-utils');\n\nvar _legend = require('./legend');\n\nvar _scatterplot = require('./scatterplot');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CorrelationMatrixConfig = exports.CorrelationMatrixConfig = function (_ChartConfig) {\n    _inherits(CorrelationMatrixConfig, _ChartConfig);\n\n    //show tooltip on dot hover\n\n    function CorrelationMatrixConfig(custom) {\n        _classCallCheck(this, CorrelationMatrixConfig);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(CorrelationMatrixConfig).call(this));\n\n        _this.svgClass = 'odc-correlation-matrix';\n        _this.guides = false;\n        _this.tooltip = true;\n        _this.legend = true;\n        _this.highlightLabels = true;\n        _this.variables = {\n            labels: undefined,\n            keys: [], //optional array of variable keys\n            value: function value(d, variableKey) {\n                return d[variableKey];\n            }, // variable value accessor\n            scale: \"ordinal\"\n        };\n        _this.correlation = {\n            scale: \"linear\",\n            domain: [-1, -0.75, -0.5, 0, 0.5, 0.75, 1],\n            range: [\"darkblue\", \"blue\", \"lightskyblue\", \"white\", \"orangered\", \"crimson\", \"darkred\"],\n            value: function value(xValues, yValues) {\n                return _statisticsUtils.StatisticsUtils.sampleCorrelation(xValues, yValues);\n            }\n\n        };\n        _this.cell = {\n            shape: \"ellipse\", //possible values: rect, circle, ellipse\n            size: undefined,\n            sizeMin: 5,\n            sizeMax: 250,\n            padding: 1\n        };\n        _this.margin = {\n            left: 60,\n            right: 50,\n            top: 30,\n            bottom: 60\n        };\n\n        if (custom) {\n            _utils.Utils.deepExtend(_this, custom);\n        }\n        return _this;\n    } //show axis guides\n\n\n    return CorrelationMatrixConfig;\n}(_chart.ChartConfig);\n\nvar CorrelationMatrix = exports.CorrelationMatrix = function (_Chart) {\n    _inherits(CorrelationMatrix, _Chart);\n\n    function CorrelationMatrix(placeholderSelector, data, config) {\n        _classCallCheck(this, CorrelationMatrix);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(CorrelationMatrix).call(this, placeholderSelector, data, new CorrelationMatrixConfig(config)));\n    }\n\n    _createClass(CorrelationMatrix, [{\n        key: 'setConfig',\n        value: function setConfig(config) {\n            return _get(Object.getPrototypeOf(CorrelationMatrix.prototype), 'setConfig', this).call(this, new CorrelationMatrixConfig(config));\n        }\n    }, {\n        key: 'initPlot',\n        value: function initPlot() {\n            _get(Object.getPrototypeOf(CorrelationMatrix.prototype), 'initPlot', this).call(this);\n            var self = this;\n            var margin = this.config.margin;\n            var conf = this.config;\n\n            this.plot.x = {};\n            this.plot.correlation = {\n                matrix: undefined,\n                cells: undefined,\n                color: {},\n                shape: {}\n            };\n\n            this.setupVariables();\n            var width = conf.width;\n            var placeholderNode = this.getBaseContainerNode();\n            this.plot.placeholderNode = placeholderNode;\n\n            var parentWidth = placeholderNode.getBoundingClientRect().width;\n            if (width) {\n\n                if (!this.plot.cellSize) {\n                    this.plot.cellSize = Math.max(conf.cell.sizeMin, Math.min(conf.cell.sizeMax, (width - margin.left - margin.right) / this.plot.variables.length));\n                }\n            } else {\n                this.plot.cellSize = this.config.cell.size;\n\n                if (!this.plot.cellSize) {\n                    this.plot.cellSize = Math.max(conf.cell.sizeMin, Math.min(conf.cell.sizeMax, (parentWidth - margin.left - margin.right) / this.plot.variables.length));\n                }\n\n                width = this.plot.cellSize * this.plot.variables.length + margin.left + margin.right;\n            }\n\n            var height = width;\n            if (!height) {\n                height = placeholderNode.getBoundingClientRect().height;\n            }\n\n            this.plot.width = width - margin.left - margin.right;\n            this.plot.height = this.plot.width;\n\n            this.setupVariablesScales();\n            this.setupCorrelationScales();\n            this.setupCorrelationMatrix();\n\n            return this;\n        }\n    }, {\n        key: 'setupVariablesScales',\n        value: function setupVariablesScales() {\n\n            var plot = this.plot;\n            var x = plot.x;\n            var conf = this.config.variables;\n\n            /* *\r\n             * value accessor - returns the value to encode for a given data object.\r\n             * scale - maps value to a visual display encoding, such as a pixel position.\r\n             * map function - maps from data value to display value\r\n             * axis - sets up axis\r\n             **/\n            x.value = conf.value;\n            x.scale = d3.scale[conf.scale]().rangeBands([plot.width, 0]);\n            x.map = function (d) {\n                return x.scale(x.value(d));\n            };\n        }\n    }, {\n        key: 'setupCorrelationScales',\n        value: function setupCorrelationScales() {\n            var plot = this.plot;\n            var corrConf = this.config.correlation;\n\n            plot.correlation.color.scale = d3.scale[corrConf.scale]().domain(corrConf.domain).range(corrConf.range);\n            var shape = plot.correlation.shape = {};\n\n            var cellConf = this.config.cell;\n            shape.type = cellConf.shape;\n\n            var shapeSize = plot.cellSize - cellConf.padding * 2;\n            if (shape.type == 'circle') {\n                var radiusMax = shapeSize / 2;\n                shape.radiusScale = d3.scale.linear().domain([0, 1]).range([2, radiusMax]);\n                shape.radius = function (c) {\n                    return shape.radiusScale(Math.abs(c.value));\n                };\n            } else if (shape.type == 'ellipse') {\n                var radiusMax = shapeSize / 2;\n                shape.radiusScale = d3.scale.linear().domain([0, 1]).range([radiusMax, 2]);\n                shape.radiusX = function (c) {\n                    return shape.radiusScale(Math.abs(c.value));\n                };\n                shape.radiusY = radiusMax;\n\n                shape.rotateVal = function (v) {\n                    if (v == 0) return \"0\";\n                    if (v < 0) return \"-45\";\n                    return \"45\";\n                };\n            } else if (shape.type == 'rect') {\n                shape.size = shapeSize;\n            }\n        }\n    }, {\n        key: 'setupVariables',\n        value: function setupVariables() {\n\n            var variablesConf = this.config.variables;\n\n            var data = this.data;\n            var plot = this.plot;\n            plot.domainByVariable = {};\n            plot.variables = variablesConf.keys;\n            if (!plot.variables || !plot.variables.length) {\n                plot.variables = _utils.Utils.inferVariables(data, this.config.groups.key, this.config.includeInPlot);\n            }\n\n            plot.labels = [];\n            plot.labelByVariable = {};\n            plot.variables.forEach(function (variableKey, index) {\n                plot.domainByVariable[variableKey] = d3.extent(data, function (d) {\n                    return variablesConf.value(d, variableKey);\n                });\n                var label = variableKey;\n                if (variablesConf.labels && variablesConf.labels.length > index) {\n\n                    label = variablesConf.labels[index];\n                }\n                plot.labels.push(label);\n                plot.labelByVariable[variableKey] = label;\n            });\n\n            void 0;\n        }\n    }, {\n        key: 'setupCorrelationMatrix',\n        value: function setupCorrelationMatrix() {\n            var self = this;\n            var data = this.data;\n            var matrix = this.plot.correlation.matrix = [];\n            var matrixCells = this.plot.correlation.matrix.cells = [];\n            var plot = this.plot;\n\n            var variableToValues = {};\n            plot.variables.forEach(function (v, i) {\n\n                variableToValues[v] = data.map(function (d) {\n                    return plot.x.value(d, v);\n                });\n            });\n\n            plot.variables.forEach(function (v1, i) {\n                var row = [];\n                matrix.push(row);\n\n                plot.variables.forEach(function (v2, j) {\n                    var corr = 1;\n                    if (v1 != v2) {\n                        corr = self.config.correlation.value(variableToValues[v1], variableToValues[v2]);\n                    }\n                    var cell = {\n                        rowVar: v1,\n                        colVar: v2,\n                        row: i,\n                        col: j,\n                        value: corr\n                    };\n                    row.push(cell);\n\n                    matrixCells.push(cell);\n                });\n            });\n        }\n    }, {\n        key: 'update',\n        value: function update(newData) {\n            _get(Object.getPrototypeOf(CorrelationMatrix.prototype), 'update', this).call(this, newData);\n            // this.update\n            this.updateCells();\n            this.updateVariableLabels();\n\n            if (this.config.legend) {\n                this.updateLegend();\n            }\n        }\n    }, {\n        key: 'updateVariableLabels',\n        value: function updateVariableLabels() {\n            var self = this;\n            var plot = self.plot;\n            var labelClass = self.prefixClass(\"label\");\n            var labelXClass = labelClass + \"-x\";\n            var labelYClass = labelClass + \"-y\";\n            plot.labelClass = labelClass;\n\n            var labelsX = self.svgG.selectAll(\"text.\" + labelXClass).data(plot.variables, function (d, i) {\n                return i;\n            });\n\n            labelsX.enter().append(\"text\").attr(\"class\", function (d, i) {\n                return labelClass + \" \" + labelXClass + \" \" + labelXClass + \"-\" + i;\n            });\n\n            labelsX.attr(\"x\", function (d, i) {\n                return i * plot.cellSize + plot.cellSize / 2;\n            }).attr(\"y\", plot.height).attr(\"dx\", -2).attr(\"transform\", function (d, i) {\n                return \"rotate(-90, \" + (i * plot.cellSize + plot.cellSize / 2) + \", \" + plot.height + \")\";\n            }).attr(\"text-anchor\", \"end\")\n\n            // .attr(\"dominant-baseline\", \"hanging\")\n            .text(function (v) {\n                return plot.labelByVariable[v];\n            });\n\n            labelsX.exit().remove();\n\n            //////\n\n            var labelsY = self.svgG.selectAll(\"text.\" + labelYClass).data(plot.variables);\n\n            labelsY.enter().append(\"text\");\n\n            labelsY.attr(\"x\", 0).attr(\"y\", function (d, i) {\n                return i * plot.cellSize + plot.cellSize / 2;\n            }).attr(\"dx\", -2).attr(\"text-anchor\", \"end\").attr(\"class\", function (d, i) {\n                return labelClass + \" \" + labelYClass + \" \" + labelYClass + \"-\" + i;\n            })\n            // .attr(\"dominant-baseline\", \"hanging\")\n            .text(function (v) {\n                return plot.labelByVariable[v];\n            });\n\n            labelsY.exit().remove();\n        }\n    }, {\n        key: 'updateCells',\n        value: function updateCells() {\n\n            var self = this;\n            var plot = self.plot;\n            var cellClass = self.prefixClass(\"cell\");\n            var cellShape = plot.correlation.shape.type;\n\n            var cells = self.svgG.selectAll(\"g.\" + cellClass).data(plot.correlation.matrix.cells);\n\n            var cellEnterG = cells.enter().append(\"g\").classed(cellClass, true);\n            cells.attr(\"transform\", function (c) {\n                return \"translate(\" + (plot.cellSize * c.col + plot.cellSize / 2) + \",\" + (plot.cellSize * c.row + plot.cellSize / 2) + \")\";\n            });\n\n            cells.classed(self.config.cssClassPrefix + \"selectable\", !!self.scatterPlot);\n\n            var selector = \"*:not(.cell-shape-\" + cellShape + \")\";\n\n            var wrongShapes = cells.selectAll(selector);\n            wrongShapes.remove();\n\n            var shapes = cells.selectOrAppend(cellShape + \".cell-shape-\" + cellShape);\n\n            if (plot.correlation.shape.type == 'circle') {\n\n                shapes.attr(\"r\", plot.correlation.shape.radius).attr(\"cx\", 0).attr(\"cy\", 0);\n            }\n\n            if (plot.correlation.shape.type == 'ellipse') {\n                // cells.attr(\"transform\", c=> \"translate(300,150) rotate(\"+plot.correlation.shape.rotateVal(c.value)+\")\");\n                shapes.attr(\"rx\", plot.correlation.shape.radiusX).attr(\"ry\", plot.correlation.shape.radiusY).attr(\"cx\", 0).attr(\"cy\", 0).attr(\"transform\", function (c) {\n                    return \"rotate(\" + plot.correlation.shape.rotateVal(c.value) + \")\";\n                });\n            }\n\n            if (plot.correlation.shape.type == 'rect') {\n                shapes.attr(\"width\", plot.correlation.shape.size).attr(\"height\", plot.correlation.shape.size).attr(\"x\", -plot.cellSize / 2).attr(\"y\", -plot.cellSize / 2);\n            }\n            shapes.style(\"fill\", function (c) {\n                return plot.correlation.color.scale(c.value);\n            });\n\n            var mouseoverCallbacks = [];\n            var mouseoutCallbacks = [];\n\n            if (plot.tooltip) {\n\n                mouseoverCallbacks.push(function (c) {\n                    plot.tooltip.transition().duration(200).style(\"opacity\", .9);\n                    var html = c.value;\n                    plot.tooltip.html(html).style(\"left\", d3.event.pageX + 5 + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n                });\n\n                mouseoutCallbacks.push(function (c) {\n                    plot.tooltip.transition().duration(500).style(\"opacity\", 0);\n                });\n            }\n\n            if (self.config.highlightLabels) {\n                var highlightClass = self.config.cssClassPrefix + \"highlight\";\n                var xLabelClass = function xLabelClass(c) {\n                    return plot.labelClass + \"-x-\" + c.col;\n                };\n                var yLabelClass = function yLabelClass(c) {\n                    return plot.labelClass + \"-y-\" + c.row;\n                };\n\n                mouseoverCallbacks.push(function (c) {\n\n                    self.svgG.selectAll(\"text.\" + xLabelClass(c)).classed(highlightClass, true);\n                    self.svgG.selectAll(\"text.\" + yLabelClass(c)).classed(highlightClass, true);\n                });\n                mouseoutCallbacks.push(function (c) {\n                    self.svgG.selectAll(\"text.\" + xLabelClass(c)).classed(highlightClass, false);\n                    self.svgG.selectAll(\"text.\" + yLabelClass(c)).classed(highlightClass, false);\n                });\n            }\n\n            cells.on(\"mouseover\", function (c) {\n                mouseoverCallbacks.forEach(function (callback) {\n                    return callback(c);\n                });\n            }).on(\"mouseout\", function (c) {\n                mouseoutCallbacks.forEach(function (callback) {\n                    return callback(c);\n                });\n            });\n\n            cells.on(\"click\", function (c) {\n                self.trigger(\"cell-selected\", c);\n            });\n\n            cells.exit().remove();\n        }\n    }, {\n        key: 'updateLegend',\n        value: function updateLegend() {\n\n            var plot = this.plot;\n            var legendX = this.plot.width + 10;\n            var legendY = 0;\n            var barWidth = 10;\n            var barHeight = this.plot.height - 2;\n            var scale = plot.correlation.color.scale;\n\n            plot.legend = new _legend.Legend(this.svg, this.svgG, scale, legendX, legendY).linearGradientBar(barWidth, barHeight);\n        }\n    }, {\n        key: 'attachScatterPlot',\n        value: function attachScatterPlot(containerSelector, config) {\n            var _this3 = this;\n\n            var self = this;\n\n            config = config || {};\n\n            var scatterPlotConfig = {\n                height: self.plot.height + self.config.margin.top + self.config.margin.bottom,\n                width: self.plot.height + self.config.margin.top + self.config.margin.bottom,\n                groups: {\n                    key: self.config.groups.key,\n                    label: self.config.groups.label\n                },\n                guides: true,\n                showLegend: false\n            };\n\n            self.scatterPlot = true;\n\n            scatterPlotConfig = _utils.Utils.deepExtend(scatterPlotConfig, config);\n            this.update();\n\n            this.on(\"cell-selected\", function (c) {\n\n                scatterPlotConfig.x = {\n                    key: c.rowVar,\n                    label: self.plot.labelByVariable[c.rowVar]\n                };\n                scatterPlotConfig.y = {\n                    key: c.colVar,\n                    label: self.plot.labelByVariable[c.colVar]\n                };\n                if (self.scatterPlot && self.scatterPlot !== true) {\n                    self.scatterPlot.setConfig(scatterPlotConfig).init();\n                } else {\n                    self.scatterPlot = new _scatterplot.ScatterPlot(containerSelector, self.data, scatterPlotConfig);\n                    _this3.attach(\"ScatterPlot\", self.scatterPlot);\n                }\n            });\n        }\n    }]);\n\n    return CorrelationMatrix;\n}(_chart.Chart);\n\n},{\"./chart\":19,\"./legend\":23,\"./scatterplot\":26,\"./statistics-utils\":28,\"./utils\":29}],21:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.D3Extensions = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _utils = require('./utils');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar D3Extensions = exports.D3Extensions = function () {\n    function D3Extensions() {\n        _classCallCheck(this, D3Extensions);\n    }\n\n    _createClass(D3Extensions, null, [{\n        key: 'extend',\n        value: function extend() {\n\n            d3.selection.enter.prototype.insertSelector = d3.selection.prototype.insertSelector = function (selector, before) {\n                return _utils.Utils.insertSelector(this, selector, before);\n            };\n\n            d3.selection.enter.prototype.appendSelector = d3.selection.prototype.appendSelector = function (selector) {\n                return _utils.Utils.appendSelector(this, selector);\n            };\n\n            d3.selection.enter.prototype.selectOrAppend = d3.selection.prototype.selectOrAppend = function (selector) {\n                return _utils.Utils.selectOrAppend(this, selector);\n            };\n\n            d3.selection.enter.prototype.selectOrInsert = d3.selection.prototype.selectOrInsert = function (selector, before) {\n                return _utils.Utils.selectOrInsert(this, selector, before);\n            };\n        }\n    }]);\n\n    return D3Extensions;\n}();\n\n},{\"./utils\":29}],22:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Legend = exports.StatisticsUtils = exports.RegressionConfig = exports.Regression = exports.CorrelationMatrixConfig = exports.CorrelationMatrix = exports.ScatterPlotMatrixConfig = exports.ScatterPlotMatrix = exports.ScatterPlotConfig = exports.ScatterPlot = undefined;\n\nvar _scatterplot = require(\"./scatterplot\");\n\nObject.defineProperty(exports, \"ScatterPlot\", {\n  enumerable: true,\n  get: function get() {\n    return _scatterplot.ScatterPlot;\n  }\n});\nObject.defineProperty(exports, \"ScatterPlotConfig\", {\n  enumerable: true,\n  get: function get() {\n    return _scatterplot.ScatterPlotConfig;\n  }\n});\n\nvar _scatterplotMatrix = require(\"./scatterplot-matrix\");\n\nObject.defineProperty(exports, \"ScatterPlotMatrix\", {\n  enumerable: true,\n  get: function get() {\n    return _scatterplotMatrix.ScatterPlotMatrix;\n  }\n});\nObject.defineProperty(exports, \"ScatterPlotMatrixConfig\", {\n  enumerable: true,\n  get: function get() {\n    return _scatterplotMatrix.ScatterPlotMatrixConfig;\n  }\n});\n\nvar _correlationMatrix = require(\"./correlation-matrix\");\n\nObject.defineProperty(exports, \"CorrelationMatrix\", {\n  enumerable: true,\n  get: function get() {\n    return _correlationMatrix.CorrelationMatrix;\n  }\n});\nObject.defineProperty(exports, \"CorrelationMatrixConfig\", {\n  enumerable: true,\n  get: function get() {\n    return _correlationMatrix.CorrelationMatrixConfig;\n  }\n});\n\nvar _regression = require(\"./regression\");\n\nObject.defineProperty(exports, \"Regression\", {\n  enumerable: true,\n  get: function get() {\n    return _regression.Regression;\n  }\n});\nObject.defineProperty(exports, \"RegressionConfig\", {\n  enumerable: true,\n  get: function get() {\n    return _regression.RegressionConfig;\n  }\n});\n\nvar _statisticsUtils = require(\"./statistics-utils\");\n\nObject.defineProperty(exports, \"StatisticsUtils\", {\n  enumerable: true,\n  get: function get() {\n    return _statisticsUtils.StatisticsUtils;\n  }\n});\n\nvar _legend = require(\"./legend\");\n\nObject.defineProperty(exports, \"Legend\", {\n  enumerable: true,\n  get: function get() {\n    return _legend.Legend;\n  }\n});\n\nvar _d3Extensions = require(\"./d3-extensions\");\n\n_d3Extensions.D3Extensions.extend();\n\n},{\"./correlation-matrix\":20,\"./d3-extensions\":21,\"./legend\":23,\"./regression\":24,\"./scatterplot\":26,\"./scatterplot-matrix\":25,\"./statistics-utils\":28}],23:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Legend = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _utils = require(\"./utils\");\n\nvar _noExtend = require(\"../bower_components/d3-legend/no-extend\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*var d3 = require('../bower_components/d3');\r\n*/\n// var legend = require('../bower_components/d3-legend/no-extend');\n//\n// module.exports.legend = legend;\n\nvar Legend = exports.Legend = function () {\n    function Legend(svg, legendParent, scale, legendX, legendY) {\n        _classCallCheck(this, Legend);\n\n        this.cssClassPrefix = \"odc-\";\n        this.legendClass = this.cssClassPrefix + \"legend\";\n        this.color = _noExtend.color;\n        this.size = _noExtend.size;\n        this.symbol = _noExtend.symbol;\n\n        this.scale = scale;\n        this.svg = svg;\n\n        this.container = _utils.Utils.selectOrAppend(legendParent, \"g.\" + this.legendClass, \"g\").attr(\"transform\", \"translate(\" + legendX + \",\" + legendY + \")\").classed(this.legendClass, true);\n    }\n\n    _createClass(Legend, [{\n        key: \"linearGradientBar\",\n        value: function linearGradientBar(barWidth, barHeight) {\n            var gradientId = this.cssClassPrefix + \"linear-gradient\";\n            var scale = this.scale;\n\n            this.linearGradient = _utils.Utils.linearGradient(this.svg, gradientId, this.scale.range(), 0, 100, 0, 0);\n\n            this.container.append(\"rect\").attr(\"width\", barWidth).attr(\"height\", barHeight).attr(\"x\", 0).attr(\"y\", 0).style(\"fill\", \"url(#\" + gradientId + \")\");\n\n            var ticks = this.container.selectAll(\"text\").data(scale.domain());\n            var ticksNumber = scale.domain().length - 1;\n            ticks.enter().append(\"text\").attr(\"x\", barWidth).attr(\"y\", function (d, i) {\n                return barHeight - i * barHeight / ticksNumber;\n            }).attr(\"dx\", 3)\n            // .attr(\"dy\", 1)\n            .attr(\"alignment-baseline\", \"middle\").text(function (d) {\n                return d;\n            });\n\n            ticks.exit().remove();\n\n            return this;\n        }\n    }]);\n\n    return Legend;\n}();\n\n},{\"../bower_components/d3-legend/no-extend\":1,\"./utils\":29}],24:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Regression = exports.RegressionConfig = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _chart = require(\"./chart\");\n\nvar _scatterplot = require(\"./scatterplot\");\n\nvar _utils = require(\"./utils\");\n\nvar _statisticsUtils = require(\"./statistics-utils\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar RegressionConfig = exports.RegressionConfig = function (_ScatterPlotConfig) {\n    _inherits(RegressionConfig, _ScatterPlotConfig);\n\n    function RegressionConfig(custom) {\n        _classCallCheck(this, RegressionConfig);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(RegressionConfig).call(this));\n\n        _this.mainRegression = true;\n        _this.groupRegression = true;\n        _this.confidence = {\n            level: 0.95,\n            criticalValue: function criticalValue(degreesOfFreedom, criticalProbability) {\n                return _statisticsUtils.StatisticsUtils.tValue(degreesOfFreedom, criticalProbability);\n            },\n            marginOfError: undefined //custom  margin Of Error function (x, points)\n        };\n\n\n        if (custom) {\n            _utils.Utils.deepExtend(_this, custom);\n        }\n\n        return _this;\n    }\n\n    return RegressionConfig;\n}(_scatterplot.ScatterPlotConfig);\n\nvar Regression = exports.Regression = function (_ScatterPlot) {\n    _inherits(Regression, _ScatterPlot);\n\n    function Regression(placeholderSelector, data, config) {\n        _classCallCheck(this, Regression);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(Regression).call(this, placeholderSelector, data, new RegressionConfig(config)));\n    }\n\n    _createClass(Regression, [{\n        key: \"setConfig\",\n        value: function setConfig(config) {\n            return _get(Object.getPrototypeOf(Regression.prototype), \"setConfig\", this).call(this, new RegressionConfig(config));\n        }\n    }, {\n        key: \"initPlot\",\n        value: function initPlot() {\n            _get(Object.getPrototypeOf(Regression.prototype), \"initPlot\", this).call(this);\n            this.initRegressionLines();\n        }\n    }, {\n        key: \"initRegressionLines\",\n        value: function initRegressionLines() {\n\n            var self = this;\n            var groupsAvailable = self.config.groups && self.config.groups.value;\n\n            self.plot.regressions = [];\n\n            if (groupsAvailable && self.config.mainRegression) {\n                var regression = this.initRegression(this.data, false);\n                self.plot.regressions.push(regression);\n            }\n\n            if (self.config.groupRegression) {\n                this.initGroupRegression();\n            }\n        }\n    }, {\n        key: \"initGroupRegression\",\n        value: function initGroupRegression() {\n            var self = this;\n            var dataByGroup = {};\n            self.data.forEach(function (d) {\n                var groupVal = self.config.groups.value(d, self.config.groups.key);\n\n                if (!groupVal && groupVal !== 0) {\n                    return;\n                }\n\n                if (!dataByGroup[groupVal]) {\n                    dataByGroup[groupVal] = [];\n                }\n                dataByGroup[groupVal].push(d);\n            });\n\n            for (var key in dataByGroup) {\n                if (!dataByGroup.hasOwnProperty(key)) {\n                    continue;\n                }\n\n                var regression = this.initRegression(dataByGroup[key], key);\n                self.plot.regressions.push(regression);\n            }\n        }\n    }, {\n        key: \"initRegression\",\n        value: function initRegression(values, groupVal) {\n            var self = this;\n\n            var points = values.map(function (d) {\n                return [parseFloat(self.plot.x.value(d)), parseFloat(self.plot.y.value(d))];\n            });\n\n            // points.sort((a,b) => a[0]-b[0]);\n\n            var linearRegression = _statisticsUtils.StatisticsUtils.linearRegression(points);\n            var linearRegressionLine = _statisticsUtils.StatisticsUtils.linearRegressionLine(linearRegression);\n\n            var extentX = d3.extent(points, function (d) {\n                return d[0];\n            });\n\n            var linePoints = [{\n                x: extentX[0],\n                y: linearRegressionLine(extentX[0])\n            }, {\n                x: extentX[1],\n                y: linearRegressionLine(extentX[1])\n            }];\n\n            var line = d3.svg.line().interpolate(\"basis\").x(function (d) {\n                return self.plot.x.scale(d.x);\n            }).y(function (d) {\n                return self.plot.y.scale(d.y);\n            });\n\n            var color = self.plot.dot.color;\n\n            var defaultColor = \"black\";\n            if (_utils.Utils.isFunction(color)) {\n                if (values.length && groupVal !== false) {\n                    color = color(values[0]);\n                } else {\n                    color = defaultColor;\n                }\n            } else if (!color && groupVal === false) {\n                color = defaultColor;\n            }\n\n            var confidence = this.computeConfidence(points, extentX, linearRegression, linearRegressionLine);\n            return {\n                group: groupVal || false,\n                line: line,\n                linePoints: linePoints,\n                color: color,\n                confidence: confidence\n            };\n        }\n    }, {\n        key: \"computeConfidence\",\n        value: function computeConfidence(points, extentX, linearRegression, linearRegressionLine) {\n            var self = this;\n            var slope = linearRegression.m;\n            var n = points.length;\n            var degreesOfFreedom = Math.max(0, n - 2);\n\n            var alpha = 1 - self.config.confidence.level;\n            var criticalProbability = 1 - alpha / 2;\n            var criticalValue = self.config.confidence.criticalValue(degreesOfFreedom, criticalProbability);\n\n            var xValues = points.map(function (d) {\n                return d[0];\n            });\n            var meanX = _statisticsUtils.StatisticsUtils.mean(xValues);\n            var xMySum = 0;\n            var xSum = 0;\n            var xPowSum = 0;\n            var ySum = 0;\n            var yPowSum = 0;\n            points.forEach(function (p) {\n                var x = p[0];\n                var y = p[1];\n\n                xMySum += x * y;\n                xSum += x;\n                ySum += y;\n                xPowSum += x * x;\n                yPowSum += y * y;\n            });\n            var a = linearRegression.m;\n            var b = linearRegression.b;\n\n            var Sa2 = n / (n + 2) * ((yPowSum - a * xMySum - b * ySum) / (n * xPowSum - xSum * xSum)); //Wariancja wspczynnika kierunkowego regresji liniowej a\n            var Sy2 = (yPowSum - a * xMySum - b * ySum) / (n * (n - 2)); //Sa2 //Mean y value variance\n\n            var errorFn = function errorFn(x) {\n                return Math.sqrt(Sy2 + Math.pow(x - meanX, 2) * Sa2);\n            }; //pierwiastek kwadratowy z wariancji dowolnego punktu prostej\n            var marginOfError = function marginOfError(x) {\n                return criticalValue * errorFn(x);\n            };\n\n            // console.log('n', n, 'degreesOfFreedom', degreesOfFreedom, 'criticalProbability',criticalProbability);\n            // var confidenceDown = x => linearRegressionLine(x) -  marginOfError(x);\n            // var confidenceUp = x => linearRegressionLine(x) +  marginOfError(x);\n\n            var computeConfidenceAreaPoint = function computeConfidenceAreaPoint(x) {\n                var linearRegression = linearRegressionLine(x);\n                var moe = marginOfError(x);\n                var confDown = linearRegression - moe;\n                var confUp = linearRegression + moe;\n                return {\n                    x: x,\n                    y0: confDown,\n                    y1: confUp\n                };\n            };\n\n            var centerX = (extentX[1] + extentX[0]) / 2;\n\n            // var confidenceAreaPoints = [extentX[0], centerX,  extentX[1]].map(computeConfidenceAreaPoint);\n            var confidenceAreaPoints = [extentX[0], centerX, extentX[1]].map(computeConfidenceAreaPoint);\n\n            var fitInPlot = function fitInPlot(y) {\n                return y;\n            };\n\n            var confidenceArea = d3.svg.area().interpolate(\"monotone\").x(function (d) {\n                return self.plot.x.scale(d.x);\n            }).y0(function (d) {\n                return fitInPlot(self.plot.y.scale(d.y0));\n            }).y1(function (d) {\n                return fitInPlot(self.plot.y.scale(d.y1));\n            });\n\n            return {\n                area: confidenceArea,\n                points: confidenceAreaPoints\n            };\n        }\n    }, {\n        key: \"update\",\n        value: function update(newData) {\n            _get(Object.getPrototypeOf(Regression.prototype), \"update\", this).call(this, newData);\n            this.updateRegressionLines();\n        }\n    }, {\n        key: \"updateRegressionLines\",\n        value: function updateRegressionLines() {\n            var self = this;\n            var regressionContainerClass = this.prefixClass(\"regression-container\");\n            var regressionContainerSelector = \"g.\" + regressionContainerClass;\n\n            var clipPathId = self.prefixClass(\"clip\");\n\n            var regressionContainer = self.svgG.selectOrInsert(regressionContainerSelector, \".\" + self.dotsContainerClass);\n            var regressionContainerClip = regressionContainer.selectOrAppend(\"clipPath\").attr(\"id\", clipPathId);\n\n            regressionContainerClip.selectOrAppend('rect').attr('width', self.plot.width).attr('height', self.plot.height).attr('x', 0).attr('y', 0);\n\n            regressionContainer.attr(\"clip-path\", function (d, i) {\n                return \"url(#\" + clipPathId + \")\";\n            });\n\n            var regressionClass = this.prefixClass(\"regression\");\n            var confidenceAreaClass = self.prefixClass(\"confidence\");\n            var regressionSelector = \"g.\" + regressionClass;\n            var regression = regressionContainer.selectAll(regressionSelector).data(self.plot.regressions);\n\n            var line = regression.enter().insertSelector(regressionSelector).append(\"path\").attr(\"class\", self.prefixClass(\"line\")).attr(\"shape-rendering\", \"optimizeQuality\");\n            // .append(\"line\")\n            // .attr(\"class\", \"line\")\n            // .attr(\"shape-rendering\", \"optimizeQuality\");\n\n            line\n            // .attr(\"x1\", r=> self.plot.x.scale(r.linePoints[0].x))\n            // .attr(\"y1\", r=> self.plot.y.scale(r.linePoints[0].y))\n            // .attr(\"x2\", r=> self.plot.x.scale(r.linePoints[1].x))\n            // .attr(\"y2\", r=> self.plot.y.scale(r.linePoints[1].y))\n            .attr(\"d\", function (r) {\n                return r.line(r.linePoints);\n            }).style(\"stroke\", function (r) {\n                return r.color;\n            });\n\n            var area = regression.enter().appendSelector(regressionSelector).append(\"path\").attr(\"class\", confidenceAreaClass).attr(\"shape-rendering\", \"optimizeQuality\");\n\n            area.attr(\"d\", function (r) {\n                return r.confidence.area(r.confidence.points);\n            }).style(\"fill\", function (r) {\n                return r.color;\n            }).style(\"opacity\", \"0.4\");\n        }\n    }]);\n\n    return Regression;\n}(_scatterplot.ScatterPlot);\n\n},{\"./chart\":19,\"./scatterplot\":26,\"./statistics-utils\":28,\"./utils\":29}],25:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ScatterPlotMatrix = exports.ScatterPlotMatrixConfig = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _chart = require(\"./chart\");\n\nvar _scatterplot = require(\"./scatterplot\");\n\nvar _utils = require(\"./utils\");\n\nvar _legend = require(\"./legend\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ScatterPlotMatrixConfig = exports.ScatterPlotMatrixConfig = function (_ScatterPlotConfig) {\n    _inherits(ScatterPlotMatrixConfig, _ScatterPlotConfig);\n\n    //ticks number, (default: computed using cell size)\n    //show axis guides\n    //scatter plot cell padding\n\n    function ScatterPlotMatrixConfig(custom) {\n        _classCallCheck(this, ScatterPlotMatrixConfig);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(ScatterPlotMatrixConfig).call(this));\n\n        _this.svgClass = _this.cssClassPrefix + 'scatterplot-matrix';\n        _this.size = 200;\n        _this.padding = 20;\n        _this.brush = true;\n        _this.guides = true;\n        _this.tooltip = true;\n        _this.ticks = undefined;\n        _this.x = { // X axis config\n            orient: \"bottom\",\n            scale: \"linear\"\n        };\n        _this.y = { // Y axis config\n            orient: \"left\",\n            scale: \"linear\"\n        };\n        _this.groups = {\n            key: undefined, //object property name or array index with grouping variable\n            includeInPlot: false, //include group as variable in plot, boolean (default: false)\n            value: function value(d, key) {\n                return d[key];\n            }, // grouping value accessor,\n            label: \"\"\n        };\n        _this.variables = {\n            labels: [], //optional array of variable labels (for the diagonal of the plot).\n            keys: [], //optional array of variable keys\n            value: function value(d, variableKey) {\n                // variable value accessor\n                return d[variableKey];\n            }\n        };\n\n        _utils.Utils.deepExtend(_this, custom);\n        return _this;\n    } //show tooltip on dot hover\n    //scatter plot cell size\n\n\n    return ScatterPlotMatrixConfig;\n}(_scatterplot.ScatterPlotConfig);\n\nvar ScatterPlotMatrix = exports.ScatterPlotMatrix = function (_Chart) {\n    _inherits(ScatterPlotMatrix, _Chart);\n\n    function ScatterPlotMatrix(placeholderSelector, data, config) {\n        _classCallCheck(this, ScatterPlotMatrix);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(ScatterPlotMatrix).call(this, placeholderSelector, data, new ScatterPlotMatrixConfig(config)));\n    }\n\n    _createClass(ScatterPlotMatrix, [{\n        key: \"setConfig\",\n        value: function setConfig(config) {\n            return _get(Object.getPrototypeOf(ScatterPlotMatrix.prototype), \"setConfig\", this).call(this, new ScatterPlotMatrixConfig(config));\n        }\n    }, {\n        key: \"initPlot\",\n        value: function initPlot() {\n            _get(Object.getPrototypeOf(ScatterPlotMatrix.prototype), \"initPlot\", this).call(this);\n\n            var self = this;\n            var margin = this.plot.margin;\n            var conf = this.config;\n            this.plot.x = {};\n            this.plot.y = {};\n            this.plot.dot = {\n                color: null //color scale mapping function\n            };\n\n            this.plot.showLegend = conf.showLegend;\n            if (this.plot.showLegend) {\n                margin.right = conf.margin.right + conf.legend.width + conf.legend.margin * 2;\n            }\n\n            this.setupVariables();\n\n            this.plot.size = conf.size;\n\n            var width = conf.width;\n            var boundingClientRect = this.getBaseContainerNode().getBoundingClientRect();\n            if (!width) {\n                var maxWidth = margin.left + margin.right + this.plot.variables.length * this.plot.size;\n                width = Math.min(boundingClientRect.width, maxWidth);\n            }\n            var height = width;\n            if (!height) {\n                height = boundingClientRect.height;\n            }\n\n            this.plot.width = width - margin.left - margin.right;\n            this.plot.height = height - margin.top - margin.bottom;\n\n            if (conf.ticks === undefined) {\n                conf.ticks = this.plot.size / 40;\n            }\n\n            this.setupX();\n            this.setupY();\n\n            if (conf.dot.d3ColorCategory) {\n                this.plot.dot.colorCategory = d3.scale[conf.dot.d3ColorCategory]();\n            }\n            var colorValue = conf.dot.color;\n            if (colorValue) {\n                this.plot.dot.colorValue = colorValue;\n\n                if (typeof colorValue === 'string' || colorValue instanceof String) {\n                    this.plot.dot.color = colorValue;\n                } else if (this.plot.dot.colorCategory) {\n                    this.plot.dot.color = function (d) {\n                        return self.plot.dot.colorCategory(self.plot.dot.colorValue(d));\n                    };\n                }\n            }\n\n            return this;\n        }\n    }, {\n        key: \"setupVariables\",\n        value: function setupVariables() {\n            var variablesConf = this.config.variables;\n\n            var data = this.data;\n            var plot = this.plot;\n            plot.domainByVariable = {};\n            plot.variables = variablesConf.keys;\n            if (!plot.variables || !plot.variables.length) {\n                plot.variables = _utils.Utils.inferVariables(data, this.config.groups.key, this.config.includeInPlot);\n            }\n\n            plot.labels = [];\n            plot.labelByVariable = {};\n            plot.variables.forEach(function (variableKey, index) {\n                plot.domainByVariable[variableKey] = d3.extent(data, function (d) {\n                    return variablesConf.value(d, variableKey);\n                });\n                var label = variableKey;\n                if (variablesConf.labels && variablesConf.labels.length > index) {\n\n                    label = variablesConf.labels[index];\n                }\n                plot.labels.push(label);\n                plot.labelByVariable[variableKey] = label;\n            });\n\n            void 0;\n\n            plot.subplots = [];\n        }\n    }, {\n        key: \"setupX\",\n        value: function setupX() {\n\n            var plot = this.plot;\n            var x = plot.x;\n            var conf = this.config;\n\n            x.value = conf.variables.value;\n            x.scale = d3.scale[conf.x.scale]().range([conf.padding / 2, plot.size - conf.padding / 2]);\n            x.map = function (d, variable) {\n                return x.scale(x.value(d, variable));\n            };\n            x.axis = d3.svg.axis().scale(x.scale).orient(conf.x.orient).ticks(conf.ticks);\n            x.axis.tickSize(plot.size * plot.variables.length);\n        }\n    }, {\n        key: \"setupY\",\n        value: function setupY() {\n\n            var plot = this.plot;\n            var y = plot.y;\n            var conf = this.config;\n\n            y.value = conf.variables.value;\n            y.scale = d3.scale[conf.y.scale]().range([plot.size - conf.padding / 2, conf.padding / 2]);\n            y.map = function (d, variable) {\n                return y.scale(y.value(d, variable));\n            };\n            y.axis = d3.svg.axis().scale(y.scale).orient(conf.y.orient).ticks(conf.ticks);\n            y.axis.tickSize(-plot.size * plot.variables.length);\n        }\n    }, {\n        key: \"draw\",\n        value: function draw() {\n            var self = this;\n            var n = self.plot.variables.length;\n            var conf = this.config;\n\n            var axisClass = self.prefixClass(\"axis\");\n            var axisXClass = axisClass + \"-x\";\n            var axisYClass = axisClass + \"-y\";\n\n            var xAxisSelector = \"g.\" + axisXClass + \".\" + axisClass;\n            var yAxisSelector = \"g.\" + axisYClass + \".\" + axisClass;\n\n            var noGuidesClass = self.prefixClass(\"no-guides\");\n            self.svgG.selectAll(xAxisSelector).data(self.plot.variables).enter().appendSelector(xAxisSelector).classed(noGuidesClass, !conf.guides).attr(\"transform\", function (d, i) {\n                return \"translate(\" + (n - i - 1) * self.plot.size + \",0)\";\n            }).each(function (d) {\n                self.plot.x.scale.domain(self.plot.domainByVariable[d]);d3.select(this).call(self.plot.x.axis);\n            });\n\n            self.svgG.selectAll(yAxisSelector).data(self.plot.variables).enter().appendSelector(yAxisSelector).classed(noGuidesClass, !conf.guides).attr(\"transform\", function (d, i) {\n                return \"translate(0,\" + i * self.plot.size + \")\";\n            }).each(function (d) {\n                self.plot.y.scale.domain(self.plot.domainByVariable[d]);d3.select(this).call(self.plot.y.axis);\n            });\n\n            var cellClass = self.prefixClass(\"cell\");\n            var cell = self.svgG.selectAll(\".\" + cellClass).data(self.utils.cross(self.plot.variables, self.plot.variables)).enter().appendSelector(\"g.\" + cellClass).attr(\"transform\", function (d) {\n                return \"translate(\" + (n - d.i - 1) * self.plot.size + \",\" + d.j * self.plot.size + \")\";\n            });\n\n            if (conf.brush) {\n                this.drawBrush(cell);\n            }\n\n            cell.each(plotSubplot);\n\n            //Labels\n            cell.filter(function (d) {\n                return d.i === d.j;\n            }).append(\"text\").attr(\"x\", conf.padding).attr(\"y\", conf.padding).attr(\"dy\", \".71em\").text(function (d) {\n                return self.plot.labelByVariable[d.x];\n            });\n\n            function plotSubplot(p) {\n                var plot = self.plot;\n                plot.subplots.push(p);\n                var cell = d3.select(this);\n\n                plot.x.scale.domain(plot.domainByVariable[p.x]);\n                plot.y.scale.domain(plot.domainByVariable[p.y]);\n\n                var frameClass = self.prefixClass(\"frame\");\n                cell.append(\"rect\").attr(\"class\", frameClass).attr(\"x\", conf.padding / 2).attr(\"y\", conf.padding / 2).attr(\"width\", conf.size - conf.padding).attr(\"height\", conf.size - conf.padding);\n\n                p.update = function () {\n                    var subplot = this;\n                    var dots = cell.selectAll(\"circle\").data(self.data);\n\n                    dots.enter().append(\"circle\");\n\n                    dots.attr(\"cx\", function (d) {\n                        return plot.x.map(d, subplot.x);\n                    }).attr(\"cy\", function (d) {\n                        return plot.y.map(d, subplot.y);\n                    }).attr(\"r\", self.config.dot.radius);\n\n                    if (plot.dot.color) {\n                        dots.style(\"fill\", plot.dot.color);\n                    }\n\n                    if (plot.tooltip) {\n                        dots.on(\"mouseover\", function (d) {\n                            plot.tooltip.transition().duration(200).style(\"opacity\", .9);\n                            var html = \"(\" + plot.x.value(d, subplot.x) + \", \" + plot.y.value(d, subplot.y) + \")\";\n                            plot.tooltip.html(html).style(\"left\", d3.event.pageX + 5 + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n\n                            var group = self.config.groups.value(d);\n                            if (group || group === 0) {\n                                html += \"<br/>\";\n                                var label = self.config.groups.label;\n                                if (label) {\n                                    html += label + \": \";\n                                }\n                                html += group;\n                            }\n                            plot.tooltip.html(html).style(\"left\", d3.event.pageX + 5 + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n                        }).on(\"mouseout\", function (d) {\n                            plot.tooltip.transition().duration(500).style(\"opacity\", 0);\n                        });\n                    }\n\n                    dots.exit().remove();\n                };\n                p.update();\n            }\n\n            this.updateLegend();\n        }\n    }, {\n        key: \"update\",\n        value: function update(data) {\n\n            _get(Object.getPrototypeOf(ScatterPlotMatrix.prototype), \"update\", this).call(this, data);\n            this.plot.subplots.forEach(function (p) {\n                p.update();\n            });\n            this.updateLegend();\n        }\n    }, {\n        key: \"drawBrush\",\n        value: function drawBrush(cell) {\n            var self = this;\n            var brush = d3.svg.brush().x(self.plot.x.scale).y(self.plot.y.scale).on(\"brushstart\", brushstart).on(\"brush\", brushmove).on(\"brushend\", brushend);\n\n            cell.append(\"g\").call(brush);\n\n            var brushCell;\n\n            // Clear the previously-active brush, if any.\n            function brushstart(p) {\n                if (brushCell !== this) {\n                    d3.select(brushCell).call(brush.clear());\n                    self.plot.x.scale.domain(self.plot.domainByVariable[p.x]);\n                    self.plot.y.scale.domain(self.plot.domainByVariable[p.y]);\n                    brushCell = this;\n                }\n            }\n\n            // Highlight the selected circles.\n            function brushmove(p) {\n                var e = brush.extent();\n                self.svgG.selectAll(\"circle\").classed(\"hidden\", function (d) {\n                    return e[0][0] > d[p.x] || d[p.x] > e[1][0] || e[0][1] > d[p.y] || d[p.y] > e[1][1];\n                });\n            }\n            // If the brush is empty, select all circles.\n            function brushend() {\n                if (brush.empty()) self.svgG.selectAll(\".hidden\").classed(\"hidden\", false);\n            }\n        }\n    }, {\n        key: \"updateLegend\",\n        value: function updateLegend() {\n\n            void 0;\n            var plot = this.plot;\n\n            var scale = plot.dot.colorCategory;\n            if (!scale.domain() || scale.domain().length < 2) {\n                plot.showLegend = false;\n            }\n\n            if (!plot.showLegend) {\n                if (plot.legend && plot.legend.container) {\n                    plot.legend.container.remove();\n                }\n                return;\n            }\n\n            var legendX = this.plot.width + this.config.legend.margin;\n            var legendY = this.config.legend.margin;\n\n            plot.legend = new _legend.Legend(this.svg, this.svgG, scale, legendX, legendY);\n\n            var legendLinear = plot.legend.color().shapeWidth(this.config.legend.shapeWidth).orient('vertical').scale(scale);\n\n            plot.legend.container.call(legendLinear);\n        }\n    }]);\n\n    return ScatterPlotMatrix;\n}(_chart.Chart);\n\n},{\"./chart\":19,\"./legend\":23,\"./scatterplot\":26,\"./utils\":29}],26:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ScatterPlot = exports.ScatterPlotConfig = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _chart = require(\"./chart\");\n\nvar _utils = require(\"./utils\");\n\nvar _legend = require(\"./legend\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ScatterPlotConfig = exports.ScatterPlotConfig = function (_ChartConfig) {\n    _inherits(ScatterPlotConfig, _ChartConfig);\n\n    //show tooltip on dot hover\n\n    function ScatterPlotConfig(custom) {\n        _classCallCheck(this, ScatterPlotConfig);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(ScatterPlotConfig).call(this));\n\n        _this.svgClass = _this.cssClassPrefix + 'scatterplot';\n        _this.guides = false;\n        _this.tooltip = true;\n        _this.showLegend = true;\n        _this.legend = {\n            width: 80,\n            margin: 10,\n            shapeWidth: 20\n        };\n        _this.x = { // X axis config\n            label: 'X', // axis label\n            key: 0,\n            value: function value(d, key) {\n                return d[key];\n            }, // x value accessor\n            orient: \"bottom\",\n            scale: \"linear\"\n        };\n        _this.y = { // Y axis config\n            label: 'Y', // axis label,\n            key: 1,\n            value: function value(d, key) {\n                return d[key];\n            }, // y value accessor\n            orient: \"left\",\n            scale: \"linear\"\n        };\n        _this.groups = {\n            key: 2,\n            value: function value(d, key) {\n                return d[key];\n            }, // grouping value accessor,\n            label: \"\"\n        };\n        _this.transition = true;\n\n        var config = _this;\n        _this.dot = {\n            radius: 2,\n            color: function color(d) {\n                return config.groups.value(d, config.groups.key);\n            }, // string or function returning color's value for color scale\n            d3ColorCategory: 'category10'\n        };\n\n        if (custom) {\n            _utils.Utils.deepExtend(_this, custom);\n        }\n\n        return _this;\n    } //show axis guides\n\n\n    return ScatterPlotConfig;\n}(_chart.ChartConfig);\n\nvar ScatterPlot = exports.ScatterPlot = function (_Chart) {\n    _inherits(ScatterPlot, _Chart);\n\n    function ScatterPlot(placeholderSelector, data, config) {\n        _classCallCheck(this, ScatterPlot);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(ScatterPlot).call(this, placeholderSelector, data, new ScatterPlotConfig(config)));\n    }\n\n    _createClass(ScatterPlot, [{\n        key: \"setConfig\",\n        value: function setConfig(config) {\n            return _get(Object.getPrototypeOf(ScatterPlot.prototype), \"setConfig\", this).call(this, new ScatterPlotConfig(config));\n        }\n    }, {\n        key: \"initPlot\",\n        value: function initPlot() {\n            _get(Object.getPrototypeOf(ScatterPlot.prototype), \"initPlot\", this).call(this);\n            var self = this;\n\n            var conf = this.config;\n\n            this.plot.x = {};\n            this.plot.y = {};\n            this.plot.dot = {\n                color: null //color scale mapping function\n            };\n\n            this.plot.showLegend = conf.showLegend;\n            if (this.plot.showLegend) {\n                this.plot.margin.right = conf.margin.right + conf.legend.width + conf.legend.margin * 2;\n            }\n\n            this.computePlotSize();\n\n            // var legendWidth = availableWidth;\n            // legend.width(legendWidth);\n            //\n            // wrap.select('.nv-legendWrap')\n            //     .datum(data)\n            //     .call(legend);\n            //\n            // if (legend.height() > margin.top) {\n            //     margin.top = legend.height();\n            //     availableHeight = nv.utils.availableHeight(height, container, margin);\n            // }\n\n            this.setupX();\n            this.setupY();\n\n            if (conf.dot.d3ColorCategory) {\n                this.plot.dot.colorCategory = d3.scale[conf.dot.d3ColorCategory]();\n            }\n            var colorValue = conf.dot.color;\n            if (colorValue) {\n                this.plot.dot.colorValue = colorValue;\n\n                if (typeof colorValue === 'string' || colorValue instanceof String) {\n                    this.plot.dot.color = colorValue;\n                } else if (this.plot.dot.colorCategory) {\n                    this.plot.dot.color = function (d) {\n                        return self.plot.dot.colorCategory(self.plot.dot.colorValue(d));\n                    };\n                }\n            } else {}\n\n            return this;\n        }\n    }, {\n        key: \"setupX\",\n        value: function setupX() {\n\n            var plot = this.plot;\n            var x = plot.x;\n            var conf = this.config.x;\n\n            /* *\r\n             * value accessor - returns the value to encode for a given data object.\r\n             * scale - maps value to a visual display encoding, such as a pixel position.\r\n             * map function - maps from data value to display value\r\n             * axis - sets up axis\r\n             **/\n            x.value = function (d) {\n                return conf.value(d, conf.key);\n            };\n            x.scale = d3.scale[conf.scale]().range([0, plot.width]);\n            x.map = function (d) {\n                return x.scale(x.value(d));\n            };\n            x.axis = d3.svg.axis().scale(x.scale).orient(conf.orient);\n            var data = this.data;\n            plot.x.scale.domain([d3.min(data, plot.x.value) - 1, d3.max(data, plot.x.value) + 1]);\n            if (this.config.guides) {\n                x.axis.tickSize(-plot.height);\n            }\n        }\n    }, {\n        key: \"setupY\",\n        value: function setupY() {\n\n            var plot = this.plot;\n            var y = plot.y;\n            var conf = this.config.y;\n\n            /*\r\n             * value accessor - returns the value to encode for a given data object.\r\n             * scale - maps value to a visual display encoding, such as a pixel position.\r\n             * map function - maps from data value to display value\r\n             * axis - sets up axis\r\n             */\n            y.value = function (d) {\n                return conf.value(d, conf.key);\n            };\n            y.scale = d3.scale[conf.scale]().range([plot.height, 0]);\n            y.map = function (d) {\n                return y.scale(y.value(d));\n            };\n            y.axis = d3.svg.axis().scale(y.scale).orient(conf.orient);\n\n            if (this.config.guides) {\n                y.axis.tickSize(-plot.width);\n            }\n\n            var data = this.data;\n            plot.y.scale.domain([d3.min(data, plot.y.value) - 1, d3.max(data, plot.y.value) + 1]);\n        }\n    }, {\n        key: \"draw\",\n        value: function draw() {\n            this.drawAxisX();\n            this.drawAxisY();\n            this.update();\n        }\n    }, {\n        key: \"drawAxisX\",\n        value: function drawAxisX() {\n\n            var self = this;\n            var plot = self.plot;\n            var axisConf = this.config.x;\n            self.svgG.selectOrAppend(\"g.\" + self.prefixClass('axis-x') + \".\" + self.prefixClass('axis') + (self.config.guides ? '' : '.' + self.prefixClass('no-guides'))).attr(\"transform\", \"translate(0,\" + plot.height + \")\").call(plot.x.axis).selectOrAppend(\"text.\" + self.prefixClass('label')).attr(\"transform\", \"translate(\" + plot.width / 2 + \",\" + plot.margin.bottom + \")\") // text is drawn off the screen top left, move down and out and rotate\n            .attr(\"dy\", \"-1em\").style(\"text-anchor\", \"middle\").text(axisConf.label);\n        }\n    }, {\n        key: \"drawAxisY\",\n        value: function drawAxisY() {\n            var self = this;\n            var plot = self.plot;\n            var axisConf = this.config.y;\n            self.svgG.selectOrAppend(\"g.\" + self.prefixClass('axis-y') + \".\" + self.prefixClass('axis') + (self.config.guides ? '' : '.' + self.prefixClass('no-guides'))).call(plot.y.axis).selectOrAppend(\"text.\" + self.prefixClass('label')).attr(\"transform\", \"translate(\" + -plot.margin.left + \",\" + plot.height / 2 + \")rotate(-90)\") // text is drawn off the screen top left, move down and out and rotate\n            .attr(\"dy\", \"1em\").style(\"text-anchor\", \"middle\").text(axisConf.label);\n        }\n    }, {\n        key: \"update\",\n        value: function update(newData) {\n            _get(Object.getPrototypeOf(ScatterPlot.prototype), \"update\", this).call(this, newData);\n\n            this.updateDots();\n\n            this.updateLegend();\n        }\n    }, {\n        key: \"updateDots\",\n        value: function updateDots() {\n            var self = this;\n            var plot = self.plot;\n            var data = this.data;\n            var dotClass = self.prefixClass('dot');\n            self.dotsContainerClass = self.prefixClass('dots-container');\n\n            var dotsContainer = self.svgG.selectOrAppend(\"g.\" + self.dotsContainerClass);\n\n            var dots = dotsContainer.selectAll('.' + dotClass).data(data);\n\n            dots.enter().append(\"circle\").attr(\"class\", dotClass);\n\n            var dotsT = dots;\n            if (self.config.transition) {\n                dotsT = dots.transition();\n            }\n\n            dotsT.attr(\"r\", self.config.dot.radius).attr(\"cx\", plot.x.map).attr(\"cy\", plot.y.map);\n\n            if (plot.tooltip) {\n                dots.on(\"mouseover\", function (d) {\n                    plot.tooltip.transition().duration(200).style(\"opacity\", .9);\n                    var html = \"(\" + plot.x.value(d) + \", \" + plot.y.value(d) + \")\";\n                    var group = self.config.groups.value(d, self.config.groups.key);\n                    if (group || group === 0) {\n                        html += \"<br/>\";\n                        var label = self.config.groups.label;\n                        if (label) {\n                            html += label + \": \";\n                        }\n                        html += group;\n                    }\n                    plot.tooltip.html(html).style(\"left\", d3.event.pageX + 5 + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n                }).on(\"mouseout\", function (d) {\n                    plot.tooltip.transition().duration(500).style(\"opacity\", 0);\n                });\n            }\n\n            if (plot.dot.color) {\n                dots.style(\"fill\", plot.dot.color);\n            }\n\n            dots.exit().remove();\n        }\n    }, {\n        key: \"updateLegend\",\n        value: function updateLegend() {\n\n            var plot = this.plot;\n\n            var scale = plot.dot.colorCategory;\n            if (!scale.domain() || scale.domain().length < 2) {\n                plot.showLegend = false;\n            }\n\n            if (!plot.showLegend) {\n                if (plot.legend && plot.legend.container) {\n                    plot.legend.container.remove();\n                }\n                return;\n            }\n\n            var legendX = this.plot.width + this.config.legend.margin;\n            var legendY = this.config.legend.margin;\n\n            plot.legend = new _legend.Legend(this.svg, this.svgG, scale, legendX, legendY);\n\n            var legendLinear = plot.legend.color().shapeWidth(this.config.legend.shapeWidth).orient('vertical').scale(scale);\n\n            plot.legend.container.call(legendLinear);\n        }\n    }]);\n\n    return ScatterPlot;\n}(_chart.Chart);\n\n},{\"./chart\":19,\"./legend\":23,\"./utils\":29}],27:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.tdistr = tdistr;\n/*\n * https://gist.github.com/benrasmusen/1261977\n * NAME\n * \n * statistics-distributions.js - JavaScript library for calculating\n *   critical values and upper probabilities of common statistical\n *   distributions\n * \n * SYNOPSIS\n * \n * \n *   // Chi-squared-crit (2 degrees of freedom, 95th percentile = 0.05 level\n *   chisqrdistr(2, .05)\n *   \n *   // u-crit (95th percentile = 0.05 level)\n *   udistr(.05);\n *   \n *   // t-crit (1 degree of freedom, 99.5th percentile = 0.005 level) \n *   tdistr(1,.005);\n *   \n *   // F-crit (1 degree of freedom in numerator, 3 degrees of freedom \n *   //         in denominator, 99th percentile = 0.01 level)\n *   fdistr(1,3,.01);\n *   \n *   // upper probability of the u distribution (u = -0.85): Q(u) = 1-G(u)\n *   uprob(-0.85);\n *   \n *   // upper probability of the chi-square distribution\n *   // (3 degrees of freedom, chi-squared = 6.25): Q = 1-G\n *   chisqrprob(3,6.25);\n *   \n *   // upper probability of the t distribution\n *   // (3 degrees of freedom, t = 6.251): Q = 1-G\n *   tprob(3,6.251);\n *   \n *   // upper probability of the F distribution\n *   // (3 degrees of freedom in numerator, 5 degrees of freedom in\n *   //  denominator, F = 6.25): Q = 1-G\n *   fprob(3,5,.625);\n * \n * \n *  DESCRIPTION\n * \n * This library calculates percentage points (5 significant digits) of the u\n * (standard normal) distribution, the student's t distribution, the\n * chi-square distribution and the F distribution. It can also calculate the\n * upper probability (5 significant digits) of the u (standard normal), the\n * chi-square, the t and the F distribution.\n * \n * These critical values are needed to perform statistical tests, like the u\n * test, the t test, the F test and the chi-squared test, and to calculate\n * confidence intervals.\n * \n * If you are interested in more precise algorithms you could look at:\n *   StatLib: http://lib.stat.cmu.edu/apstat/ ; \n *   Applied Statistics Algorithms by Griffiths, P. and Hill, I.D.\n *   , Ellis Horwood: Chichester (1985)\n * \n * BUGS \n * \n * This port was produced from the Perl module Statistics::Distributions\n * that has had no bug reports in several years.  If you find a bug then\n * please double-check that JavaScript does not thing the numbers you are\n * passing in are strings.  (You can subtract 0 from them as you pass them\n * in so that \"5\" is properly understood to be 5.)  If you have passed in a\n * number then please contact the author\n * \n * AUTHOR\n * \n * Ben Tilly <btilly@gmail.com>\n * \n * Originl Perl version by Michael Kospach <mike.perl@gmx.at>\n * \n * Nice formating, simplification and bug repair by Matthias Trautner Kromann\n * <mtk@id.cbs.dk>\n * \n * COPYRIGHT \n * \n * Copyright 2008 Ben Tilly.\n * \n * This library is free software; you can redistribute it and/or modify it\n * under the same terms as Perl itself.  This means under either the Perl\n * Artistic License or the GPL v1 or later.\n */\n\nvar SIGNIFICANT = 5; // number of significant digits to be returned\n\nfunction chisqrdistr($n, $p) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\"; /* degree of freedom */\n\t}\n\tif ($p <= 0 || $p > 1) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\treturn precision_string(_subchisqr($n - 0, $p - 0));\n}\n\nfunction udistr($p) {\n\tif ($p > 1 || $p <= 0) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\treturn precision_string(_subu($p - 0));\n}\n\nfunction tdistr($n, $p) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\";\n\t}\n\tif ($p <= 0 || $p >= 1) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\treturn precision_string(_subt($n - 0, $p - 0));\n}\n\nfunction fdistr($n, $m, $p) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\"; /* first degree of freedom */\n\t}\n\tif ($m <= 0 || Math.abs($m) - Math.abs(integer($m)) != 0) {\n\t\tthrow \"Invalid m: $m\\n\"; /* second degree of freedom */\n\t}\n\tif ($p <= 0 || $p > 1) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\treturn precision_string(_subf($n - 0, $m - 0, $p - 0));\n}\n\nfunction uprob($x) {\n\treturn precision_string(_subuprob($x - 0));\n}\n\nfunction chisqrprob($n, $x) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\"; /* degree of freedom */\n\t}\n\treturn precision_string(_subchisqrprob($n - 0, $x - 0));\n}\n\nfunction tprob($n, $x) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\"; /* degree of freedom */\n\t}\n\treturn precision_string(_subtprob($n - 0, $x - 0));\n}\n\nfunction fprob($n, $m, $x) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow \"Invalid n: $n\\n\"; /* first degree of freedom */\n\t}\n\tif ($m <= 0 || Math.abs($m) - Math.abs(integer($m)) != 0) {\n\t\tthrow \"Invalid m: $m\\n\"; /* second degree of freedom */\n\t}\n\treturn precision_string(_subfprob($n - 0, $m - 0, $x - 0));\n}\n\nfunction _subfprob($n, $m, $x) {\n\tvar $p;\n\n\tif ($x <= 0) {\n\t\t$p = 1;\n\t} else if ($m % 2 == 0) {\n\t\tvar $z = $m / ($m + $n * $x);\n\t\tvar $a = 1;\n\t\tfor (var $i = $m - 2; $i >= 2; $i -= 2) {\n\t\t\t$a = 1 + ($n + $i - 2) / $i * $z * $a;\n\t\t}\n\t\t$p = 1 - Math.pow(1 - $z, $n / 2 * $a);\n\t} else if ($n % 2 == 0) {\n\t\tvar $z = $n * $x / ($m + $n * $x);\n\t\tvar $a = 1;\n\t\tfor (var $i = $n - 2; $i >= 2; $i -= 2) {\n\t\t\t$a = 1 + ($m + $i - 2) / $i * $z * $a;\n\t\t}\n\t\t$p = Math.pow(1 - $z, $m / 2) * $a;\n\t} else {\n\t\tvar $y = Math.atan2(Math.sqrt($n * $x / $m), 1);\n\t\tvar $z = Math.pow(Math.sin($y), 2);\n\t\tvar $a = $n == 1 ? 0 : 1;\n\t\tfor (var $i = $n - 2; $i >= 3; $i -= 2) {\n\t\t\t$a = 1 + ($m + $i - 2) / $i * $z * $a;\n\t\t}\n\t\tvar $b = Math.PI;\n\t\tfor (var $i = 2; $i <= $m - 1; $i += 2) {\n\t\t\t$b *= ($i - 1) / $i;\n\t\t}\n\t\tvar $p1 = 2 / $b * Math.sin($y) * Math.pow(Math.cos($y), $m) * $a;\n\n\t\t$z = Math.pow(Math.cos($y), 2);\n\t\t$a = $m == 1 ? 0 : 1;\n\t\tfor (var $i = $m - 2; $i >= 3; $i -= 2) {\n\t\t\t$a = 1 + ($i - 1) / $i * $z * $a;\n\t\t}\n\t\t$p = max(0, $p1 + 1 - 2 * $y / Math.PI - 2 / Math.PI * Math.sin($y) * Math.cos($y) * $a);\n\t}\n\treturn $p;\n}\n\nfunction _subchisqrprob($n, $x) {\n\tvar $p;\n\n\tif ($x <= 0) {\n\t\t$p = 1;\n\t} else if ($n > 100) {\n\t\t$p = _subuprob((Math.pow($x / $n, 1 / 3) - (1 - 2 / 9 / $n)) / Math.sqrt(2 / 9 / $n));\n\t} else if ($x > 400) {\n\t\t$p = 0;\n\t} else {\n\t\tvar $a;\n\t\tvar $i;\n\t\tvar $i1;\n\t\tif ($n % 2 != 0) {\n\t\t\t$p = 2 * _subuprob(Math.sqrt($x));\n\t\t\t$a = Math.sqrt(2 / Math.PI) * Math.exp(-$x / 2) / Math.sqrt($x);\n\t\t\t$i1 = 1;\n\t\t} else {\n\t\t\t$p = $a = Math.exp(-$x / 2);\n\t\t\t$i1 = 2;\n\t\t}\n\n\t\tfor ($i = $i1; $i <= $n - 2; $i += 2) {\n\t\t\t$a *= $x / $i;\n\t\t\t$p += $a;\n\t\t}\n\t}\n\treturn $p;\n}\n\nfunction _subu($p) {\n\tvar $y = -Math.log(4 * $p * (1 - $p));\n\tvar $x = Math.sqrt($y * (1.570796288 + $y * (.03706987906 + $y * (-.8364353589E-3 + $y * (-.2250947176E-3 + $y * (.6841218299E-5 + $y * (0.5824238515E-5 + $y * (-.104527497E-5 + $y * (.8360937017E-7 + $y * (-.3231081277E-8 + $y * (.3657763036E-10 + $y * .6936233982E-12)))))))))));\n\tif ($p > .5) $x = -$x;\n\treturn $x;\n}\n\nfunction _subuprob($x) {\n\tvar $p = 0; /* if ($absx > 100) */\n\tvar $absx = Math.abs($x);\n\n\tif ($absx < 1.9) {\n\t\t$p = Math.pow(1 + $absx * (.049867347 + $absx * (.0211410061 + $absx * (.0032776263 + $absx * (.0000380036 + $absx * (.0000488906 + $absx * .000005383))))), -16) / 2;\n\t} else if ($absx <= 100) {\n\t\tfor (var $i = 18; $i >= 1; $i--) {\n\t\t\t$p = $i / ($absx + $p);\n\t\t}\n\t\t$p = Math.exp(-.5 * $absx * $absx) / Math.sqrt(2 * Math.PI) / ($absx + $p);\n\t}\n\n\tif ($x < 0) $p = 1 - $p;\n\treturn $p;\n}\n\nfunction _subt($n, $p) {\n\n\tif ($p >= 1 || $p <= 0) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\n\tif ($p == 0.5) {\n\t\treturn 0;\n\t} else if ($p < 0.5) {\n\t\treturn -_subt($n, 1 - $p);\n\t}\n\n\tvar $u = _subu($p);\n\tvar $u2 = Math.pow($u, 2);\n\n\tvar $a = ($u2 + 1) / 4;\n\tvar $b = ((5 * $u2 + 16) * $u2 + 3) / 96;\n\tvar $c = (((3 * $u2 + 19) * $u2 + 17) * $u2 - 15) / 384;\n\tvar $d = ((((79 * $u2 + 776) * $u2 + 1482) * $u2 - 1920) * $u2 - 945) / 92160;\n\tvar $e = (((((27 * $u2 + 339) * $u2 + 930) * $u2 - 1782) * $u2 - 765) * $u2 + 17955) / 368640;\n\n\tvar $x = $u * (1 + ($a + ($b + ($c + ($d + $e / $n) / $n) / $n) / $n) / $n);\n\n\tif ($n <= Math.pow(log10($p), 2) + 3) {\n\t\tvar $round;\n\t\tdo {\n\t\t\tvar $p1 = _subtprob($n, $x);\n\t\t\tvar $n1 = $n + 1;\n\t\t\tvar $delta = ($p1 - $p) / Math.exp(($n1 * Math.log($n1 / ($n + $x * $x)) + Math.log($n / $n1 / 2 / Math.PI) - 1 + (1 / $n1 - 1 / $n) / 6) / 2);\n\t\t\t$x += $delta;\n\t\t\t$round = round_to_precision($delta, Math.abs(integer(log10(Math.abs($x)) - 4)));\n\t\t} while ($x && $round != 0);\n\t}\n\treturn $x;\n}\n\nfunction _subtprob($n, $x) {\n\n\tvar $a;\n\tvar $b;\n\tvar $w = Math.atan2($x / Math.sqrt($n), 1);\n\tvar $z = Math.pow(Math.cos($w), 2);\n\tvar $y = 1;\n\n\tfor (var $i = $n - 2; $i >= 2; $i -= 2) {\n\t\t$y = 1 + ($i - 1) / $i * $z * $y;\n\t}\n\n\tif ($n % 2 == 0) {\n\t\t$a = Math.sin($w) / 2;\n\t\t$b = .5;\n\t} else {\n\t\t$a = $n == 1 ? 0 : Math.sin($w) * Math.cos($w) / Math.PI;\n\t\t$b = .5 + $w / Math.PI;\n\t}\n\treturn max(0, 1 - $b - $a * $y);\n}\n\nfunction _subf($n, $m, $p) {\n\tvar $x;\n\n\tif ($p >= 1 || $p <= 0) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t}\n\n\tif ($p == 1) {\n\t\t$x = 0;\n\t} else if ($m == 1) {\n\t\t$x = 1 / Math.pow(_subt($n, 0.5 - $p / 2), 2);\n\t} else if ($n == 1) {\n\t\t$x = Math.pow(_subt($m, $p / 2), 2);\n\t} else if ($m == 2) {\n\t\tvar $u = _subchisqr($m, 1 - $p);\n\t\tvar $a = $m - 2;\n\t\t$x = 1 / ($u / $m * (1 + (($u - $a) / 2 + (((4 * $u - 11 * $a) * $u + $a * (7 * $m - 10)) / 24 + (((2 * $u - 10 * $a) * $u + $a * (17 * $m - 26)) * $u - $a * $a * (9 * $m - 6)) / 48 / $n) / $n) / $n));\n\t} else if ($n > $m) {\n\t\t$x = 1 / _subf2($m, $n, 1 - $p);\n\t} else {\n\t\t$x = _subf2($n, $m, $p);\n\t}\n\treturn $x;\n}\n\nfunction _subf2($n, $m, $p) {\n\tvar $u = _subchisqr($n, $p);\n\tvar $n2 = $n - 2;\n\tvar $x = $u / $n * (1 + (($u - $n2) / 2 + (((4 * $u - 11 * $n2) * $u + $n2 * (7 * $n - 10)) / 24 + (((2 * $u - 10 * $n2) * $u + $n2 * (17 * $n - 26)) * $u - $n2 * $n2 * (9 * $n - 6)) / 48 / $m) / $m) / $m);\n\tvar $delta;\n\tdo {\n\t\tvar $z = Math.exp((($n + $m) * Math.log(($n + $m) / ($n * $x + $m)) + ($n - 2) * Math.log($x) + Math.log($n * $m / ($n + $m)) - Math.log(4 * Math.PI) - (1 / $n + 1 / $m - 1 / ($n + $m)) / 6) / 2);\n\t\t$delta = (_subfprob($n, $m, $x) - $p) / $z;\n\t\t$x += $delta;\n\t} while (Math.abs($delta) > 3e-4);\n\treturn $x;\n}\n\nfunction _subchisqr($n, $p) {\n\tvar $x;\n\n\tif ($p > 1 || $p <= 0) {\n\t\tthrow \"Invalid p: $p\\n\";\n\t} else if ($p == 1) {\n\t\t$x = 0;\n\t} else if ($n == 1) {\n\t\t$x = Math.pow(_subu($p / 2), 2);\n\t} else if ($n == 2) {\n\t\t$x = -2 * Math.log($p);\n\t} else {\n\t\tvar $u = _subu($p);\n\t\tvar $u2 = $u * $u;\n\n\t\t$x = max(0, $n + Math.sqrt(2 * $n) * $u + 2 / 3 * ($u2 - 1) + $u * ($u2 - 7) / 9 / Math.sqrt(2 * $n) - 2 / 405 / $n * ($u2 * (3 * $u2 + 7) - 16));\n\n\t\tif ($n <= 100) {\n\t\t\tvar $x0;\n\t\t\tvar $p1;\n\t\t\tvar $z;\n\t\t\tdo {\n\t\t\t\t$x0 = $x;\n\t\t\t\tif ($x < 0) {\n\t\t\t\t\t$p1 = 1;\n\t\t\t\t} else if ($n > 100) {\n\t\t\t\t\t$p1 = _subuprob((Math.pow($x / $n, 1 / 3) - (1 - 2 / 9 / $n)) / Math.sqrt(2 / 9 / $n));\n\t\t\t\t} else if ($x > 400) {\n\t\t\t\t\t$p1 = 0;\n\t\t\t\t} else {\n\t\t\t\t\tvar $i0;\n\t\t\t\t\tvar $a;\n\t\t\t\t\tif ($n % 2 != 0) {\n\t\t\t\t\t\t$p1 = 2 * _subuprob(Math.sqrt($x));\n\t\t\t\t\t\t$a = Math.sqrt(2 / Math.PI) * Math.exp(-$x / 2) / Math.sqrt($x);\n\t\t\t\t\t\t$i0 = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$p1 = $a = Math.exp(-$x / 2);\n\t\t\t\t\t\t$i0 = 2;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var $i = $i0; $i <= $n - 2; $i += 2) {\n\t\t\t\t\t\t$a *= $x / $i;\n\t\t\t\t\t\t$p1 += $a;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$z = Math.exp((($n - 1) * Math.log($x / $n) - Math.log(4 * Math.PI * $x) + $n - $x - 1 / $n / 6) / 2);\n\t\t\t\t$x += ($p1 - $p) / $z;\n\t\t\t\t$x = round_to_precision($x, 5);\n\t\t\t} while ($n < 31 && Math.abs($x0 - $x) > 1e-4);\n\t\t}\n\t}\n\treturn $x;\n}\n\nfunction log10($n) {\n\treturn Math.log($n) / Math.log(10);\n}\n\nfunction max() {\n\tvar $max = arguments[0];\n\tfor (var $i = 0; i < arguments.length; i++) {\n\t\tif ($max < arguments[$i]) $max = arguments[$i];\n\t}\n\treturn $max;\n}\n\nfunction min() {\n\tvar $min = arguments[0];\n\tfor (var $i = 0; i < arguments.length; i++) {\n\t\tif ($min > arguments[$i]) $min = arguments[$i];\n\t}\n\treturn $min;\n}\n\nfunction precision($x) {\n\treturn Math.abs(integer(log10(Math.abs($x)) - SIGNIFICANT));\n}\n\nfunction precision_string($x) {\n\tif ($x) {\n\t\treturn round_to_precision($x, precision($x));\n\t} else {\n\t\treturn \"0\";\n\t}\n}\n\nfunction round_to_precision($x, $p) {\n\t$x = $x * Math.pow(10, $p);\n\t$x = Math.round($x);\n\treturn $x / Math.pow(10, $p);\n}\n\nfunction integer($i) {\n\tif ($i > 0) return Math.floor($i);else return Math.ceil($i);\n}\n\n},{}],28:[function(require,module,exports){\n'use strict';\n\nvar _statisticsDistributions = require('./statistics-distributions');\n\nvar su = module.exports.StatisticsUtils = {};\nsu.sampleCorrelation = require('../bower_components/simple-statistics/src/sample_correlation');\nsu.linearRegression = require('../bower_components/simple-statistics/src/linear_regression');\nsu.linearRegressionLine = require('../bower_components/simple-statistics/src/linear_regression_line');\nsu.errorFunction = require('../bower_components/simple-statistics/src/error_function');\nsu.standardDeviation = require('../bower_components/simple-statistics/src/standard_deviation');\nsu.sampleStandardDeviation = require('../bower_components/simple-statistics/src/sample_standard_deviation');\nsu.variance = require('../bower_components/simple-statistics/src/variance');\nsu.mean = require('../bower_components/simple-statistics/src/mean');\nsu.zScore = require('../bower_components/simple-statistics/src/z_score');\nsu.standardError = function (arr) {\n    return Math.sqrt(su.variance(arr) / (arr.length - 1));\n};\n\nsu.tValue = function (degreesOfFreedom, criticalProbability) {\n    //as in http://stattrek.com/online-calculator/t-distribution.aspx\n    return (0, _statisticsDistributions.tdistr)(degreesOfFreedom, criticalProbability);\n};\n\n},{\"../bower_components/simple-statistics/src/error_function\":6,\"../bower_components/simple-statistics/src/linear_regression\":7,\"../bower_components/simple-statistics/src/linear_regression_line\":8,\"../bower_components/simple-statistics/src/mean\":9,\"../bower_components/simple-statistics/src/sample_correlation\":10,\"../bower_components/simple-statistics/src/sample_standard_deviation\":12,\"../bower_components/simple-statistics/src/standard_deviation\":14,\"../bower_components/simple-statistics/src/variance\":17,\"../bower_components/simple-statistics/src/z_score\":18,\"./statistics-distributions\":27}],29:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Utils = exports.Utils = function () {\n    function Utils() {\n        _classCallCheck(this, Utils);\n    }\n\n    _createClass(Utils, null, [{\n        key: 'deepExtend',\n\n        // usage example deepExtend({}, objA, objB); => should work similar to $.extend(true, {}, objA, objB);\n        value: function deepExtend(out) {\n\n            var utils = this;\n            var emptyOut = {};\n\n            if (!out && arguments.length > 1 && Array.isArray(arguments[1])) {\n                out = [];\n            }\n            out = out || {};\n\n            for (var i = 1; i < arguments.length; i++) {\n                var source = arguments[i];\n                if (!source) continue;\n\n                for (var key in source) {\n                    if (!source.hasOwnProperty(key)) {\n                        continue;\n                    }\n                    var isArray = Array.isArray(out[key]);\n                    var isObject = utils.isObject(out[key]);\n                    var srcObj = utils.isObject(source[key]);\n\n                    if (isObject && !isArray && srcObj) {\n                        utils.deepExtend(out[key], source[key]);\n                    } else {\n                        out[key] = source[key];\n                    }\n                }\n            }\n\n            return out;\n        }\n    }, {\n        key: 'mergeDeep',\n        value: function mergeDeep(target, source) {\n            var output = Object.assign({}, target);\n            if (Utils.isObjectNotArray(target) && Utils.isObjectNotArray(source)) {\n                Object.keys(source).forEach(function (key) {\n                    if (Utils.isObjectNotArray(source[key])) {\n                        if (!(key in target)) Object.assign(output, _defineProperty({}, key, source[key]));else output[key] = Utils.mergeDeep(target[key], source[key]);\n                    } else {\n                        Object.assign(output, _defineProperty({}, key, source[key]));\n                    }\n                });\n            }\n            return output;\n        }\n    }, {\n        key: 'cross',\n        value: function cross(a, b) {\n            var c = [],\n                n = a.length,\n                m = b.length,\n                i,\n                j;\n            for (i = -1; ++i < n;) {\n                for (j = -1; ++j < m;) {\n                    c.push({ x: a[i], i: i, y: b[j], j: j });\n                }\n            }return c;\n        }\n    }, {\n        key: 'inferVariables',\n        value: function inferVariables(data, groupKey, includeGroup) {\n            var res = [];\n            if (data.length) {\n                var d = data[0];\n                if (d instanceof Array) {\n                    res = d.map(function (v, i) {\n                        return i;\n                    });\n                } else if ((typeof d === 'undefined' ? 'undefined' : _typeof(d)) === 'object') {\n\n                    for (var prop in d) {\n                        if (!d.hasOwnProperty(prop)) continue;\n\n                        res.push(prop);\n                    }\n                }\n            }\n            if (!includeGroup) {\n                var index = res.indexOf(groupKey);\n                if (index > -1) {\n                    res.splice(index, 1);\n                }\n            }\n            return res;\n        }\n    }, {\n        key: 'isObjectNotArray',\n        value: function isObjectNotArray(item) {\n            return item && (typeof item === 'undefined' ? 'undefined' : _typeof(item)) === 'object' && !Array.isArray(item) && item !== null;\n        }\n    }, {\n        key: 'isObject',\n        value: function isObject(a) {\n            return a !== null && (typeof a === 'undefined' ? 'undefined' : _typeof(a)) === 'object';\n        }\n    }, {\n        key: 'isNumber',\n        value: function isNumber(a) {\n            return !isNaN(a) && typeof a === 'number';\n        }\n    }, {\n        key: 'isFunction',\n        value: function isFunction(a) {\n            return typeof a === 'function';\n        }\n    }, {\n        key: 'insertOrAppendSelector',\n        value: function insertOrAppendSelector(parent, selector, operation, before) {\n            var selectorParts = selector.split(/([\\.\\#])/);\n            var element = parent[operation](selectorParts.shift(), before); //\":first-child\"\n            while (selectorParts.length > 1) {\n                var selectorModifier = selectorParts.shift();\n                var selectorItem = selectorParts.shift();\n                if (selectorModifier === \".\") {\n                    element = element.classed(selectorItem, true);\n                } else if (selectorModifier === \"#\") {\n                    element = element.attr('id', selectorItem);\n                }\n            }\n            return element;\n        }\n    }, {\n        key: 'insertSelector',\n        value: function insertSelector(parent, selector, before) {\n            return Utils.insertOrAppendSelector(parent, selector, \"insert\", before);\n        }\n    }, {\n        key: 'appendSelector',\n        value: function appendSelector(parent, selector) {\n            return Utils.insertOrAppendSelector(parent, selector, \"append\");\n        }\n    }, {\n        key: 'selectOrAppend',\n        value: function selectOrAppend(parent, selector, element) {\n            var selection = parent.select(selector);\n            if (selection.empty()) {\n                if (element) {\n                    return parent.append(element);\n                }\n                return Utils.appendSelector(parent, selector);\n            }\n            return selection;\n        }\n    }, {\n        key: 'selectOrInsert',\n        value: function selectOrInsert(parent, selector, before) {\n            var selection = parent.select(selector);\n            if (selection.empty()) {\n                return Utils.insertSelector(parent, selector, before);\n            }\n            return selection;\n        }\n    }, {\n        key: 'linearGradient',\n        value: function linearGradient(svg, gradientId, range, x1, y1, x2, y2) {\n            var defs = Utils.selectOrAppend(svg, \"defs\");\n            var linearGradient = defs.append(\"linearGradient\").attr(\"id\", gradientId);\n\n            linearGradient.attr(\"x1\", x1 + \"%\").attr(\"y1\", y1 + \"%\").attr(\"x2\", x2 + \"%\").attr(\"y2\", y2 + \"%\");\n\n            //Append multiple color stops by using D3's data/enter step\n            var stops = linearGradient.selectAll(\"stop\").data(range);\n\n            stops.enter().append(\"stop\");\n\n            stops.attr(\"offset\", function (d, i) {\n                return i / (range.length - 1);\n            }).attr(\"stop-color\", function (d) {\n                return d;\n            });\n\n            stops.exit().remove();\n        }\n    }]);\n\n    return Utils;\n}();\n\nUtils.sanitizeHeight = function (height, container) {\n    return height || parseInt(container.style('height'), 10) || 400;\n};\n\nUtils.sanitizeWidth = function (width, container) {\n    return width || parseInt(container.style('width'), 10) || 960;\n};\n\nUtils.availableHeight = function (height, container, margin) {\n    return Math.max(0, Utils.sanitizeHeight(height, container) - margin.top - margin.bottom);\n};\n\nUtils.availableWidth = function (width, container, margin) {\n    return Math.max(0, Utils.sanitizeWidth(width, container) - margin.left - margin.right);\n};\n\n},{}]},{},[22])(22)\n});\n\n","module.exports = {\r\n  color: require('./src/color'),\r\n  size: require('./src/size'),\r\n  symbol: require('./src/symbol')\r\n};\r\n","var helper = require('./legend');\r\n\r\nmodule.exports = function(){\r\n\r\n  var scale = d3.scale.linear(),\r\n    shape = \"rect\",\r\n    shapeWidth = 15,\r\n    shapeHeight = 15,\r\n    shapeRadius = 10,\r\n    shapePadding = 2,\r\n    cells = [5],\r\n    labels = [],\r\n    classPrefix = \"\",\r\n    useClass = false,\r\n    title = \"\",\r\n    labelFormat = d3.format(\".01f\"),\r\n    labelOffset = 10,\r\n    labelAlign = \"middle\",\r\n    labelDelimiter = \"to\",\r\n    orient = \"vertical\",\r\n    ascending = false,\r\n    path,\r\n    legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\r\n\r\n    function legend(svg){\r\n\r\n      var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\r\n        legendG = svg.selectAll('g').data([scale]);\r\n\r\n      legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\r\n\r\n\r\n      var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\r\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6),\r\n        shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"),\r\n        shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\r\n\r\n      //add event handlers\r\n      helper.d3_addEvents(cellEnter, legendDispatcher);\r\n\r\n      cell.exit().transition().style(\"opacity\", 0).remove();\r\n\r\n      helper.d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, path);\r\n\r\n      helper.d3_addText(legendG, cellEnter, type.labels, classPrefix)\r\n\r\n      // sets placement\r\n      var text = cell.select(\"text\"),\r\n        shapeSize = shapes[0].map( function(d){ return d.getBBox(); });\r\n\r\n      //sets scale\r\n      //everything is fill except for line which is stroke,\r\n      if (!useClass){\r\n        if (shape == \"line\"){\r\n          shapes.style(\"stroke\", type.feature);\r\n        } else {\r\n          shapes.style(\"fill\", type.feature);\r\n        }\r\n      } else {\r\n        shapes.attr(\"class\", function(d){ return classPrefix + \"swatch \" + type.feature(d); });\r\n      }\r\n\r\n      var cellTrans,\r\n      textTrans,\r\n      textAlign = (labelAlign == \"start\") ? 0 : (labelAlign == \"middle\") ? 0.5 : 1;\r\n\r\n      //positions cells and text\r\n      if (orient === \"vertical\"){\r\n        cellTrans = function(d,i) { return \"translate(0, \" + (i * (shapeSize[i].height + shapePadding)) + \")\"; };\r\n        textTrans = function(d,i) { return \"translate(\" + (shapeSize[i].width + shapeSize[i].x +\r\n          labelOffset) + \",\" + (shapeSize[i].y + shapeSize[i].height/2 + 5) + \")\"; };\r\n\r\n      } else if (orient === \"horizontal\"){\r\n        cellTrans = function(d,i) { return \"translate(\" + (i * (shapeSize[i].width + shapePadding)) + \",0)\"; }\r\n        textTrans = function(d,i) { return \"translate(\" + (shapeSize[i].width*textAlign  + shapeSize[i].x) +\r\n          \",\" + (shapeSize[i].height + shapeSize[i].y + labelOffset + 8) + \")\"; };\r\n      }\r\n\r\n      helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\r\n      helper.d3_title(svg, legendG, title, classPrefix);\r\n\r\n      cell.transition().style(\"opacity\", 1);\r\n\r\n    }\r\n\r\n\r\n\r\n  legend.scale = function(_) {\r\n    if (!arguments.length) return scale;\r\n    scale = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.cells = function(_) {\r\n    if (!arguments.length) return cells;\r\n    if (_.length > 1 || _ >= 2 ){\r\n      cells = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.shape = function(_, d) {\r\n    if (!arguments.length) return shape;\r\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\" || (_ == \"path\" && (typeof d === 'string')) ){\r\n      shape = _;\r\n      path = d;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.shapeWidth = function(_) {\r\n    if (!arguments.length) return shapeWidth;\r\n    shapeWidth = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.shapeHeight = function(_) {\r\n    if (!arguments.length) return shapeHeight;\r\n    shapeHeight = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.shapeRadius = function(_) {\r\n    if (!arguments.length) return shapeRadius;\r\n    shapeRadius = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.shapePadding = function(_) {\r\n    if (!arguments.length) return shapePadding;\r\n    shapePadding = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labels = function(_) {\r\n    if (!arguments.length) return labels;\r\n    labels = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelAlign = function(_) {\r\n    if (!arguments.length) return labelAlign;\r\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\r\n      labelAlign = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.labelFormat = function(_) {\r\n    if (!arguments.length) return labelFormat;\r\n    labelFormat = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelOffset = function(_) {\r\n    if (!arguments.length) return labelOffset;\r\n    labelOffset = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelDelimiter = function(_) {\r\n    if (!arguments.length) return labelDelimiter;\r\n    labelDelimiter = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.useClass = function(_) {\r\n    if (!arguments.length) return useClass;\r\n    if (_ === true || _ === false){\r\n      useClass = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.orient = function(_){\r\n    if (!arguments.length) return orient;\r\n    _ = _.toLowerCase();\r\n    if (_ == \"horizontal\" || _ == \"vertical\") {\r\n      orient = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.ascending = function(_) {\r\n    if (!arguments.length) return ascending;\r\n    ascending = !!_;\r\n    return legend;\r\n  };\r\n\r\n  legend.classPrefix = function(_) {\r\n    if (!arguments.length) return classPrefix;\r\n    classPrefix = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.title = function(_) {\r\n    if (!arguments.length) return title;\r\n    title = _;\r\n    return legend;\r\n  };\r\n\r\n  d3.rebind(legend, legendDispatcher, \"on\");\r\n\r\n  return legend;\r\n\r\n};\r\n","module.exports = {\r\n\r\n  d3_identity: function (d) {\r\n    return d;\r\n  },\r\n\r\n  d3_mergeLabels: function (gen, labels) {\r\n\r\n      if(labels.length === 0) return gen;\r\n\r\n      gen = (gen) ? gen : [];\r\n\r\n      var i = labels.length;\r\n      for (; i < gen.length; i++) {\r\n        labels.push(gen[i]);\r\n      }\r\n      return labels;\r\n    },\r\n\r\n  d3_linearLegend: function (scale, cells, labelFormat) {\r\n    var data = [];\r\n\r\n    if (cells.length > 1){\r\n      data = cells;\r\n\r\n    } else {\r\n      var domain = scale.domain(),\r\n      increment = (domain[domain.length - 1] - domain[0])/(cells - 1),\r\n      i = 0;\r\n\r\n      for (; i < cells; i++){\r\n        data.push(domain[0] + i*increment);\r\n      }\r\n    }\r\n\r\n    var labels = data.map(labelFormat);\r\n\r\n    return {data: data,\r\n            labels: labels,\r\n            feature: function(d){ return scale(d); }};\r\n  },\r\n\r\n  d3_quantLegend: function (scale, labelFormat, labelDelimiter) {\r\n    var labels = scale.range().map(function(d){\r\n      var invert = scale.invertExtent(d),\r\n      a = labelFormat(invert[0]),\r\n      b = labelFormat(invert[1]);\r\n\r\n      // if (( (a) && (a.isNan()) && b){\r\n      //   console.log(\"in initial statement\")\r\n        return labelFormat(invert[0]) + \" \" + labelDelimiter + \" \" + labelFormat(invert[1]);\r\n      // } else if (a || b) {\r\n      //   console.log('in else statement')\r\n      //   return (a) ? a : b;\r\n      // }\r\n\r\n    });\r\n\r\n    return {data: scale.range(),\r\n            labels: labels,\r\n            feature: this.d3_identity\r\n          };\r\n  },\r\n\r\n  d3_ordinalLegend: function (scale) {\r\n    return {data: scale.domain(),\r\n            labels: scale.domain(),\r\n            feature: function(d){ return scale(d); }};\r\n  },\r\n\r\n  d3_drawShapes: function (shape, shapes, shapeHeight, shapeWidth, shapeRadius, path) {\r\n    if (shape === \"rect\"){\r\n        shapes.attr(\"height\", shapeHeight).attr(\"width\", shapeWidth);\r\n\r\n    } else if (shape === \"circle\") {\r\n        shapes.attr(\"r\", shapeRadius)//.attr(\"cx\", shapeRadius).attr(\"cy\", shapeRadius);\r\n\r\n    } else if (shape === \"line\") {\r\n        shapes.attr(\"x1\", 0).attr(\"x2\", shapeWidth).attr(\"y1\", 0).attr(\"y2\", 0);\r\n\r\n    } else if (shape === \"path\") {\r\n      shapes.attr(\"d\", path);\r\n    }\r\n  },\r\n\r\n  d3_addText: function (svg, enter, labels, classPrefix){\r\n    enter.append(\"text\").attr(\"class\", classPrefix + \"label\");\r\n    svg.selectAll(\"g.\" + classPrefix + \"cell text\").data(labels).text(this.d3_identity);\r\n  },\r\n\r\n  d3_calcType: function (scale, ascending, cells, labels, labelFormat, labelDelimiter){\r\n    var type = scale.ticks ?\r\n            this.d3_linearLegend(scale, cells, labelFormat) : scale.invertExtent ?\r\n            this.d3_quantLegend(scale, labelFormat, labelDelimiter) : this.d3_ordinalLegend(scale);\r\n\r\n    type.labels = this.d3_mergeLabels(type.labels, labels);\r\n\r\n    if (ascending) {\r\n      type.labels = this.d3_reverse(type.labels);\r\n      type.data = this.d3_reverse(type.data);\r\n    }\r\n\r\n    return type;\r\n  },\r\n\r\n  d3_reverse: function(arr) {\r\n    var mirror = [];\r\n    for (var i = 0, l = arr.length; i < l; i++) {\r\n      mirror[i] = arr[l-i-1];\r\n    }\r\n    return mirror;\r\n  },\r\n\r\n  d3_placement: function (orient, cell, cellTrans, text, textTrans, labelAlign) {\r\n    cell.attr(\"transform\", cellTrans);\r\n    text.attr(\"transform\", textTrans);\r\n    if (orient === \"horizontal\"){\r\n      text.style(\"text-anchor\", labelAlign);\r\n    }\r\n  },\r\n\r\n  d3_addEvents: function(cells, dispatcher){\r\n    var _ = this;\r\n\r\n      cells.on(\"mouseover.legend\", function (d) { _.d3_cellOver(dispatcher, d, this); })\r\n          .on(\"mouseout.legend\", function (d) { _.d3_cellOut(dispatcher, d, this); })\r\n          .on(\"click.legend\", function (d) { _.d3_cellClick(dispatcher, d, this); });\r\n  },\r\n\r\n  d3_cellOver: function(cellDispatcher, d, obj){\r\n    cellDispatcher.cellover.call(obj, d);\r\n  },\r\n\r\n  d3_cellOut: function(cellDispatcher, d, obj){\r\n    cellDispatcher.cellout.call(obj, d);\r\n  },\r\n\r\n  d3_cellClick: function(cellDispatcher, d, obj){\r\n    cellDispatcher.cellclick.call(obj, d);\r\n  },\r\n\r\n  d3_title: function(svg, cellsSvg, title, classPrefix){\r\n    if (title !== \"\"){\r\n\r\n      var titleText = svg.selectAll('text.' + classPrefix + 'legendTitle');\r\n\r\n      titleText.data([title])\r\n        .enter()\r\n        .append('text')\r\n        .attr('class', classPrefix + 'legendTitle');\r\n\r\n        svg.selectAll('text.' + classPrefix + 'legendTitle')\r\n            .text(title)\r\n\r\n      var yOffset = svg.select('.' + classPrefix + 'legendTitle')\r\n          .map(function(d) { return d[0].getBBox().height})[0],\r\n      xOffset = -cellsSvg.map(function(d) { return d[0].getBBox().x})[0];\r\n\r\n      cellsSvg.attr('transform', 'translate(' + xOffset + ',' + (yOffset + 10) + ')');\r\n\r\n    }\r\n  }\r\n}\r\n","var helper = require('./legend');\r\n\r\nmodule.exports =  function(){\r\n\r\n  var scale = d3.scale.linear(),\r\n    shape = \"rect\",\r\n    shapeWidth = 15,\r\n    shapePadding = 2,\r\n    cells = [5],\r\n    labels = [],\r\n    useStroke = false,\r\n    classPrefix = \"\",\r\n    title = \"\",\r\n    labelFormat = d3.format(\".01f\"),\r\n    labelOffset = 10,\r\n    labelAlign = \"middle\",\r\n    labelDelimiter = \"to\",\r\n    orient = \"vertical\",\r\n    ascending = false,\r\n    path,\r\n    legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\r\n\r\n    function legend(svg){\r\n\r\n      var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\r\n        legendG = svg.selectAll('g').data([scale]);\r\n\r\n      legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\r\n\r\n\r\n      var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\r\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6);\r\n        shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"),\r\n        shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\r\n\r\n      //add event handlers\r\n      helper.d3_addEvents(cellEnter, legendDispatcher);\r\n\r\n      cell.exit().transition().style(\"opacity\", 0).remove();\r\n\r\n      //creates shape\r\n      if (shape === \"line\"){\r\n        helper.d3_drawShapes(shape, shapes, 0, shapeWidth);\r\n        shapes.attr(\"stroke-width\", type.feature);\r\n      } else {\r\n        helper.d3_drawShapes(shape, shapes, type.feature, type.feature, type.feature, path);\r\n      }\r\n\r\n      helper.d3_addText(legendG, cellEnter, type.labels, classPrefix)\r\n\r\n      //sets placement\r\n      var text = cell.select(\"text\"),\r\n        shapeSize = shapes[0].map(\r\n          function(d, i){\r\n            var bbox = d.getBBox()\r\n            var stroke = scale(type.data[i]);\r\n\r\n            if (shape === \"line\" && orient === \"horizontal\") {\r\n              bbox.height = bbox.height + stroke;\r\n            } else if (shape === \"line\" && orient === \"vertical\"){\r\n              bbox.width = bbox.width;\r\n            }\r\n\r\n            return bbox;\r\n        });\r\n\r\n      var maxH = d3.max(shapeSize, function(d){ return d.height + d.y; }),\r\n      maxW = d3.max(shapeSize, function(d){ return d.width + d.x; });\r\n\r\n      var cellTrans,\r\n      textTrans,\r\n      textAlign = (labelAlign == \"start\") ? 0 : (labelAlign == \"middle\") ? 0.5 : 1;\r\n\r\n      //positions cells and text\r\n      if (orient === \"vertical\"){\r\n\r\n        cellTrans = function(d,i) {\r\n            var height = d3.sum(shapeSize.slice(0, i + 1 ), function(d){ return d.height; });\r\n            return \"translate(0, \" + (height + i*shapePadding) + \")\"; };\r\n\r\n        textTrans = function(d,i) { return \"translate(\" + (maxW + labelOffset) + \",\" +\r\n          (shapeSize[i].y + shapeSize[i].height/2 + 5) + \")\"; };\r\n\r\n      } else if (orient === \"horizontal\"){\r\n        cellTrans = function(d,i) {\r\n            var width = d3.sum(shapeSize.slice(0, i + 1 ), function(d){ return d.width; });\r\n            return \"translate(\" + (width + i*shapePadding) + \",0)\"; };\r\n\r\n        textTrans = function(d,i) { return \"translate(\" + (shapeSize[i].width*textAlign  + shapeSize[i].x) + \",\" +\r\n              (maxH + labelOffset ) + \")\"; };\r\n      }\r\n\r\n      helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\r\n      helper.d3_title(svg, legendG, title, classPrefix);\r\n\r\n      cell.transition().style(\"opacity\", 1);\r\n\r\n    }\r\n\r\n  legend.scale = function(_) {\r\n    if (!arguments.length) return scale;\r\n    scale = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.cells = function(_) {\r\n    if (!arguments.length) return cells;\r\n    if (_.length > 1 || _ >= 2 ){\r\n      cells = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n\r\n  legend.shape = function(_, d) {\r\n    if (!arguments.length) return shape;\r\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\" ){\r\n      shape = _;\r\n      path = d;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.shapeWidth = function(_) {\r\n    if (!arguments.length) return shapeWidth;\r\n    shapeWidth = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.shapePadding = function(_) {\r\n    if (!arguments.length) return shapePadding;\r\n    shapePadding = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labels = function(_) {\r\n    if (!arguments.length) return labels;\r\n    labels = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelAlign = function(_) {\r\n    if (!arguments.length) return labelAlign;\r\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\r\n      labelAlign = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.labelFormat = function(_) {\r\n    if (!arguments.length) return labelFormat;\r\n    labelFormat = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelOffset = function(_) {\r\n    if (!arguments.length) return labelOffset;\r\n    labelOffset = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelDelimiter = function(_) {\r\n    if (!arguments.length) return labelDelimiter;\r\n    labelDelimiter = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.orient = function(_){\r\n    if (!arguments.length) return orient;\r\n    _ = _.toLowerCase();\r\n    if (_ == \"horizontal\" || _ == \"vertical\") {\r\n      orient = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.ascending = function(_) {\r\n    if (!arguments.length) return ascending;\r\n    ascending = !!_;\r\n    return legend;\r\n  };\r\n\r\n  legend.classPrefix = function(_) {\r\n    if (!arguments.length) return classPrefix;\r\n    classPrefix = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.title = function(_) {\r\n    if (!arguments.length) return title;\r\n    title = _;\r\n    return legend;\r\n  };\r\n\r\n  d3.rebind(legend, legendDispatcher, \"on\");\r\n\r\n  return legend;\r\n\r\n};\r\n","var helper = require('./legend');\r\n\r\nmodule.exports = function(){\r\n\r\n  var scale = d3.scale.linear(),\r\n    shape = \"path\",\r\n    shapeWidth = 15,\r\n    shapeHeight = 15,\r\n    shapeRadius = 10,\r\n    shapePadding = 5,\r\n    cells = [5],\r\n    labels = [],\r\n    classPrefix = \"\",\r\n    useClass = false,\r\n    title = \"\",\r\n    labelFormat = d3.format(\".01f\"),\r\n    labelAlign = \"middle\",\r\n    labelOffset = 10,\r\n    labelDelimiter = \"to\",\r\n    orient = \"vertical\",\r\n    ascending = false,\r\n    legendDispatcher = d3.dispatch(\"cellover\", \"cellout\", \"cellclick\");\r\n\r\n    function legend(svg){\r\n\r\n      var type = helper.d3_calcType(scale, ascending, cells, labels, labelFormat, labelDelimiter),\r\n        legendG = svg.selectAll('g').data([scale]);\r\n\r\n      legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\r\n\r\n      var cell = legendG.selectAll(\".\" + classPrefix + \"cell\").data(type.data),\r\n        cellEnter = cell.enter().append(\"g\", \".cell\").attr(\"class\", classPrefix + \"cell\").style(\"opacity\", 1e-6);\r\n        shapeEnter = cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\"),\r\n        shapes = cell.select(\"g.\" + classPrefix + \"cell \" + shape);\r\n\r\n      //add event handlers\r\n      helper.d3_addEvents(cellEnter, legendDispatcher);\r\n\r\n      //remove old shapes\r\n      cell.exit().transition().style(\"opacity\", 0).remove();\r\n\r\n      helper.d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, type.feature);\r\n      helper.d3_addText(legendG, cellEnter, type.labels, classPrefix)\r\n\r\n      // sets placement\r\n      var text = cell.select(\"text\"),\r\n        shapeSize = shapes[0].map( function(d){ return d.getBBox(); });\r\n\r\n      var maxH = d3.max(shapeSize, function(d){ return d.height; }),\r\n      maxW = d3.max(shapeSize, function(d){ return d.width; });\r\n\r\n      var cellTrans,\r\n      textTrans,\r\n      textAlign = (labelAlign == \"start\") ? 0 : (labelAlign == \"middle\") ? 0.5 : 1;\r\n\r\n      //positions cells and text\r\n      if (orient === \"vertical\"){\r\n        cellTrans = function(d,i) { return \"translate(0, \" + (i * (maxH + shapePadding)) + \")\"; };\r\n        textTrans = function(d,i) { return \"translate(\" + (maxW + labelOffset) + \",\" +\r\n              (shapeSize[i].y + shapeSize[i].height/2 + 5) + \")\"; };\r\n\r\n      } else if (orient === \"horizontal\"){\r\n        cellTrans = function(d,i) { return \"translate(\" + (i * (maxW + shapePadding)) + \",0)\"; };\r\n        textTrans = function(d,i) { return \"translate(\" + (shapeSize[i].width*textAlign  + shapeSize[i].x) + \",\" +\r\n              (maxH + labelOffset ) + \")\"; };\r\n      }\r\n\r\n      helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\r\n      helper.d3_title(svg, legendG, title, classPrefix);\r\n      cell.transition().style(\"opacity\", 1);\r\n\r\n    }\r\n\r\n\r\n  legend.scale = function(_) {\r\n    if (!arguments.length) return scale;\r\n    scale = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.cells = function(_) {\r\n    if (!arguments.length) return cells;\r\n    if (_.length > 1 || _ >= 2 ){\r\n      cells = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.shapePadding = function(_) {\r\n    if (!arguments.length) return shapePadding;\r\n    shapePadding = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labels = function(_) {\r\n    if (!arguments.length) return labels;\r\n    labels = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelAlign = function(_) {\r\n    if (!arguments.length) return labelAlign;\r\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\r\n      labelAlign = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.labelFormat = function(_) {\r\n    if (!arguments.length) return labelFormat;\r\n    labelFormat = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelOffset = function(_) {\r\n    if (!arguments.length) return labelOffset;\r\n    labelOffset = +_;\r\n    return legend;\r\n  };\r\n\r\n  legend.labelDelimiter = function(_) {\r\n    if (!arguments.length) return labelDelimiter;\r\n    labelDelimiter = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.orient = function(_){\r\n    if (!arguments.length) return orient;\r\n    _ = _.toLowerCase();\r\n    if (_ == \"horizontal\" || _ == \"vertical\") {\r\n      orient = _;\r\n    }\r\n    return legend;\r\n  };\r\n\r\n  legend.ascending = function(_) {\r\n    if (!arguments.length) return ascending;\r\n    ascending = !!_;\r\n    return legend;\r\n  };\r\n\r\n  legend.classPrefix = function(_) {\r\n    if (!arguments.length) return classPrefix;\r\n    classPrefix = _;\r\n    return legend;\r\n  };\r\n\r\n  legend.title = function(_) {\r\n    if (!arguments.length) return title;\r\n    title = _;\r\n    return legend;\r\n  };\r\n\r\n  d3.rebind(legend, legendDispatcher, \"on\");\r\n\r\n  return legend;\r\n\r\n};\r\n","'use strict';\r\n/* @flow */\r\n\r\n/**\r\n * **[Gaussian error function](http://en.wikipedia.org/wiki/Error_function)**\r\n *\r\n * The `errorFunction(x/(sd * Math.sqrt(2)))` is the probability that a value in a\r\n * normal distribution with standard deviation sd is within x of the mean.\r\n *\r\n * This function returns a numerical approximation to the exact value.\r\n *\r\n * @param {number} x input\r\n * @return {number} error estimation\r\n * @example\r\n * errorFunction(1); //= 0.8427\r\n */\r\nfunction errorFunction(x/*: number */)/*: number */ {\r\n    var t = 1 / (1 + 0.5 * Math.abs(x));\r\n    var tau = t * Math.exp(-Math.pow(x, 2) -\r\n        1.26551223 +\r\n        1.00002368 * t +\r\n        0.37409196 * Math.pow(t, 2) +\r\n        0.09678418 * Math.pow(t, 3) -\r\n        0.18628806 * Math.pow(t, 4) +\r\n        0.27886807 * Math.pow(t, 5) -\r\n        1.13520398 * Math.pow(t, 6) +\r\n        1.48851587 * Math.pow(t, 7) -\r\n        0.82215223 * Math.pow(t, 8) +\r\n        0.17087277 * Math.pow(t, 9));\r\n    if (x >= 0) {\r\n        return 1 - tau;\r\n    } else {\r\n        return tau - 1;\r\n    }\r\n}\r\n\r\nmodule.exports = errorFunction;\r\n","'use strict';\r\n/* @flow */\r\n\r\n/**\r\n * [Simple linear regression](http://en.wikipedia.org/wiki/Simple_linear_regression)\r\n * is a simple way to find a fitted line\r\n * between a set of coordinates. This algorithm finds the slope and y-intercept of a regression line\r\n * using the least sum of squares.\r\n *\r\n * @param {Array<Array<number>>} data an array of two-element of arrays,\r\n * like `[[0, 1], [2, 3]]`\r\n * @returns {Object} object containing slope and intersect of regression line\r\n * @example\r\n * linearRegression([[0, 0], [1, 1]]); // { m: 1, b: 0 }\r\n */\r\nfunction linearRegression(data/*: Array<Array<number>> */)/*: { m: number, b: number } */ {\r\n\r\n    var m, b;\r\n\r\n    // Store data length in a local variable to reduce\r\n    // repeated object property lookups\r\n    var dataLength = data.length;\r\n\r\n    //if there's only one point, arbitrarily choose a slope of 0\r\n    //and a y-intercept of whatever the y of the initial point is\r\n    if (dataLength === 1) {\r\n        m = 0;\r\n        b = data[0][1];\r\n    } else {\r\n        // Initialize our sums and scope the `m` and `b`\r\n        // variables that define the line.\r\n        var sumX = 0, sumY = 0,\r\n            sumXX = 0, sumXY = 0;\r\n\r\n        // Use local variables to grab point values\r\n        // with minimal object property lookups\r\n        var point, x, y;\r\n\r\n        // Gather the sum of all x values, the sum of all\r\n        // y values, and the sum of x^2 and (x*y) for each\r\n        // value.\r\n        //\r\n        // In math notation, these would be SS_x, SS_y, SS_xx, and SS_xy\r\n        for (var i = 0; i < dataLength; i++) {\r\n            point = data[i];\r\n            x = point[0];\r\n            y = point[1];\r\n\r\n            sumX += x;\r\n            sumY += y;\r\n\r\n            sumXX += x * x;\r\n            sumXY += x * y;\r\n        }\r\n\r\n        // `m` is the slope of the regression line\r\n        m = ((dataLength * sumXY) - (sumX * sumY)) /\r\n            ((dataLength * sumXX) - (sumX * sumX));\r\n\r\n        // `b` is the y-intercept of the line.\r\n        b = (sumY / dataLength) - ((m * sumX) / dataLength);\r\n    }\r\n\r\n    // Return both values as an object.\r\n    return {\r\n        m: m,\r\n        b: b\r\n    };\r\n}\r\n\r\n\r\nmodule.exports = linearRegression;\r\n","'use strict';\r\n/* @flow */\r\n\r\n/**\r\n * Given the output of `linearRegression`: an object\r\n * with `m` and `b` values indicating slope and intercept,\r\n * respectively, generate a line function that translates\r\n * x values into y values.\r\n *\r\n * @param {Object} mb object with `m` and `b` members, representing\r\n * slope and intersect of desired line\r\n * @returns {Function} method that computes y-value at any given\r\n * x-value on the line.\r\n * @example\r\n * var l = linearRegressionLine(linearRegression([[0, 0], [1, 1]]));\r\n * l(0) //= 0\r\n * l(2) //= 2\r\n */\r\nfunction linearRegressionLine(mb/*: { b: number, m: number }*/)/*: Function */ {\r\n    // Return a function that computes a `y` value for each\r\n    // x value it is given, based on the values of `b` and `a`\r\n    // that we just computed.\r\n    return function(x) {\r\n        return mb.b + (mb.m * x);\r\n    };\r\n}\r\n\r\nmodule.exports = linearRegressionLine;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar sum = require('./sum');\r\n\r\n/**\r\n * The mean, _also known as average_,\r\n * is the sum of all values over the number of values.\r\n * This is a [measure of central tendency](https://en.wikipedia.org/wiki/Central_tendency):\r\n * a method of finding a typical or central value of a set of numbers.\r\n *\r\n * This runs on `O(n)`, linear time in respect to the array\r\n *\r\n * @param {Array<number>} x input values\r\n * @returns {number} mean\r\n * @example\r\n * console.log(mean([0, 10])); // 5\r\n */\r\nfunction mean(x /*: Array<number> */)/*:number*/ {\r\n    // The mean of no numbers is null\r\n    if (x.length === 0) { return NaN; }\r\n\r\n    return sum(x) / x.length;\r\n}\r\n\r\nmodule.exports = mean;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar sampleCovariance = require('./sample_covariance');\r\nvar sampleStandardDeviation = require('./sample_standard_deviation');\r\n\r\n/**\r\n * The [correlation](http://en.wikipedia.org/wiki/Correlation_and_dependence) is\r\n * a measure of how correlated two datasets are, between -1 and 1\r\n *\r\n * @param {Array<number>} x first input\r\n * @param {Array<number>} y second input\r\n * @returns {number} sample correlation\r\n * @example\r\n * var a = [1, 2, 3, 4, 5, 6];\r\n * var b = [2, 2, 3, 4, 5, 60];\r\n * sampleCorrelation(a, b); //= 0.691\r\n */\r\nfunction sampleCorrelation(x/*: Array<number> */, y/*: Array<number> */)/*:number*/ {\r\n    var cov = sampleCovariance(x, y),\r\n        xstd = sampleStandardDeviation(x),\r\n        ystd = sampleStandardDeviation(y);\r\n\r\n    return cov / xstd / ystd;\r\n}\r\n\r\nmodule.exports = sampleCorrelation;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar mean = require('./mean');\r\n\r\n/**\r\n * [Sample covariance](https://en.wikipedia.org/wiki/Sample_mean_and_sampleCovariance) of two datasets:\r\n * how much do the two datasets move together?\r\n * x and y are two datasets, represented as arrays of numbers.\r\n *\r\n * @param {Array<number>} x first input\r\n * @param {Array<number>} y second input\r\n * @returns {number} sample covariance\r\n * @example\r\n * var x = [1, 2, 3, 4, 5, 6];\r\n * var y = [6, 5, 4, 3, 2, 1];\r\n * sampleCovariance(x, y); //= -3.5\r\n */\r\nfunction sampleCovariance(x /*:Array<number>*/, y /*:Array<number>*/)/*:number*/ {\r\n\r\n    // The two datasets must have the same length which must be more than 1\r\n    if (x.length <= 1 || x.length !== y.length) {\r\n        return NaN;\r\n    }\r\n\r\n    // determine the mean of each dataset so that we can judge each\r\n    // value of the dataset fairly as the difference from the mean. this\r\n    // way, if one dataset is [1, 2, 3] and [2, 3, 4], their covariance\r\n    // does not suffer because of the difference in absolute values\r\n    var xmean = mean(x),\r\n        ymean = mean(y),\r\n        sum = 0;\r\n\r\n    // for each pair of values, the covariance increases when their\r\n    // difference from the mean is associated - if both are well above\r\n    // or if both are well below\r\n    // the mean, the covariance increases significantly.\r\n    for (var i = 0; i < x.length; i++) {\r\n        sum += (x[i] - xmean) * (y[i] - ymean);\r\n    }\r\n\r\n    // this is Bessels' Correction: an adjustment made to sample statistics\r\n    // that allows for the reduced degree of freedom entailed in calculating\r\n    // values from samples rather than complete populations.\r\n    var besselsCorrection = x.length - 1;\r\n\r\n    // the covariance is weighted by the length of the datasets.\r\n    return sum / besselsCorrection;\r\n}\r\n\r\nmodule.exports = sampleCovariance;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar sampleVariance = require('./sample_variance');\r\n\r\n/**\r\n * The [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)\r\n * is the square root of the variance.\r\n *\r\n * @param {Array<number>} x input array\r\n * @returns {number} sample standard deviation\r\n * @example\r\n * ss.sampleStandardDeviation([2, 4, 4, 4, 5, 5, 7, 9]);\r\n * //= 2.138\r\n */\r\nfunction sampleStandardDeviation(x/*:Array<number>*/)/*:number*/ {\r\n    // The standard deviation of no numbers is null\r\n    var sampleVarianceX = sampleVariance(x);\r\n    if (isNaN(sampleVarianceX)) { return NaN; }\r\n    return Math.sqrt(sampleVarianceX);\r\n}\r\n\r\nmodule.exports = sampleStandardDeviation;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar sumNthPowerDeviations = require('./sum_nth_power_deviations');\r\n\r\n/*\r\n * The [sample variance](https://en.wikipedia.org/wiki/Variance#Sample_variance)\r\n * is the sum of squared deviations from the mean. The sample variance\r\n * is distinguished from the variance by the usage of [Bessel's Correction](https://en.wikipedia.org/wiki/Bessel's_correction):\r\n * instead of dividing the sum of squared deviations by the length of the input,\r\n * it is divided by the length minus one. This corrects the bias in estimating\r\n * a value from a set that you don't know if full.\r\n *\r\n * References:\r\n * * [Wolfram MathWorld on Sample Variance](http://mathworld.wolfram.com/SampleVariance.html)\r\n *\r\n * @param {Array<number>} x input array\r\n * @return {number} sample variance\r\n * @example\r\n * sampleVariance([1, 2, 3, 4, 5]); //= 2.5\r\n */\r\nfunction sampleVariance(x /*: Array<number> */)/*:number*/ {\r\n    // The variance of no numbers is null\r\n    if (x.length <= 1) { return NaN; }\r\n\r\n    var sumSquaredDeviationsValue = sumNthPowerDeviations(x, 2);\r\n\r\n    // this is Bessels' Correction: an adjustment made to sample statistics\r\n    // that allows for the reduced degree of freedom entailed in calculating\r\n    // values from samples rather than complete populations.\r\n    var besselsCorrection = x.length - 1;\r\n\r\n    // Find the mean value of that list\r\n    return sumSquaredDeviationsValue / besselsCorrection;\r\n}\r\n\r\nmodule.exports = sampleVariance;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar variance = require('./variance');\r\n\r\n/**\r\n * The [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)\r\n * is the square root of the variance. It's useful for measuring the amount\r\n * of variation or dispersion in a set of values.\r\n *\r\n * Standard deviation is only appropriate for full-population knowledge: for\r\n * samples of a population, {@link sampleStandardDeviation} is\r\n * more appropriate.\r\n *\r\n * @param {Array<number>} x input\r\n * @returns {number} standard deviation\r\n * @example\r\n * var scores = [2, 4, 4, 4, 5, 5, 7, 9];\r\n * variance(scores); //= 4\r\n * standardDeviation(scores); //= 2\r\n */\r\nfunction standardDeviation(x /*: Array<number> */)/*:number*/ {\r\n    // The standard deviation of no numbers is null\r\n    var v = variance(x);\r\n    if (isNaN(v)) { return 0; }\r\n    return Math.sqrt(v);\r\n}\r\n\r\nmodule.exports = standardDeviation;\r\n","'use strict';\r\n/* @flow */\r\n\r\n/**\r\n * Our default sum is the [Kahan summation algorithm](https://en.wikipedia.org/wiki/Kahan_summation_algorithm) is\r\n * a method for computing the sum of a list of numbers while correcting\r\n * for floating-point errors. Traditionally, sums are calculated as many\r\n * successive additions, each one with its own floating-point roundoff. These\r\n * losses in precision add up as the number of numbers increases. This alternative\r\n * algorithm is more accurate than the simple way of calculating sums by simple\r\n * addition.\r\n *\r\n * This runs on `O(n)`, linear time in respect to the array\r\n *\r\n * @param {Array<number>} x input\r\n * @return {number} sum of all input numbers\r\n * @example\r\n * console.log(sum([1, 2, 3])); // 6\r\n */\r\nfunction sum(x/*: Array<number> */)/*: number */ {\r\n\r\n    // like the traditional sum algorithm, we keep a running\r\n    // count of the current sum.\r\n    var sum = 0;\r\n\r\n    // but we also keep three extra variables as bookkeeping:\r\n    // most importantly, an error correction value. This will be a very\r\n    // small number that is the opposite of the floating point precision loss.\r\n    var errorCompensation = 0;\r\n\r\n    // this will be each number in the list corrected with the compensation value.\r\n    var correctedCurrentValue;\r\n\r\n    // and this will be the next sum\r\n    var nextSum;\r\n\r\n    for (var i = 0; i < x.length; i++) {\r\n        // first correct the value that we're going to add to the sum\r\n        correctedCurrentValue = x[i] - errorCompensation;\r\n\r\n        // compute the next sum. sum is likely a much larger number\r\n        // than correctedCurrentValue, so we'll lose precision here,\r\n        // and measure how much precision is lost in the next step\r\n        nextSum = sum + correctedCurrentValue;\r\n\r\n        // we intentionally didn't assign sum immediately, but stored\r\n        // it for now so we can figure out this: is (sum + nextValue) - nextValue\r\n        // not equal to 0? ideally it would be, but in practice it won't:\r\n        // it will be some very small number. that's what we record\r\n        // as errorCompensation.\r\n        errorCompensation = nextSum - sum - correctedCurrentValue;\r\n\r\n        // now that we've computed how much we'll correct for in the next\r\n        // loop, start treating the nextSum as the current sum.\r\n        sum = nextSum;\r\n    }\r\n\r\n    return sum;\r\n}\r\n\r\nmodule.exports = sum;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar mean = require('./mean');\r\n\r\n/**\r\n * The sum of deviations to the Nth power.\r\n * When n=2 it's the sum of squared deviations.\r\n * When n=3 it's the sum of cubed deviations.\r\n *\r\n * @param {Array<number>} x\r\n * @param {number} n power\r\n * @returns {number} sum of nth power deviations\r\n * @example\r\n * var input = [1, 2, 3];\r\n * // since the variance of a set is the mean squared\r\n * // deviations, we can calculate that with sumNthPowerDeviations:\r\n * var variance = sumNthPowerDeviations(input) / input.length;\r\n */\r\nfunction sumNthPowerDeviations(x/*: Array<number> */, n/*: number */)/*:number*/ {\r\n    var meanValue = mean(x),\r\n        sum = 0;\r\n\r\n    for (var i = 0; i < x.length; i++) {\r\n        sum += Math.pow(x[i] - meanValue, n);\r\n    }\r\n\r\n    return sum;\r\n}\r\n\r\nmodule.exports = sumNthPowerDeviations;\r\n","'use strict';\r\n/* @flow */\r\n\r\nvar sumNthPowerDeviations = require('./sum_nth_power_deviations');\r\n\r\n/**\r\n * The [variance](http://en.wikipedia.org/wiki/Variance)\r\n * is the sum of squared deviations from the mean.\r\n *\r\n * This is an implementation of variance, not sample variance:\r\n * see the `sampleVariance` method if you want a sample measure.\r\n *\r\n * @param {Array<number>} x a population\r\n * @returns {number} variance: a value greater than or equal to zero.\r\n * zero indicates that all values are identical.\r\n * @example\r\n * ss.variance([1, 2, 3, 4, 5, 6]); //= 2.917\r\n */\r\nfunction variance(x/*: Array<number> */)/*:number*/ {\r\n    // The variance of no numbers is null\r\n    if (x.length === 0) { return NaN; }\r\n\r\n    // Find the mean of squared deviations between the\r\n    // mean value and each value.\r\n    return sumNthPowerDeviations(x, 2) / x.length;\r\n}\r\n\r\nmodule.exports = variance;\r\n","'use strict';\r\n/* @flow */\r\n\r\n/**\r\n * The [Z-Score, or Standard Score](http://en.wikipedia.org/wiki/Standard_score).\r\n *\r\n * The standard score is the number of standard deviations an observation\r\n * or datum is above or below the mean. Thus, a positive standard score\r\n * represents a datum above the mean, while a negative standard score\r\n * represents a datum below the mean. It is a dimensionless quantity\r\n * obtained by subtracting the population mean from an individual raw\r\n * score and then dividing the difference by the population standard\r\n * deviation.\r\n *\r\n * The z-score is only defined if one knows the population parameters;\r\n * if one only has a sample set, then the analogous computation with\r\n * sample mean and sample standard deviation yields the\r\n * Student's t-statistic.\r\n *\r\n * @param {number} x\r\n * @param {number} mean\r\n * @param {number} standardDeviation\r\n * @return {number} z score\r\n * @example\r\n * ss.zScore(78, 80, 5); //= -0.4\r\n */\r\nfunction zScore(x/*:number*/, mean/*:number*/, standardDeviation/*:number*/)/*:number*/ {\r\n    return (x - mean) / standardDeviation;\r\n}\r\n\r\nmodule.exports = zScore;\r\n","import {Utils} from './utils'\r\n\r\n\r\nexport class ChartConfig {\r\n    cssClassPrefix = \"odc-\";\r\n    svgClass = this.cssClassPrefix + 'mw-d3-chart';\r\n    width = undefined;\r\n    height = undefined;\r\n    margin = {\r\n        left: 50,\r\n        right: 30,\r\n        top: 30,\r\n        bottom: 50\r\n    };\r\n    tooltip = false;\r\n\r\n    constructor(custom) {\r\n        if (custom) {\r\n            Utils.deepExtend(this, custom);\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\nexport class Chart {\r\n    utils = Utils;\r\n    baseContainer;\r\n    svg;\r\n    config;\r\n    plot = {\r\n        margin: {}\r\n    };\r\n    _attached = {};\r\n    _layers = {};\r\n    _events = {};\r\n    _isAttached;\r\n    _isInitialized=false;\r\n\r\n\r\n    constructor(base, data, config) {\r\n        \r\n        this._isAttached = base instanceof Chart;\r\n\r\n        this.baseContainer = base;\r\n\r\n        this.setConfig(config);\r\n\r\n        if (data) {\r\n            this.setData(data);\r\n        }\r\n\r\n        this.init();\r\n        this.postInit();\r\n    }\r\n\r\n    setConfig(config) {\r\n        if (!config) {\r\n            this.config = new ChartConfig();\r\n        } else {\r\n            this.config = config;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setData(data) {\r\n        this.data = data;\r\n        return this;\r\n    }\r\n\r\n    init() {\r\n        var self = this;\r\n\r\n\r\n        self.initPlot();\r\n        self.initSvg();\r\n\r\n        self.initTooltip();\r\n        self.draw();\r\n        this._isInitialized=true;\r\n        return this;\r\n    }\r\n\r\n    postInit(){\r\n\r\n    }\r\n\r\n    initSvg() {\r\n        var self = this;\r\n        var config = this.config;\r\n        console.log(config.svgClass);\r\n\r\n        var margin = self.plot.margin;\r\n        var width = self.plot.width + margin.left + margin.right;\r\n        var height = self.plot.height + margin.top + margin.bottom;\r\n        var aspect = width / height;\r\n        if(!self._isAttached){\r\n            if(!this._isInitialized){\r\n                d3.select(self.baseContainer).select(\"svg\").remove();\r\n            }\r\n            self.svg = d3.select(self.baseContainer).selectOrAppend(\"svg\");\r\n\r\n            self.svg\r\n                .attr(\"width\", width)\r\n                .attr(\"height\", height)\r\n                .attr(\"viewBox\", \"0 0 \" + \" \" + width + \" \" + height)\r\n                .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\r\n                .attr(\"class\", config.svgClass);\r\n            self.svgG = self.svg.selectOrAppend(\"g.main-group\");\r\n        }else{\r\n            console.log(self.baseContainer);\r\n            self.svg = self.baseContainer.svg;\r\n            self.svgG = self.svg.selectOrAppend(\"g.main-group.\"+config.svgClass)\r\n        }\r\n\r\n        self.svgG.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\r\n\r\n        if (!config.width || config.height) {\r\n            d3.select(window)\r\n                .on(\"resize\", function () {\r\n                    //TODO add responsiveness if width/height not specified\r\n                });\r\n        }\r\n    }\r\n\r\n    initTooltip(){\r\n        var self = this;\r\n        if (self.config.tooltip) {\r\n            if(!self._isAttached ){\r\n                self.plot.tooltip = d3.select(self.baseContainer).selectOrAppend('div.'+self.config.cssClassPrefix+'tooltip')\r\n                    .style(\"opacity\", 0);\r\n            }else{\r\n                self.plot.tooltip= self.baseContainer.plot.tooltip;\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    initPlot() {\r\n        var margin = this.config.margin;\r\n        this.plot={\r\n            margin:{\r\n                top: margin.top,\r\n                bottom: margin.bottom,\r\n                left: margin.left,\r\n                right: margin.right\r\n            }\r\n        };\r\n    }\r\n\r\n    update(data) {\r\n        if (data) {\r\n            this.setData(data);\r\n        }\r\n        var layerName, attachmentData;\r\n        for (var attachmentName in this._attached) {\r\n\r\n            attachmentData = data;\r\n\r\n            this._attached[attachmentName].update(attachmentData);\r\n        }\r\n        console.log('base uppdate');\r\n        return this;\r\n    }\r\n\r\n    draw(data) {\r\n        this.update(data);\r\n\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    //Borrowed from d3.chart\r\n    /**\r\n     * Register or retrieve an \"attachment\" Chart. The \"attachment\" chart's `draw`\r\n     * method will be invoked whenever the containing chart's `draw` method is\r\n     * invoked.\r\n     *\r\n     * @externalExample chart-attach\r\n     *\r\n     * @param {String} attachmentName Name of the attachment\r\n     * @param {Chart} [chart] Chart to register as a mix in of this chart. When\r\n     *        unspecified, this method will return the attachment previously\r\n     *        registered with the specified `attachmentName` (if any).\r\n     *\r\n     * @returns {Chart} Reference to this chart (chainable).\r\n     */\r\n    attach(attachmentName, chart) {\r\n        if (arguments.length === 1) {\r\n            return this._attached[attachmentName];\r\n        }\r\n\r\n        this._attached[attachmentName] = chart;\r\n        return chart;\r\n    };\r\n\r\n    \r\n\r\n    //Borrowed from d3.chart\r\n    /**\r\n     * Subscribe a callback function to an event triggered on the chart. See {@link\r\n        * Chart#once} to subscribe a callback function to an event for one occurence.\r\n     *\r\n     * @externalExample {runnable} chart-on\r\n     *\r\n     * @param {String} name Name of the event\r\n     * @param {ChartEventHandler} callback Function to be invoked when the event\r\n     *        occurs\r\n     * @param {Object} [context] Value to set as `this` when invoking the\r\n     *        `callback`. Defaults to the chart instance.\r\n     *\r\n     * @returns {Chart} A reference to this chart (chainable).\r\n     */\r\n    on(name, callback, context) {\r\n        var events = this._events[name] || (this._events[name] = []);\r\n        events.push({\r\n            callback: callback,\r\n            context: context || this,\r\n            _chart: this\r\n        });\r\n        return this;\r\n    }\r\n\r\n    //Borrowed from d3.chart\r\n    /**\r\n     *\r\n     * Subscribe a callback function to an event triggered on the chart. This\r\n     * function will be invoked at the next occurance of the event and immediately\r\n     * unsubscribed. See {@link Chart#on} to subscribe a callback function to an\r\n     * event indefinitely.\r\n     *\r\n     * @externalExample {runnable} chart-once\r\n     *\r\n     * @param {String} name Name of the event\r\n     * @param {ChartEventHandler} callback Function to be invoked when the event\r\n     *        occurs\r\n     * @param {Object} [context] Value to set as `this` when invoking the\r\n     *        `callback`. Defaults to the chart instance\r\n     *\r\n     * @returns {Chart} A reference to this chart (chainable)\r\n     */\r\n    once(name, callback, context) {\r\n        var self = this;\r\n        var once = function () {\r\n            self.off(name, once);\r\n            callback.apply(this, arguments);\r\n        };\r\n        return this.on(name, once, context);\r\n    }\r\n\r\n\r\n    //Borrowed from d3.chart\r\n    /**\r\n     * Unsubscribe one or more callback functions from an event triggered on the\r\n     * chart. When no arguments are specified, *all* handlers will be unsubscribed.\r\n     * When only a `name` is specified, all handlers subscribed to that event will\r\n     * be unsubscribed. When a `name` and `callback` are specified, only that\r\n     * function will be unsubscribed from that event. When a `name` and `context`\r\n     * are specified (but `callback` is omitted), all events bound to the given\r\n     * event with the given context will be unsubscribed.\r\n     *\r\n     * @externalExample {runnable} chart-off\r\n     *\r\n     * @param {String} [name] Name of the event to be unsubscribed\r\n     * @param {ChartEventHandler} [callback] Function to be unsubscribed\r\n     * @param {Object} [context] Contexts to be unsubscribe\r\n     *\r\n     * @returns {Chart} A reference to this chart (chainable).\r\n     */\r\n\r\n    off(name, callback, context) {\r\n        var names, n, events, event, i, j;\r\n\r\n        // remove all events\r\n        if (arguments.length === 0) {\r\n            for (name in this._events) {\r\n                this._events[name].length = 0;\r\n            }\r\n            return this;\r\n        }\r\n\r\n        // remove all events for a specific name\r\n        if (arguments.length === 1) {\r\n            events = this._events[name];\r\n            if (events) {\r\n                events.length = 0;\r\n            }\r\n            return this;\r\n        }\r\n\r\n        // remove all events that match whatever combination of name, context\r\n        // and callback.\r\n        names = name ? [name] : Object.keys(this._events);\r\n        for (i = 0; i < names.length; i++) {\r\n            n = names[i];\r\n            events = this._events[n];\r\n            j = events.length;\r\n            while (j--) {\r\n                event = events[j];\r\n                if ((callback && callback === event.callback) ||\r\n                    (context && context === event.context)) {\r\n                    events.splice(j, 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    };\r\n\r\n    //Borrowed from d3.chart\r\n    /**\r\n     * Publish an event on this chart with the given `name`.\r\n     *\r\n     * @externalExample {runnable} chart-trigger\r\n     *\r\n     * @param {String} name Name of the event to publish\r\n     * @param {...*} arguments Values with which to invoke the registered\r\n     *        callbacks.\r\n     *\r\n     * @returns {Chart} A reference to this chart (chainable).\r\n     */\r\n    trigger(name) {\r\n        var args = Array.prototype.slice.call(arguments, 1);\r\n        var events = this._events[name];\r\n        var i, ev;\r\n\r\n        if (events !== undefined) {\r\n            for (i = 0; i < events.length; i++) {\r\n                ev = events[i];\r\n                ev.callback.apply(ev.context, args);\r\n            }\r\n        }\r\n\r\n        return this;\r\n    };\r\n    getBaseContainer(){\r\n        if(this._isAttached){\r\n            return this.baseContainer.svg;\r\n        }\r\n        return d3.select(this.baseContainer);\r\n    }\r\n\r\n    getBaseContainerNode(){\r\n\r\n        return this.getBaseContainer().node();\r\n    }\r\n\r\n    prefixClass(clazz, addDot){\r\n        return addDot? '.': ''+this.config.cssClassPrefix+clazz;\r\n    }\r\n    computePlotSize() {\r\n        this.plot.width = Utils.availableWidth(this.config.width, this.getBaseContainer(), this.plot.margin);\r\n        this.plot.height = Utils.availableHeight(this.config.height, this.getBaseContainer(), this.plot.margin);\r\n    }\r\n}\r\n","import {Chart, ChartConfig} from \"./chart\";\r\nimport {Utils} from './utils'\r\nimport {StatisticsUtils} from './statistics-utils'\r\nimport {Legend} from './legend'\r\nimport {ScatterPlot} from './scatterplot'\r\n\r\nexport class CorrelationMatrixConfig extends ChartConfig {\r\n\r\n    svgClass = 'odc-correlation-matrix';\r\n    guides = false; //show axis guides\r\n    tooltip = true; //show tooltip on dot hover\r\n    legend = true;\r\n    highlightLabels = true;\r\n    variables = {\r\n        labels: undefined,\r\n        keys: [], //optional array of variable keys\r\n        value: (d, variableKey) => d[variableKey], // variable value accessor\r\n        scale: \"ordinal\"\r\n    };\r\n    correlation = {\r\n        scale: \"linear\",\r\n        domain: [-1, -0.75, -0.5, 0, 0.5, 0.75, 1],\r\n        range: [\"darkblue\", \"blue\", \"lightskyblue\", \"white\", \"orangered\", \"crimson\", \"darkred\"],\r\n        value: (xValues, yValues) => StatisticsUtils.sampleCorrelation(xValues, yValues)\r\n\r\n    };\r\n    cell = {\r\n        shape: \"ellipse\", //possible values: rect, circle, ellipse\r\n        size: undefined,\r\n        sizeMin: 5,\r\n        sizeMax: 250,\r\n        padding: 1\r\n    };\r\n    margin = {\r\n        left: 60,\r\n        right: 50,\r\n        top: 30,\r\n        bottom: 60\r\n    };\r\n\r\n    constructor(custom) {\r\n        super();\r\n        if (custom) {\r\n            Utils.deepExtend(this, custom);\r\n        }\r\n    }\r\n}\r\n\r\nexport class CorrelationMatrix extends Chart {\r\n    constructor(placeholderSelector, data, config) {\r\n        super(placeholderSelector, data, new CorrelationMatrixConfig(config));\r\n    }\r\n\r\n    setConfig(config) {\r\n        return super.setConfig(new CorrelationMatrixConfig(config));\r\n\r\n    }\r\n\r\n    initPlot() {\r\n        super.initPlot();\r\n        var self = this;\r\n        var margin = this.config.margin;\r\n        var conf = this.config;\r\n\r\n        this.plot.x={};\r\n        this.plot.correlation={\r\n            matrix: undefined,\r\n            cells: undefined,\r\n            color: {},\r\n            shape: {}\r\n        };\r\n\r\n\r\n\r\n\r\n\r\n        this.setupVariables();\r\n        var width = conf.width;\r\n        var placeholderNode = this.getBaseContainerNode();\r\n        this.plot.placeholderNode = placeholderNode;\r\n\r\n        var parentWidth = placeholderNode.getBoundingClientRect().width;\r\n        if (width) {\r\n\r\n            if (!this.plot.cellSize) {\r\n                this.plot.cellSize = Math.max(conf.cell.sizeMin, Math.min(conf.cell.sizeMax, (width - margin.left - margin.right) / this.plot.variables.length));\r\n            }\r\n\r\n        } else {\r\n            this.plot.cellSize = this.config.cell.size;\r\n\r\n            if (!this.plot.cellSize) {\r\n                this.plot.cellSize = Math.max(conf.cell.sizeMin, Math.min(conf.cell.sizeMax, (parentWidth- margin.left - margin.right) / this.plot.variables.length));\r\n            }\r\n\r\n            width = this.plot.cellSize * this.plot.variables.length + margin.left + margin.right;\r\n\r\n        }\r\n\r\n        var height = width;\r\n        if (!height) {\r\n            height = placeholderNode.getBoundingClientRect().height;\r\n        }\r\n\r\n        this.plot.width = width - margin.left - margin.right;\r\n        this.plot.height = this.plot.width;\r\n\r\n        this.setupVariablesScales();\r\n        this.setupCorrelationScales();\r\n        this.setupCorrelationMatrix();\r\n\r\n\r\n        return this;\r\n    }\r\n\r\n    setupVariablesScales() {\r\n\r\n        var plot = this.plot;\r\n        var x = plot.x;\r\n        var conf = this.config.variables;\r\n\r\n        /* *\r\n         * value accessor - returns the value to encode for a given data object.\r\n         * scale - maps value to a visual display encoding, such as a pixel position.\r\n         * map function - maps from data value to display value\r\n         * axis - sets up axis\r\n         **/\r\n        x.value = conf.value;\r\n        x.scale = d3.scale[conf.scale]().rangeBands([plot.width, 0]);\r\n        x.map = d => x.scale(x.value(d));\r\n\r\n    };\r\n\r\n    setupCorrelationScales() {\r\n        var plot = this.plot;\r\n        var corrConf = this.config.correlation;\r\n\r\n        plot.correlation.color.scale = d3.scale[corrConf.scale]().domain(corrConf.domain).range(corrConf.range);\r\n        var shape = plot.correlation.shape = {};\r\n\r\n        var cellConf = this.config.cell;\r\n        shape.type = cellConf.shape;\r\n\r\n        var shapeSize = plot.cellSize - cellConf.padding * 2;\r\n        if (shape.type == 'circle') {\r\n            var radiusMax = shapeSize / 2;\r\n            shape.radiusScale = d3.scale.linear().domain([0, 1]).range([2, radiusMax]);\r\n            shape.radius = c=> shape.radiusScale(Math.abs(c.value));\r\n        } else if (shape.type == 'ellipse') {\r\n            var radiusMax = shapeSize / 2;\r\n            shape.radiusScale = d3.scale.linear().domain([0, 1]).range([radiusMax, 2]);\r\n            shape.radiusX = c=> shape.radiusScale(Math.abs(c.value));\r\n            shape.radiusY = radiusMax;\r\n\r\n            shape.rotateVal = v => {\r\n                if (v == 0) return \"0\";\r\n                if (v < 0) return \"-45\";\r\n                return \"45\"\r\n            }\r\n        } else if (shape.type == 'rect') {\r\n            shape.size = shapeSize;\r\n        }\r\n\r\n    }\r\n\r\n\r\n    setupVariables() {\r\n\r\n        var variablesConf = this.config.variables;\r\n\r\n        var data = this.data;\r\n        var plot = this.plot;\r\n        plot.domainByVariable = {};\r\n        plot.variables = variablesConf.keys;\r\n        if (!plot.variables || !plot.variables.length) {\r\n            plot.variables = Utils.inferVariables(data, this.config.groups.key, this.config.includeInPlot);\r\n        }\r\n\r\n        plot.labels = [];\r\n        plot.labelByVariable = {};\r\n        plot.variables.forEach((variableKey, index) => {\r\n            plot.domainByVariable[variableKey] = d3.extent(data, function (d) {\r\n                return variablesConf.value(d, variableKey)\r\n            });\r\n            var label = variableKey;\r\n            if (variablesConf.labels && variablesConf.labels.length > index) {\r\n\r\n                label = variablesConf.labels[index];\r\n            }\r\n            plot.labels.push(label);\r\n            plot.labelByVariable[variableKey] = label;\r\n        });\r\n\r\n        console.log(plot.labelByVariable);\r\n\r\n    };\r\n\r\n\r\n    setupCorrelationMatrix() {\r\n        var self = this;\r\n        var data = this.data;\r\n        var matrix = this.plot.correlation.matrix = [];\r\n        var matrixCells = this.plot.correlation.matrix.cells = [];\r\n        var plot = this.plot;\r\n\r\n        var variableToValues = {};\r\n        plot.variables.forEach((v, i) => {\r\n\r\n            variableToValues[v] = data.map(d=>plot.x.value(d, v));\r\n        });\r\n\r\n        plot.variables.forEach((v1, i) => {\r\n            var row = [];\r\n            matrix.push(row);\r\n\r\n            plot.variables.forEach((v2, j) => {\r\n                var corr = 1;\r\n                if (v1 != v2) {\r\n                    corr = self.config.correlation.value(variableToValues[v1], variableToValues[v2]);\r\n                }\r\n                var cell = {\r\n                    rowVar: v1,\r\n                    colVar: v2,\r\n                    row: i,\r\n                    col: j,\r\n                    value: corr\r\n                };\r\n                row.push(cell);\r\n\r\n                matrixCells.push(cell);\r\n            });\r\n\r\n        });\r\n    }\r\n\r\n\r\n    update(newData) {\r\n        super.update(newData);\r\n        // this.update\r\n        this.updateCells();\r\n        this.updateVariableLabels();\r\n\r\n        if (this.config.legend) {\r\n            this.updateLegend();\r\n        }\r\n    };\r\n\r\n    updateVariableLabels() {\r\n        var self = this;\r\n        var plot = self.plot;\r\n        var labelClass = self.prefixClass(\"label\");\r\n        var labelXClass = labelClass + \"-x\";\r\n        var labelYClass = labelClass + \"-y\";\r\n        plot.labelClass = labelClass;\r\n\r\n\r\n        var labelsX = self.svgG.selectAll(\"text.\"+labelXClass)\r\n            .data(plot.variables, (d, i)=>i);\r\n\r\n        labelsX.enter().append(\"text\").attr(\"class\", (d, i) => labelClass + \" \" +labelXClass+\" \"+ labelXClass + \"-\" + i);\r\n\r\n\r\n        labelsX\r\n            .attr(\"x\", (d, i) => i * plot.cellSize + plot.cellSize / 2)\r\n            .attr(\"y\", plot.height)\r\n            .attr(\"dx\", -2)\r\n            .attr(\"transform\", (d, i) => \"rotate(-90, \" + (i * plot.cellSize + plot.cellSize / 2  ) + \", \" + plot.height + \")\")\r\n            .attr(\"text-anchor\", \"end\")\r\n\r\n            // .attr(\"dominant-baseline\", \"hanging\")\r\n            .text(v=>plot.labelByVariable[v]);\r\n\r\n        labelsX.exit().remove();\r\n\r\n        //////\r\n\r\n        var labelsY = self.svgG.selectAll(\"text.\"+labelYClass)\r\n            .data(plot.variables);\r\n\r\n        labelsY.enter().append(\"text\");\r\n\r\n\r\n        labelsY\r\n            .attr(\"x\", 0)\r\n            .attr(\"y\", (d, i) => i * plot.cellSize + plot.cellSize / 2)\r\n            .attr(\"dx\", -2)\r\n            .attr(\"text-anchor\", \"end\")\r\n            .attr(\"class\", (d, i) => labelClass + \" \" + labelYClass +\" \" + labelYClass + \"-\" + i)\r\n            // .attr(\"dominant-baseline\", \"hanging\")\r\n            .text(v=>plot.labelByVariable[v]);\r\n\r\n        labelsY.exit().remove();\r\n\r\n\r\n    }\r\n\r\n    updateCells() {\r\n\r\n        var self = this;\r\n        var plot = self.plot;\r\n        var cellClass = self.prefixClass(\"cell\");\r\n        var cellShape = plot.correlation.shape.type;\r\n\r\n        var cells = self.svgG.selectAll(\"g.\"+cellClass)\r\n            .data(plot.correlation.matrix.cells);\r\n\r\n        var cellEnterG = cells.enter().append(\"g\")\r\n            .classed(cellClass, true);\r\n        cells.attr(\"transform\", c=> \"translate(\" + (plot.cellSize * c.col + plot.cellSize / 2) + \",\" + (plot.cellSize * c.row + plot.cellSize / 2) + \")\");\r\n\r\n        cells.classed(self.config.cssClassPrefix + \"selectable\", !!self.scatterPlot);\r\n\r\n        var selector = \"*:not(.cell-shape-\"+cellShape+\")\";\r\n       \r\n        var wrongShapes = cells.selectAll(selector);\r\n        wrongShapes.remove();\r\n        \r\n        var shapes = cells.selectOrAppend(cellShape+\".cell-shape-\"+cellShape);\r\n\r\n        if (plot.correlation.shape.type == 'circle') {\r\n\r\n            shapes\r\n                .attr(\"r\", plot.correlation.shape.radius)\r\n                .attr(\"cx\", 0)\r\n                .attr(\"cy\", 0);\r\n        }\r\n\r\n        if (plot.correlation.shape.type == 'ellipse') {\r\n            // cells.attr(\"transform\", c=> \"translate(300,150) rotate(\"+plot.correlation.shape.rotateVal(c.value)+\")\");\r\n            shapes\r\n                .attr(\"rx\", plot.correlation.shape.radiusX)\r\n                .attr(\"ry\", plot.correlation.shape.radiusY)\r\n                .attr(\"cx\", 0)\r\n                .attr(\"cy\", 0)\r\n\r\n                .attr(\"transform\", c=> \"rotate(\" + plot.correlation.shape.rotateVal(c.value) + \")\");\r\n        }\r\n\r\n\r\n        if (plot.correlation.shape.type == 'rect') {\r\n            shapes\r\n                .attr(\"width\", plot.correlation.shape.size)\r\n                .attr(\"height\", plot.correlation.shape.size)\r\n                .attr(\"x\", -plot.cellSize / 2)\r\n                .attr(\"y\", -plot.cellSize / 2);\r\n        }\r\n        shapes.style(\"fill\", c=> plot.correlation.color.scale(c.value));\r\n\r\n        var mouseoverCallbacks = [];\r\n        var mouseoutCallbacks = [];\r\n\r\n        if (plot.tooltip) {\r\n\r\n            mouseoverCallbacks.push(c=> {\r\n                plot.tooltip.transition()\r\n                    .duration(200)\r\n                    .style(\"opacity\", .9);\r\n                var html = c.value;\r\n                plot.tooltip.html(html)\r\n                    .style(\"left\", (d3.event.pageX + 5) + \"px\")\r\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\r\n            });\r\n\r\n            mouseoutCallbacks.push(c=> {\r\n                plot.tooltip.transition()\r\n                    .duration(500)\r\n                    .style(\"opacity\", 0);\r\n            });\r\n\r\n\r\n        }\r\n\r\n        if (self.config.highlightLabels) {\r\n            var highlightClass = self.config.cssClassPrefix + \"highlight\";\r\n            var xLabelClass = c=>plot.labelClass + \"-x-\" + c.col;\r\n            var yLabelClass = c=>plot.labelClass + \"-y-\" + c.row;\r\n\r\n\r\n            mouseoverCallbacks.push(c=> {\r\n\r\n                self.svgG.selectAll(\"text.\" + xLabelClass(c)).classed(highlightClass, true);\r\n                self.svgG.selectAll(\"text.\" + yLabelClass(c)).classed(highlightClass, true);\r\n            });\r\n            mouseoutCallbacks.push(c=> {\r\n                self.svgG.selectAll(\"text.\" + xLabelClass(c)).classed(highlightClass, false);\r\n                self.svgG.selectAll(\"text.\" + yLabelClass(c)).classed(highlightClass, false);\r\n            });\r\n        }\r\n\r\n\r\n        cells.on(\"mouseover\", c => {\r\n            mouseoverCallbacks.forEach(callback=>callback(c));\r\n        })\r\n            .on(\"mouseout\", c => {\r\n                mouseoutCallbacks.forEach(callback=>callback(c));\r\n            });\r\n\r\n        cells.on(\"click\", c=>{\r\n           self.trigger(\"cell-selected\", c);\r\n        });\r\n\r\n\r\n\r\n        cells.exit().remove();\r\n    }\r\n\r\n\r\n    updateLegend() {\r\n\r\n        var plot = this.plot;\r\n        var legendX = this.plot.width + 10;\r\n        var legendY = 0;\r\n        var barWidth = 10;\r\n        var barHeight = this.plot.height - 2;\r\n        var scale = plot.correlation.color.scale;\r\n\r\n        plot.legend = new Legend(this.svg, this.svgG, scale, legendX, legendY).linearGradientBar(barWidth, barHeight);\r\n\r\n\r\n    }\r\n\r\n    attachScatterPlot(containerSelector, config) {\r\n        var self = this;\r\n\r\n        config = config || {};\r\n\r\n\r\n        var scatterPlotConfig = {\r\n            height: self.plot.height+self.config.margin.top+ self.config.margin.bottom,\r\n            width: self.plot.height+self.config.margin.top+ self.config.margin.bottom,\r\n            groups:{\r\n                key: self.config.groups.key,\r\n                label: self.config.groups.label\r\n            },\r\n            guides: true,\r\n            showLegend: false\r\n        };\r\n\r\n        self.scatterPlot=true;\r\n\r\n        scatterPlotConfig = Utils.deepExtend(scatterPlotConfig, config);\r\n        this.update();\r\n\r\n        this.on(\"cell-selected\", c=>{\r\n\r\n\r\n\r\n            scatterPlotConfig.x={\r\n                key: c.rowVar,\r\n                label: self.plot.labelByVariable[c.rowVar]\r\n            };\r\n            scatterPlotConfig.y={\r\n                key: c.colVar,\r\n                label: self.plot.labelByVariable[c.colVar]\r\n            };\r\n            if(self.scatterPlot && self.scatterPlot !==true){\r\n                self.scatterPlot.setConfig(scatterPlotConfig).init();\r\n            }else{\r\n                self.scatterPlot = new ScatterPlot(containerSelector, self.data, scatterPlotConfig);\r\n                this.attach(\"ScatterPlot\", self.scatterPlot);\r\n            }\r\n\r\n\r\n        });\r\n\r\n\r\n    }\r\n}\r\n","import {Utils} from './utils'\r\n\r\n\r\nexport class D3Extensions{\r\n\r\n    static extend(){\r\n\r\n        d3.selection.enter.prototype.insertSelector =\r\n            d3.selection.prototype.insertSelector = function(selector, before) {\r\n                return Utils.insertSelector(this, selector, before);\r\n            };\r\n\r\n\r\n        d3.selection.enter.prototype.appendSelector =\r\n            d3.selection.prototype.appendSelector = function(selector) {\r\n                return Utils.appendSelector(this, selector);\r\n            };\r\n\r\n        d3.selection.enter.prototype.selectOrAppend =\r\n            d3.selection.prototype.selectOrAppend = function(selector) {\r\n                return Utils.selectOrAppend(this, selector);\r\n            };\r\n\r\n        d3.selection.enter.prototype.selectOrInsert =\r\n            d3.selection.prototype.selectOrInsert = function(selector, before) {\r\n                return Utils.selectOrInsert(this, selector, before);\r\n            };\r\n\r\n\r\n\r\n    }\r\n}\r\n","import {D3Extensions} from './d3-extensions'\r\nD3Extensions.extend();\r\n\r\nexport {ScatterPlot, ScatterPlotConfig} from \"./scatterplot\";\r\nexport {ScatterPlotMatrix, ScatterPlotMatrixConfig} from \"./scatterplot-matrix\";\r\nexport {CorrelationMatrix, CorrelationMatrixConfig} from './correlation-matrix'\r\nexport {Regression, RegressionConfig} from './regression'\r\nexport {StatisticsUtils} from './statistics-utils'\r\nexport {Legend} from './legend'\r\n\r\n\r\n\r\n\r\n\r\n","import {Utils} from \"./utils\";\r\nimport {color, size, symbol} from \"../bower_components/d3-legend/no-extend\";\r\n\r\n/*var d3 = require('../bower_components/d3');\r\n*/\r\n// var legend = require('../bower_components/d3-legend/no-extend');\r\n//\r\n// module.exports.legend = legend;\r\n\r\nexport class Legend {\r\n\r\n    cssClassPrefix=\"odc-\";\r\n    legendClass=this.cssClassPrefix+\"legend\";\r\n    container;\r\n    scale;\r\n    color= color;\r\n    size = size;\r\n    symbol= symbol;\r\n\r\n\r\n    constructor(svg, legendParent, scale, legendX, legendY){\r\n        this.scale=scale;\r\n        this.svg = svg;\r\n\r\n        this.container =  Utils.selectOrAppend(legendParent, \"g.\"+this.legendClass, \"g\")\r\n            .attr(\"transform\", \"translate(\"+legendX+\",\"+legendY+\")\")\r\n            .classed(this.legendClass, true);\r\n\r\n    }\r\n\r\n    linearGradientBar(barWidth, barHeight){\r\n        var gradientId = this.cssClassPrefix+\"linear-gradient\";\r\n        var scale= this.scale;\r\n\r\n        this.linearGradient = Utils.linearGradient(this.svg, gradientId, this.scale.range(), 0, 100, 0, 0);\r\n\r\n        this.container.append(\"rect\")\r\n            .attr(\"width\", barWidth)\r\n            .attr(\"height\", barHeight)\r\n            .attr(\"x\", 0)\r\n            .attr(\"y\", 0)\r\n            .style(\"fill\", \"url(#\"+gradientId+\")\");\r\n\r\n\r\n        var ticks = this.container.selectAll(\"text\")\r\n            .data( scale.domain() );\r\n        var ticksNumber =scale.domain().length-1;\r\n        ticks.enter().append(\"text\")\r\n            .attr(\"x\", barWidth)\r\n            .attr(\"y\",  (d, i) =>  barHeight -(i*barHeight/ticksNumber))\r\n            .attr(\"dx\", 3)\r\n            // .attr(\"dy\", 1)\r\n            .attr(\"alignment-baseline\", \"middle\")\r\n            .text(d=>d);\r\n\r\n        ticks.exit().remove();\r\n\r\n        return this;\r\n    }\r\n\r\n}","import {Chart, ChartConfig} from \"./chart\";\r\nimport {ScatterPlot, ScatterPlotConfig} from \"./scatterplot\";\r\nimport {Utils} from './utils'\r\nimport {StatisticsUtils} from './statistics-utils'\r\n\r\n\r\nexport class RegressionConfig extends ScatterPlotConfig{\r\n\r\n    mainRegression = true;\r\n    groupRegression = true;\r\n    confidence={\r\n        level: 0.95,\r\n        criticalValue: (degreesOfFreedom, criticalProbability) => StatisticsUtils.tValue(degreesOfFreedom, criticalProbability),\r\n        marginOfError: undefined //custom  margin Of Error function (x, points)\r\n    };\r\n\r\n    constructor(custom){\r\n        super();\r\n\r\n        if(custom){\r\n            Utils.deepExtend(this, custom);\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport class Regression extends ScatterPlot{\r\n    constructor(placeholderSelector, data, config) {\r\n        super(placeholderSelector, data, new RegressionConfig(config));\r\n    }\r\n\r\n    setConfig(config){\r\n        return super.setConfig(new RegressionConfig(config));\r\n    }\r\n\r\n    initPlot(){\r\n        super.initPlot();\r\n        this.initRegressionLines();\r\n    }\r\n\r\n    initRegressionLines(){\r\n\r\n        var self = this;\r\n        var groupsAvailable = self.config.groups && self.config.groups.value;\r\n\r\n        self.plot.regressions= [];\r\n\r\n\r\n        if(groupsAvailable && self.config.mainRegression){\r\n            var regression = this.initRegression(this.data, false);\r\n            self.plot.regressions.push(regression);\r\n        }\r\n\r\n        if(self.config.groupRegression){\r\n            this.initGroupRegression();\r\n        }\r\n\r\n    }\r\n\r\n    initGroupRegression() {\r\n        var self = this;\r\n        var dataByGroup = {};\r\n        self.data.forEach (d=>{\r\n            var groupVal = self.config.groups.value(d, self.config.groups.key);\r\n\r\n            if(!groupVal && groupVal!==0){\r\n                return;\r\n            }\r\n\r\n            if(!dataByGroup[groupVal]){\r\n                dataByGroup[groupVal] = [];\r\n            }\r\n            dataByGroup[groupVal].push(d);\r\n        });\r\n\r\n        for(var key in dataByGroup){\r\n            if (!dataByGroup.hasOwnProperty(key)) {\r\n                continue;\r\n            }\r\n\r\n            var regression = this.initRegression(dataByGroup[key], key);\r\n            self.plot.regressions.push(regression);\r\n        }\r\n    }\r\n\r\n    initRegression(values, groupVal){\r\n        var self = this;\r\n\r\n        var points = values.map(d=>{\r\n            return [parseFloat(self.plot.x.value(d)), parseFloat(self.plot.y.value(d))];\r\n        });\r\n\r\n        // points.sort((a,b) => a[0]-b[0]);\r\n\r\n        var linearRegression =  StatisticsUtils.linearRegression(points);\r\n        var linearRegressionLine = StatisticsUtils.linearRegressionLine(linearRegression);\r\n\r\n\r\n        var extentX = d3.extent(points, d=>d[0]);\r\n\r\n\r\n        var linePoints = [\r\n            {\r\n                x: extentX[0],\r\n                y: linearRegressionLine(extentX[0])\r\n            },\r\n            {\r\n                x: extentX[1],\r\n                y: linearRegressionLine(extentX[1])\r\n            }\r\n        ];\r\n\r\n        var line = d3.svg.line()\r\n            .interpolate(\"basis\")\r\n            .x(d => self.plot.x.scale(d.x))\r\n            .y(d => self.plot.y.scale(d.y));\r\n        \r\n\r\n        var color = self.plot.dot.color;\r\n\r\n        var defaultColor = \"black\";\r\n        if(Utils.isFunction(color)){\r\n            if(values.length && groupVal!==false){\r\n                color = color(values[0]);\r\n            }else{\r\n                color = defaultColor;\r\n            }\r\n        }else if(!color && groupVal===false){\r\n            color = defaultColor;\r\n        }\r\n\r\n\r\n        var confidence = this.computeConfidence(points, extentX,  linearRegression,linearRegressionLine);\r\n        return {\r\n            group: groupVal || false,\r\n            line: line,\r\n            linePoints: linePoints,\r\n            color: color,\r\n            confidence: confidence\r\n        };\r\n    }\r\n\r\n    computeConfidence(points, extentX, linearRegression,linearRegressionLine){\r\n        var self = this;\r\n        var slope = linearRegression.m;\r\n        var n = points.length;\r\n        var degreesOfFreedom = Math.max(0, n-2);\r\n\r\n        var alpha = 1 - self.config.confidence.level;\r\n        var criticalProbability  = 1 - alpha/2;\r\n        var criticalValue = self.config.confidence.criticalValue(degreesOfFreedom,criticalProbability);\r\n\r\n        var xValues = points.map(d=>d[0]);\r\n        var meanX = StatisticsUtils.mean(xValues);\r\n        var xMySum=0;\r\n        var xSum=0;\r\n        var xPowSum=0;\r\n        var ySum=0;\r\n        var yPowSum=0;\r\n        points.forEach(p=>{\r\n            var x = p[0];\r\n            var y = p[1];\r\n\r\n            xMySum += x*y;\r\n            xSum+=x;\r\n            ySum+=y;\r\n            xPowSum+= x*x;\r\n            yPowSum+= y*y;\r\n        });\r\n        var a = linearRegression.m;\r\n        var b = linearRegression.b;\r\n\r\n        var Sa2 = n/(n+2) * ((yPowSum-a*xMySum-b*ySum)/(n*xPowSum-(xSum*xSum))); //Wariancja wspczynnika kierunkowego regresji liniowej a\r\n        var Sy2 = (yPowSum - a*xMySum-b*ySum)/(n*(n-2)); //Sa2 //Mean y value variance\r\n\r\n        var errorFn = x=> Math.sqrt(Sy2 + Math.pow(x-meanX,2)*Sa2); //pierwiastek kwadratowy z wariancji dowolnego punktu prostej\r\n        var marginOfError =  x=> criticalValue* errorFn(x);\r\n\r\n\r\n        // console.log('n', n, 'degreesOfFreedom', degreesOfFreedom, 'criticalProbability',criticalProbability);\r\n        // var confidenceDown = x => linearRegressionLine(x) -  marginOfError(x);\r\n        // var confidenceUp = x => linearRegressionLine(x) +  marginOfError(x);\r\n\r\n\r\n        var computeConfidenceAreaPoint = x=>{\r\n            var linearRegression = linearRegressionLine(x);\r\n            var moe = marginOfError(x);\r\n            var confDown = linearRegression - moe;\r\n            var confUp = linearRegression + moe;\r\n            return {\r\n                x: x,\r\n                y0: confDown,\r\n                y1: confUp\r\n            }\r\n\r\n        };\r\n\r\n        var centerX = (extentX[1]+extentX[0])/2;\r\n\r\n        // var confidenceAreaPoints = [extentX[0], centerX,  extentX[1]].map(computeConfidenceAreaPoint);\r\n        var confidenceAreaPoints = [extentX[0], centerX,  extentX[1]].map(computeConfidenceAreaPoint);\r\n\r\n        var fitInPlot = y => y;\r\n\r\n        var confidenceArea =  d3.svg.area()\r\n        .interpolate(\"monotone\")\r\n            .x(d => self.plot.x.scale(d.x))\r\n            .y0(d => fitInPlot(self.plot.y.scale(d.y0)))\r\n            .y1(d => fitInPlot(self.plot.y.scale(d.y1)));\r\n\r\n        return {\r\n            area:confidenceArea,\r\n            points:confidenceAreaPoints\r\n        };\r\n    }\r\n\r\n    update(newData){\r\n        super.update(newData);\r\n        this.updateRegressionLines();\r\n\r\n    };\r\n\r\n    updateRegressionLines() {\r\n        var self = this;\r\n        var regressionContainerClass = this.prefixClass(\"regression-container\");\r\n        var regressionContainerSelector = \"g.\"+regressionContainerClass;\r\n\r\n        var clipPathId = self.prefixClass(\"clip\");\r\n\r\n        var regressionContainer = self.svgG.selectOrInsert(regressionContainerSelector, \".\"+self.dotsContainerClass);\r\n        var regressionContainerClip = regressionContainer.selectOrAppend(\"clipPath\")\r\n            .attr(\"id\", clipPathId);\r\n\r\n\r\n        regressionContainerClip.selectOrAppend('rect')\r\n            .attr('width', self.plot.width)\r\n            .attr('height', self.plot.height)\r\n            .attr('x', 0)\r\n            .attr('y', 0);\r\n\r\n        regressionContainer.attr(\"clip-path\", function(d,i) { return \"url(#\"+clipPathId+\")\"; });\r\n\r\n        var regressionClass = this.prefixClass(\"regression\");\r\n        var confidenceAreaClass = self.prefixClass(\"confidence\");\r\n        var regressionSelector = \"g.\"+regressionClass;\r\n        var regression = regressionContainer.selectAll(regressionSelector)\r\n            .data(self.plot.regressions);\r\n\r\n        var line = regression.enter()\r\n            .insertSelector(regressionSelector)\r\n            .append(\"path\")\r\n            .attr(\"class\", self.prefixClass(\"line\"))\r\n            .attr(\"shape-rendering\", \"optimizeQuality\");\r\n            // .append(\"line\")\r\n            // .attr(\"class\", \"line\")\r\n            // .attr(\"shape-rendering\", \"optimizeQuality\");\r\n\r\n        line\r\n            // .attr(\"x1\", r=> self.plot.x.scale(r.linePoints[0].x))\r\n            // .attr(\"y1\", r=> self.plot.y.scale(r.linePoints[0].y))\r\n            // .attr(\"x2\", r=> self.plot.x.scale(r.linePoints[1].x))\r\n            // .attr(\"y2\", r=> self.plot.y.scale(r.linePoints[1].y))\r\n            .attr(\"d\", function(r) { return r.line(r.linePoints); })\r\n            .style(\"stroke\", function(r) { return r.color; });\r\n\r\n\r\n        var area = regression.enter()\r\n            .appendSelector(regressionSelector)\r\n            .append(\"path\")\r\n            .attr(\"class\", confidenceAreaClass)\r\n            .attr(\"shape-rendering\", \"optimizeQuality\");\r\n\r\n\r\n        area\r\n            .attr(\"d\", r => r.confidence.area(r.confidence.points))\r\n            .style(\"fill\", r => r.color)\r\n            .style(\"opacity\", \"0.4\");\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n","import {Chart, ChartConfig} from \"./chart\";\r\nimport {ScatterPlotConfig} from \"./scatterplot\";\r\nimport {Utils} from './utils'\r\nimport {Legend} from \"./legend\";\r\n\r\nexport class ScatterPlotMatrixConfig extends ScatterPlotConfig{\r\n\r\n    svgClass= this.cssClassPrefix+'scatterplot-matrix';\r\n    size= 200; //scatter plot cell size\r\n    padding= 20; //scatter plot cell padding\r\n    brush= true;\r\n    guides= true; //show axis guides\r\n    tooltip= true; //show tooltip on dot hover\r\n    ticks= undefined; //ticks number, (default: computed using cell size)\r\n    x={// X axis config\r\n        orient: \"bottom\",\r\n        scale: \"linear\"\r\n    };\r\n    y={// Y axis config\r\n        orient: \"left\",\r\n        scale: \"linear\"\r\n    };\r\n    groups={\r\n        key: undefined, //object property name or array index with grouping variable\r\n        includeInPlot: false, //include group as variable in plot, boolean (default: false)\r\n        value: function(d, key) { return d[key] }, // grouping value accessor,\r\n        label: \"\"\r\n    };\r\n    variables= {\r\n        labels: [], //optional array of variable labels (for the diagonal of the plot).\r\n        keys: [], //optional array of variable keys\r\n        value: function (d, variableKey) {// variable value accessor\r\n            return d[variableKey];\r\n        }\r\n    };\r\n\r\n    constructor(custom){\r\n        super();\r\n        Utils.deepExtend(this, custom);\r\n    }\r\n\r\n\r\n}\r\n\r\nexport class ScatterPlotMatrix extends Chart {\r\n    constructor(placeholderSelector, data, config) {\r\n        super(placeholderSelector, data, new ScatterPlotMatrixConfig(config));\r\n    }\r\n\r\n    setConfig(config) {\r\n        return super.setConfig(new ScatterPlotMatrixConfig(config));\r\n\r\n    }\r\n\r\n    initPlot() {\r\n        super.initPlot();\r\n\r\n        var self = this;\r\n        var margin = this.plot.margin;\r\n        var conf = this.config;\r\n        this.plot.x={};\r\n        this.plot.y={};\r\n        this.plot.dot={\r\n            color: null//color scale mapping function\r\n        };\r\n\r\n\r\n        this.plot.showLegend = conf.showLegend;\r\n        if(this.plot.showLegend){\r\n            margin.right = conf.margin.right + conf.legend.width+conf.legend.margin*2;\r\n        }\r\n\r\n        this.setupVariables();\r\n\r\n        this.plot.size = conf.size;\r\n\r\n\r\n        var width = conf.width;\r\n        var boundingClientRect = this.getBaseContainerNode().getBoundingClientRect();\r\n        if (!width) {\r\n            var maxWidth = margin.left + margin.right + this.plot.variables.length*this.plot.size;\r\n            width = Math.min(boundingClientRect.width, maxWidth);\r\n\r\n        }\r\n        var height = width;\r\n        if (!height) {\r\n            height = boundingClientRect.height;\r\n        }\r\n\r\n        this.plot.width = width - margin.left - margin.right;\r\n        this.plot.height = height - margin.top - margin.bottom;\r\n\r\n\r\n\r\n\r\n        if(conf.ticks===undefined){\r\n            conf.ticks = this.plot.size / 40;\r\n        }\r\n\r\n        this.setupX();\r\n        this.setupY();\r\n\r\n        if (conf.dot.d3ColorCategory) {\r\n            this.plot.dot.colorCategory = d3.scale[conf.dot.d3ColorCategory]();\r\n        }\r\n        var colorValue = conf.dot.color;\r\n        if (colorValue) {\r\n            this.plot.dot.colorValue = colorValue;\r\n\r\n            if (typeof colorValue === 'string' || colorValue instanceof String) {\r\n                this.plot.dot.color = colorValue;\r\n            } else if (this.plot.dot.colorCategory) {\r\n                this.plot.dot.color = function (d) {\r\n                    return self.plot.dot.colorCategory(self.plot.dot.colorValue(d));\r\n                }\r\n            }\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n        return this;\r\n\r\n    };\r\n\r\n    setupVariables() {\r\n        var variablesConf = this.config.variables;\r\n\r\n        var data = this.data;\r\n        var plot = this.plot;\r\n        plot.domainByVariable = {};\r\n        plot.variables = variablesConf.keys;\r\n        if(!plot.variables || !plot.variables.length){\r\n            plot.variables = Utils.inferVariables(data, this.config.groups.key, this.config.includeInPlot);\r\n        }\r\n\r\n        plot.labels = [];\r\n        plot.labelByVariable = {};\r\n        plot.variables.forEach(function(variableKey, index) {\r\n            plot.domainByVariable[variableKey] = d3.extent(data, function(d) { return variablesConf.value(d, variableKey) });\r\n            var label = variableKey;\r\n            if(variablesConf.labels && variablesConf.labels.length>index){\r\n\r\n                label = variablesConf.labels[index];\r\n            }\r\n            plot.labels.push(label);\r\n            plot.labelByVariable[variableKey] = label;\r\n        });\r\n\r\n        console.log(plot.labelByVariable);\r\n\r\n        plot.subplots = [];\r\n    };\r\n\r\n    setupX() {\r\n\r\n        var plot = this.plot;\r\n        var x = plot.x;\r\n        var conf = this.config;\r\n\r\n        x.value = conf.variables.value;\r\n        x.scale = d3.scale[conf.x.scale]().range([conf.padding / 2, plot.size - conf.padding / 2]);\r\n        x.map = function (d, variable) {\r\n            return x.scale(x.value(d, variable));\r\n        };\r\n        x.axis = d3.svg.axis().scale(x.scale).orient(conf.x.orient).ticks(conf.ticks);\r\n        x.axis.tickSize(plot.size * plot.variables.length);\r\n\r\n    };\r\n\r\n    setupY() {\r\n\r\n        var plot = this.plot;\r\n        var y = plot.y;\r\n        var conf = this.config;\r\n\r\n        y.value = conf.variables.value;\r\n        y.scale = d3.scale[conf.y.scale]().range([ plot.size - conf.padding / 2, conf.padding / 2]);\r\n        y.map = function (d, variable) {\r\n            return y.scale(y.value(d, variable));\r\n        };\r\n        y.axis= d3.svg.axis().scale(y.scale).orient(conf.y.orient).ticks(conf.ticks);\r\n        y.axis.tickSize(-plot.size * plot.variables.length);\r\n    };\r\n\r\n    draw() {\r\n        var self =this;\r\n        var n = self.plot.variables.length;\r\n        var conf = this.config;\r\n\r\n        var axisClass = self.prefixClass(\"axis\");\r\n        var axisXClass = axisClass+\"-x\";\r\n        var axisYClass = axisClass+\"-y\";\r\n\r\n        var xAxisSelector = \"g.\"+axisXClass+\".\"+axisClass;\r\n        var yAxisSelector = \"g.\"+axisYClass+\".\"+axisClass;\r\n\r\n        var noGuidesClass = self.prefixClass(\"no-guides\");\r\n        self.svgG.selectAll(xAxisSelector)\r\n            .data(self.plot.variables)\r\n            .enter().appendSelector(xAxisSelector)\r\n            .classed(noGuidesClass, !conf.guides)\r\n            .attr(\"transform\", function(d, i) { return \"translate(\" + (n - i - 1) * self.plot.size + \",0)\"; })\r\n            .each(function(d) { self.plot.x.scale.domain(self.plot.domainByVariable[d]); d3.select(this).call(self.plot.x.axis); });\r\n\r\n        self.svgG.selectAll(yAxisSelector)\r\n            .data(self.plot.variables)\r\n            .enter().appendSelector(yAxisSelector)\r\n            .classed(noGuidesClass, !conf.guides)\r\n            .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * self.plot.size + \")\"; })\r\n            .each(function(d) { self.plot.y.scale.domain(self.plot.domainByVariable[d]); d3.select(this).call(self.plot.y.axis); });\r\n\r\n        var cellClass =  self.prefixClass(\"cell\");\r\n        var cell = self.svgG.selectAll(\".\"+cellClass)\r\n            .data(self.utils.cross(self.plot.variables, self.plot.variables))\r\n            .enter().appendSelector(\"g.\"+cellClass)\r\n            .attr(\"transform\", function(d) { return \"translate(\" + (n - d.i - 1) * self.plot.size + \",\" + d.j * self.plot.size + \")\"; });\r\n\r\n        if(conf.brush){\r\n            this.drawBrush(cell);\r\n        }\r\n\r\n        cell.each(plotSubplot);\r\n\r\n\r\n\r\n        //Labels\r\n        cell.filter(function(d) { return d.i === d.j; }).append(\"text\")\r\n            .attr(\"x\", conf.padding)\r\n            .attr(\"y\", conf.padding)\r\n            .attr(\"dy\", \".71em\")\r\n            .text(function(d) { return self.plot.labelByVariable[d.x]; });\r\n\r\n\r\n\r\n\r\n        function plotSubplot(p) {\r\n            var plot = self.plot;\r\n            plot.subplots.push(p);\r\n            var cell = d3.select(this);\r\n\r\n            plot.x.scale.domain(plot.domainByVariable[p.x]);\r\n            plot.y.scale.domain(plot.domainByVariable[p.y]);\r\n\r\n            var frameClass =  self.prefixClass(\"frame\");\r\n            cell.append(\"rect\")\r\n                .attr(\"class\", frameClass)\r\n                .attr(\"x\", conf.padding / 2)\r\n                .attr(\"y\", conf.padding / 2)\r\n                .attr(\"width\", conf.size - conf.padding)\r\n                .attr(\"height\", conf.size - conf.padding);\r\n\r\n\r\n            p.update = function(){\r\n                var subplot = this;\r\n                var dots = cell.selectAll(\"circle\")\r\n                    .data(self.data);\r\n\r\n                dots.enter().append(\"circle\");\r\n\r\n                dots.attr(\"cx\", function(d){return plot.x.map(d, subplot.x)})\r\n                    .attr(\"cy\", function(d){return plot.y.map(d, subplot.y)})\r\n                    .attr(\"r\", self.config.dot.radius);\r\n\r\n                if (plot.dot.color) {\r\n                    dots.style(\"fill\", plot.dot.color)\r\n                }\r\n\r\n                if(plot.tooltip){\r\n                    dots.on(\"mouseover\", function(d) {\r\n                        plot.tooltip.transition()\r\n                            .duration(200)\r\n                            .style(\"opacity\", .9);\r\n                        var html = \"(\" + plot.x.value(d, subplot.x) + \", \" +plot.y.value(d, subplot.y) + \")\";\r\n                        plot.tooltip.html(html)\r\n                            .style(\"left\", (d3.event.pageX + 5) + \"px\")\r\n                            .style(\"top\", (d3.event.pageY - 28) + \"px\");\r\n\r\n                        var group = self.config.groups.value(d);\r\n                        if(group || group===0 ){\r\n                            html+=\"<br/>\";\r\n                            var label = self.config.groups.label;\r\n                            if(label){\r\n                                html+=label+\": \";\r\n                            }\r\n                            html+=group\r\n                        }\r\n                        plot.tooltip.html(html)\r\n                            .style(\"left\", (d3.event.pageX + 5) + \"px\")\r\n                            .style(\"top\", (d3.event.pageY - 28) + \"px\");\r\n                    })\r\n                        .on(\"mouseout\", function(d) {\r\n                            plot.tooltip.transition()\r\n                                .duration(500)\r\n                                .style(\"opacity\", 0);\r\n                        });\r\n                }\r\n\r\n                dots.exit().remove();\r\n            };\r\n            p.update();\r\n\r\n        }\r\n\r\n\r\n        this.updateLegend();\r\n    };\r\n\r\n    update(data) {\r\n\r\n        super.update(data);\r\n        this.plot.subplots.forEach(function(p){p.update()});\r\n        this.updateLegend();\r\n    };\r\n\r\n    drawBrush(cell) {\r\n        var self = this;\r\n        var brush = d3.svg.brush()\r\n            .x(self.plot.x.scale)\r\n            .y(self.plot.y.scale)\r\n            .on(\"brushstart\", brushstart)\r\n            .on(\"brush\", brushmove)\r\n            .on(\"brushend\", brushend);\r\n\r\n        cell.append(\"g\").call(brush);\r\n\r\n\r\n        var brushCell;\r\n\r\n        // Clear the previously-active brush, if any.\r\n        function brushstart(p) {\r\n            if (brushCell !== this) {\r\n                d3.select(brushCell).call(brush.clear());\r\n                self.plot.x.scale.domain(self.plot.domainByVariable[p.x]);\r\n                self.plot.y.scale.domain(self.plot.domainByVariable[p.y]);\r\n                brushCell = this;\r\n            }\r\n        }\r\n\r\n        // Highlight the selected circles.\r\n        function brushmove(p) {\r\n            var e = brush.extent();\r\n            self.svgG.selectAll(\"circle\").classed(\"hidden\", function (d) {\r\n                return e[0][0] > d[p.x] || d[p.x] > e[1][0]\r\n                    || e[0][1] > d[p.y] || d[p.y] > e[1][1];\r\n            });\r\n        }\r\n        // If the brush is empty, select all circles.\r\n        function brushend() {\r\n            if (brush.empty()) self.svgG.selectAll(\".hidden\").classed(\"hidden\", false);\r\n        }\r\n    };\r\n\r\n    updateLegend() {\r\n\r\n        console.log('updateLegend');\r\n        var plot = this.plot;\r\n\r\n        var scale = plot.dot.colorCategory;\r\n        if(!scale.domain() || scale.domain().length<2){\r\n            plot.showLegend = false;\r\n        }\r\n\r\n        if(!plot.showLegend){\r\n            if(plot.legend && plot.legend.container){\r\n                plot.legend.container.remove();\r\n            }\r\n            return;\r\n        }\r\n\r\n\r\n        var legendX = this.plot.width + this.config.legend.margin;\r\n        var legendY = this.config.legend.margin;\r\n\r\n        plot.legend = new Legend(this.svg, this.svgG, scale, legendX, legendY);\r\n\r\n        var legendLinear = plot.legend.color()\r\n            .shapeWidth(this.config.legend.shapeWidth)\r\n            .orient('vertical')\r\n            .scale(scale);\r\n\r\n        plot.legend.container\r\n            .call(legendLinear);\r\n    }\r\n}","import {Chart, ChartConfig} from \"./chart\";\r\nimport {Utils} from './utils'\r\nimport {Legend} from \"./legend\";\r\n\r\nexport class ScatterPlotConfig extends ChartConfig{\r\n\r\n    svgClass= this.cssClassPrefix+'scatterplot';\r\n    guides= false; //show axis guides\r\n    tooltip= true; //show tooltip on dot hover\r\n    showLegend=true;\r\n    legend={\r\n        width: 80,\r\n        margin: 10,\r\n        shapeWidth: 20\r\n    };\r\n\r\n    x={// X axis config\r\n        label: 'X', // axis label\r\n        key: 0,\r\n        value: function(d, key) { return d[key] }, // x value accessor\r\n        orient: \"bottom\",\r\n        scale: \"linear\"\r\n    };\r\n    y={// Y axis config\r\n        label: 'Y', // axis label,\r\n        key: 1,\r\n        value: function(d, key) { return d[key] }, // y value accessor\r\n        orient: \"left\",\r\n        scale: \"linear\"\r\n    };\r\n    groups={\r\n        key: 2,\r\n        value: function(d, key) { return d[key] }, // grouping value accessor,\r\n        label: \"\"\r\n    };\r\n    transition= true;\r\n\r\n    constructor(custom){\r\n        super();\r\n        var config = this;\r\n        this.dot={\r\n            radius: 2,\r\n            color: function(d) { return config.groups.value(d, config.groups.key) }, // string or function returning color's value for color scale\r\n            d3ColorCategory: 'category10'\r\n        };\r\n\r\n        if(custom){\r\n            Utils.deepExtend(this, custom);\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport class ScatterPlot extends Chart{\r\n    constructor(placeholderSelector, data, config) {\r\n        super(placeholderSelector, data, new ScatterPlotConfig(config));\r\n    }\r\n\r\n    setConfig(config){\r\n        return super.setConfig(new ScatterPlotConfig(config));\r\n    }\r\n\r\n    initPlot(){\r\n        super.initPlot();\r\n        var self=this;\r\n\r\n        var conf = this.config;\r\n\r\n        this.plot.x={};\r\n        this.plot.y={};\r\n        this.plot.dot={\r\n            color: null//color scale mapping function\r\n        };\r\n\r\n\r\n        this.plot.showLegend = conf.showLegend;\r\n        if(this.plot.showLegend){\r\n            this.plot.margin.right = conf.margin.right + conf.legend.width+conf.legend.margin*2;\r\n        }\r\n        \r\n\r\n        this.computePlotSize();\r\n        \r\n\r\n\r\n        // var legendWidth = availableWidth;\r\n        // legend.width(legendWidth);\r\n        //\r\n        // wrap.select('.nv-legendWrap')\r\n        //     .datum(data)\r\n        //     .call(legend);\r\n        //\r\n        // if (legend.height() > margin.top) {\r\n        //     margin.top = legend.height();\r\n        //     availableHeight = nv.utils.availableHeight(height, container, margin);\r\n        // }\r\n\r\n        this.setupX();\r\n        this.setupY();\r\n\r\n        if(conf.dot.d3ColorCategory){\r\n            this.plot.dot.colorCategory = d3.scale[conf.dot.d3ColorCategory]();\r\n        }\r\n        var colorValue = conf.dot.color;\r\n        if(colorValue){\r\n            this.plot.dot.colorValue = colorValue;\r\n\r\n            if (typeof colorValue === 'string' || colorValue instanceof String){\r\n                this.plot.dot.color = colorValue;\r\n            }else if(this.plot.dot.colorCategory){\r\n                this.plot.dot.color = function(d){\r\n                    return self.plot.dot.colorCategory(self.plot.dot.colorValue(d));\r\n                }\r\n            }\r\n\r\n\r\n        }else{\r\n\r\n\r\n        }\r\n\r\n\r\n        return this;\r\n    }\r\n\r\n    setupX(){\r\n\r\n        var plot = this.plot;\r\n        var x = plot.x;\r\n        var conf = this.config.x;\r\n\r\n        /* *\r\n         * value accessor - returns the value to encode for a given data object.\r\n         * scale - maps value to a visual display encoding, such as a pixel position.\r\n         * map function - maps from data value to display value\r\n         * axis - sets up axis\r\n         **/\r\n        x.value = d => conf.value(d, conf.key);\r\n        x.scale = d3.scale[conf.scale]().range([0, plot.width]);\r\n        x.map = function(d) { return x.scale(x.value(d));};\r\n        x.axis = d3.svg.axis().scale(x.scale).orient(conf.orient);\r\n        var data = this.data;\r\n        plot.x.scale.domain([d3.min(data, plot.x.value)-1, d3.max(data, plot.x.value)+1]);\r\n        if(this.config.guides) {\r\n            x.axis.tickSize(-plot.height);\r\n        }\r\n\r\n    };\r\n\r\n    setupY (){\r\n\r\n        var plot = this.plot;\r\n        var y = plot.y;\r\n        var conf = this.config.y;\r\n\r\n        /*\r\n         * value accessor - returns the value to encode for a given data object.\r\n         * scale - maps value to a visual display encoding, such as a pixel position.\r\n         * map function - maps from data value to display value\r\n         * axis - sets up axis\r\n         */\r\n        y.value = d => conf.value(d, conf.key);\r\n        y.scale = d3.scale[conf.scale]().range([plot.height, 0]);\r\n        y.map = function(d) { return y.scale(y.value(d));};\r\n        y.axis = d3.svg.axis().scale(y.scale).orient(conf.orient);\r\n\r\n        if(this.config.guides){\r\n            y.axis.tickSize(-plot.width);\r\n        }\r\n\r\n\r\n        var data = this.data;\r\n        plot.y.scale.domain([d3.min(data, plot.y.value)-1, d3.max(data, plot.y.value)+1]);\r\n    };\r\n\r\n    draw(){\r\n        this.drawAxisX();\r\n        this.drawAxisY();\r\n        this.update();\r\n    };\r\n\r\n    drawAxisX(){\r\n\r\n        \r\n        var self = this;\r\n        var plot = self.plot;\r\n        var axisConf = this.config.x;\r\n        self.svgG.selectOrAppend(\"g.\"+self.prefixClass('axis-x')+\".\"+self.prefixClass('axis')+(self.config.guides ? '' : '.'+self.prefixClass('no-guides')))\r\n            .attr(\"transform\", \"translate(0,\" + plot.height + \")\")\r\n            .call(plot.x.axis)\r\n            .selectOrAppend(\"text.\"+self.prefixClass('label'))\r\n            .attr(\"transform\", \"translate(\"+ (plot.width/2) +\",\"+ (plot.margin.bottom) +\")\")  // text is drawn off the screen top left, move down and out and rotate\r\n            .attr(\"dy\", \"-1em\")\r\n            .style(\"text-anchor\", \"middle\")\r\n            .text(axisConf.label);\r\n    };\r\n\r\n    drawAxisY(){\r\n        var self = this;\r\n        var plot = self.plot;\r\n        var axisConf = this.config.y;\r\n        self.svgG.selectOrAppend(\"g.\"+self.prefixClass('axis-y')+\".\"+self.prefixClass('axis')+(self.config.guides ? '' : '.'+self.prefixClass('no-guides')))\r\n            .call(plot.y.axis)\r\n            .selectOrAppend(\"text.\"+self.prefixClass('label'))\r\n            .attr(\"transform\", \"translate(\"+ -plot.margin.left +\",\"+(plot.height/2)+\")rotate(-90)\")  // text is drawn off the screen top left, move down and out and rotate\r\n            .attr(\"dy\", \"1em\")\r\n            .style(\"text-anchor\", \"middle\")\r\n            .text(axisConf.label);\r\n    };\r\n\r\n    update(newData){\r\n        super.update(newData);\r\n\r\n        this.updateDots();\r\n\r\n        this.updateLegend();\r\n    };\r\n\r\n    updateDots() {\r\n        var self = this;\r\n        var plot = self.plot;\r\n        var data = this.data;\r\n        var dotClass = self.prefixClass('dot');\r\n        self.dotsContainerClass = self.prefixClass('dots-container');\r\n\r\n\r\n        var dotsContainer = self.svgG.selectOrAppend(\"g.\" + self.dotsContainerClass);\r\n\r\n        var dots = dotsContainer.selectAll('.' + dotClass)\r\n            .data(data);\r\n\r\n        dots.enter().append(\"circle\")\r\n            .attr(\"class\", dotClass);\r\n\r\n        var dotsT = dots;\r\n        if (self.config.transition) {\r\n            dotsT = dots.transition();\r\n        }\r\n\r\n        dotsT.attr(\"r\", self.config.dot.radius)\r\n            .attr(\"cx\", plot.x.map)\r\n            .attr(\"cy\", plot.y.map);\r\n\r\n        if (plot.tooltip) {\r\n            dots.on(\"mouseover\", function (d) {\r\n                plot.tooltip.transition()\r\n                    .duration(200)\r\n                    .style(\"opacity\", .9);\r\n                var html = \"(\" + plot.x.value(d) + \", \" + plot.y.value(d) + \")\";\r\n                var group = self.config.groups.value(d, self.config.groups.key);\r\n                if (group || group === 0) {\r\n                    html += \"<br/>\";\r\n                    var label = self.config.groups.label;\r\n                    if (label) {\r\n                        html += label + \": \";\r\n                    }\r\n                    html += group\r\n                }\r\n                plot.tooltip.html(html)\r\n                    .style(\"left\", (d3.event.pageX + 5) + \"px\")\r\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\r\n            })\r\n                .on(\"mouseout\", function (d) {\r\n                    plot.tooltip.transition()\r\n                        .duration(500)\r\n                        .style(\"opacity\", 0);\r\n                });\r\n        }\r\n\r\n        if (plot.dot.color) {\r\n            dots.style(\"fill\", plot.dot.color)\r\n        }\r\n\r\n        dots.exit().remove();\r\n    }\r\n\r\n    updateLegend() {\r\n\r\n\r\n        var plot = this.plot;\r\n\r\n        var scale = plot.dot.colorCategory;\r\n        if(!scale.domain() || scale.domain().length<2){\r\n            plot.showLegend = false;\r\n        }\r\n\r\n        if(!plot.showLegend){\r\n            if(plot.legend && plot.legend.container){\r\n                plot.legend.container.remove();\r\n            }\r\n            return;\r\n        }\r\n\r\n\r\n        var legendX = this.plot.width + this.config.legend.margin;\r\n        var legendY = this.config.legend.margin;\r\n\r\n        plot.legend = new Legend(this.svg, this.svgG, scale, legendX, legendY);\r\n\r\n        var legendLinear = plot.legend.color()\r\n            .shapeWidth(this.config.legend.shapeWidth)\r\n            .orient('vertical')\r\n            .scale(scale);\r\n        \r\n        plot.legend.container\r\n            .call(legendLinear);\r\n    }\r\n\r\n    \r\n}\r\n","/*\n * https://gist.github.com/benrasmusen/1261977\n * NAME\n * \n * statistics-distributions.js - JavaScript library for calculating\n *   critical values and upper probabilities of common statistical\n *   distributions\n * \n * SYNOPSIS\n * \n * \n *   // Chi-squared-crit (2 degrees of freedom, 95th percentile = 0.05 level\n *   chisqrdistr(2, .05)\n *   \n *   // u-crit (95th percentile = 0.05 level)\n *   udistr(.05);\n *   \n *   // t-crit (1 degree of freedom, 99.5th percentile = 0.005 level) \n *   tdistr(1,.005);\n *   \n *   // F-crit (1 degree of freedom in numerator, 3 degrees of freedom \n *   //         in denominator, 99th percentile = 0.01 level)\n *   fdistr(1,3,.01);\n *   \n *   // upper probability of the u distribution (u = -0.85): Q(u) = 1-G(u)\n *   uprob(-0.85);\n *   \n *   // upper probability of the chi-square distribution\n *   // (3 degrees of freedom, chi-squared = 6.25): Q = 1-G\n *   chisqrprob(3,6.25);\n *   \n *   // upper probability of the t distribution\n *   // (3 degrees of freedom, t = 6.251): Q = 1-G\n *   tprob(3,6.251);\n *   \n *   // upper probability of the F distribution\n *   // (3 degrees of freedom in numerator, 5 degrees of freedom in\n *   //  denominator, F = 6.25): Q = 1-G\n *   fprob(3,5,.625);\n * \n * \n *  DESCRIPTION\n * \n * This library calculates percentage points (5 significant digits) of the u\n * (standard normal) distribution, the student's t distribution, the\n * chi-square distribution and the F distribution. It can also calculate the\n * upper probability (5 significant digits) of the u (standard normal), the\n * chi-square, the t and the F distribution.\n * \n * These critical values are needed to perform statistical tests, like the u\n * test, the t test, the F test and the chi-squared test, and to calculate\n * confidence intervals.\n * \n * If you are interested in more precise algorithms you could look at:\n *   StatLib: http://lib.stat.cmu.edu/apstat/ ; \n *   Applied Statistics Algorithms by Griffiths, P. and Hill, I.D.\n *   , Ellis Horwood: Chichester (1985)\n * \n * BUGS \n * \n * This port was produced from the Perl module Statistics::Distributions\n * that has had no bug reports in several years.  If you find a bug then\n * please double-check that JavaScript does not thing the numbers you are\n * passing in are strings.  (You can subtract 0 from them as you pass them\n * in so that \"5\" is properly understood to be 5.)  If you have passed in a\n * number then please contact the author\n * \n * AUTHOR\n * \n * Ben Tilly <btilly@gmail.com>\n * \n * Originl Perl version by Michael Kospach <mike.perl@gmx.at>\n * \n * Nice formating, simplification and bug repair by Matthias Trautner Kromann\n * <mtk@id.cbs.dk>\n * \n * COPYRIGHT \n * \n * Copyright 2008 Ben Tilly.\n * \n * This library is free software; you can redistribute it and/or modify it\n * under the same terms as Perl itself.  This means under either the Perl\n * Artistic License or the GPL v1 or later.\n */\n\nvar SIGNIFICANT = 5; // number of significant digits to be returned\n\nfunction chisqrdistr ($n, $p) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow(\"Invalid n: $n\\n\"); /* degree of freedom */\n\t}\n\tif ($p <= 0 || $p > 1) {\n\t\tthrow(\"Invalid p: $p\\n\"); \n\t}\n\treturn precision_string(_subchisqr($n-0, $p-0));\n}\n\nfunction udistr ($p) {\n\tif ($p > 1 || $p <= 0) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t}\n\treturn precision_string(_subu($p-0));\n}\n\nexport function tdistr ($n, $p) {\n\tif ($n <= 0 || Math.abs($n) - Math.abs(integer($n)) != 0) {\n\t\tthrow(\"Invalid n: $n\\n\");\n\t}\n\tif ($p <= 0 || $p >= 1) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t}\n\treturn precision_string(_subt($n-0, $p-0));\n}\n\nfunction fdistr ($n, $m, $p) {\n\tif (($n<=0) || ((Math.abs($n)-(Math.abs(integer($n))))!=0)) {\n\t\tthrow(\"Invalid n: $n\\n\"); /* first degree of freedom */\n\t}\n\tif (($m<=0) || ((Math.abs($m)-(Math.abs(integer($m))))!=0)) {\n\t\tthrow(\"Invalid m: $m\\n\"); /* second degree of freedom */\n\t}\n\tif (($p<=0) || ($p>1)) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t}\n\treturn precision_string(_subf($n-0, $m-0, $p-0));\n}\n\nfunction uprob ($x) {\n\treturn precision_string(_subuprob($x-0));\n}\n\nfunction chisqrprob ($n,$x) {\n\tif (($n <= 0) || ((Math.abs($n) - (Math.abs(integer($n)))) != 0)) {\n\t\tthrow(\"Invalid n: $n\\n\"); /* degree of freedom */\n\t}\n\treturn precision_string(_subchisqrprob($n-0, $x-0));\n}\n\nfunction tprob ($n, $x) {\n\tif (($n <= 0) || ((Math.abs($n) - Math.abs(integer($n))) !=0)) {\n\t\tthrow(\"Invalid n: $n\\n\"); /* degree of freedom */\n\t}\n\treturn precision_string(_subtprob($n-0, $x-0));\n}\n\nfunction fprob ($n, $m, $x) {\n\tif (($n<=0) || ((Math.abs($n)-(Math.abs(integer($n))))!=0)) {\n\t\tthrow(\"Invalid n: $n\\n\"); /* first degree of freedom */\n\t}\n\tif (($m<=0) || ((Math.abs($m)-(Math.abs(integer($m))))!=0)) {\n\t\tthrow(\"Invalid m: $m\\n\"); /* second degree of freedom */\n\t} \n\treturn precision_string(_subfprob($n-0, $m-0, $x-0));\n}\n\n\nfunction _subfprob ($n, $m, $x) {\n\tvar $p;\n\n\tif ($x<=0) {\n\t\t$p=1;\n\t} else if ($m % 2 == 0) {\n\t\tvar $z = $m / ($m + $n * $x);\n\t\tvar $a = 1;\n\t\tfor (var $i = $m - 2; $i >= 2; $i -= 2) {\n\t\t\t$a = 1 + ($n + $i - 2) / $i * $z * $a;\n\t\t}\n\t\t$p = 1 - Math.pow((1 - $z), ($n / 2) * $a);\n\t} else if ($n % 2 == 0) {\n\t\tvar $z = $n * $x / ($m + $n * $x);\n\t\tvar $a = 1;\n\t\tfor (var $i = $n - 2; $i >= 2; $i -= 2) {\n\t\t\t$a = 1 + ($m + $i - 2) / $i * $z * $a;\n\t\t}\n\t\t$p = Math.pow((1 - $z), ($m / 2)) * $a;\n\t} else {\n\t\tvar $y = Math.atan2(Math.sqrt($n * $x / $m), 1);\n\t\tvar $z = Math.pow(Math.sin($y), 2);\n\t\tvar $a = ($n == 1) ? 0 : 1;\n\t\tfor (var $i = $n - 2; $i >= 3; $i -= 2) {\n\t\t\t$a = 1 + ($m + $i - 2) / $i * $z * $a;\n\t\t} \n\t\tvar $b = Math.PI;\n\t\tfor (var $i = 2; $i <= $m - 1; $i += 2) {\n\t\t\t$b *= ($i - 1) / $i;\n\t\t}\n\t\tvar $p1 = 2 / $b * Math.sin($y) * Math.pow(Math.cos($y), $m) * $a;\n\n\t\t$z = Math.pow(Math.cos($y), 2);\n\t\t$a = ($m == 1) ? 0 : 1;\n\t\tfor (var $i = $m-2; $i >= 3; $i -= 2) {\n\t\t\t$a = 1 + ($i - 1) / $i * $z * $a;\n\t\t}\n\t\t$p = max(0, $p1 + 1 - 2 * $y / Math.PI\n\t\t\t- 2 / Math.PI * Math.sin($y) * Math.cos($y) * $a);\n\t}\n\treturn $p;\n}\n\n\nfunction _subchisqrprob ($n,$x) {\n\tvar $p;\n\n\tif ($x <= 0) {\n\t\t$p = 1;\n\t} else if ($n > 100) {\n\t\t$p = _subuprob((Math.pow(($x / $n), 1/3)\n\t\t\t\t- (1 - 2/9/$n)) / Math.sqrt(2/9/$n));\n\t} else if ($x > 400) {\n\t\t$p = 0;\n\t} else {   \n\t\tvar $a;\n                var $i;\n                var $i1;\n\t\tif (($n % 2) != 0) {\n\t\t\t$p = 2 * _subuprob(Math.sqrt($x));\n\t\t\t$a = Math.sqrt(2/Math.PI) * Math.exp(-$x/2) / Math.sqrt($x);\n\t\t\t$i1 = 1;\n\t\t} else {\n\t\t\t$p = $a = Math.exp(-$x/2);\n\t\t\t$i1 = 2;\n\t\t}\n\n\t\tfor ($i = $i1; $i <= ($n-2); $i += 2) {\n\t\t\t$a *= $x / $i;\n\t\t\t$p += $a;\n\t\t}\n\t}\n\treturn $p;\n}\n\nfunction _subu ($p) {\n\tvar $y = -Math.log(4 * $p * (1 - $p));\n\tvar $x = Math.sqrt(\n\t\t$y * (1.570796288\n\t\t  + $y * (.03706987906\n\t\t  \t+ $y * (-.8364353589E-3\n\t\t\t  + $y *(-.2250947176E-3\n\t\t\t  \t+ $y * (.6841218299E-5\n\t\t\t\t  + $y * (0.5824238515E-5\n\t\t\t\t\t+ $y * (-.104527497E-5\n\t\t\t\t\t  + $y * (.8360937017E-7\n\t\t\t\t\t\t+ $y * (-.3231081277E-8\n\t\t\t\t\t\t  + $y * (.3657763036E-10\n\t\t\t\t\t\t\t+ $y *.6936233982E-12)))))))))));\n\tif ($p>.5)\n                $x = -$x;\n\treturn $x;\n}\n\nfunction _subuprob ($x) {\n\tvar $p = 0; /* if ($absx > 100) */\n\tvar $absx = Math.abs($x);\n\n\tif ($absx < 1.9) {\n\t\t$p = Math.pow((1 +\n\t\t\t$absx * (.049867347\n\t\t\t  + $absx * (.0211410061\n\t\t\t  \t+ $absx * (.0032776263\n\t\t\t\t  + $absx * (.0000380036\n\t\t\t\t\t+ $absx * (.0000488906\n\t\t\t\t\t  + $absx * .000005383)))))), -16)/2;\n\t} else if ($absx <= 100) {\n\t\tfor (var $i = 18; $i >= 1; $i--) {\n\t\t\t$p = $i / ($absx + $p);\n\t\t}\n\t\t$p = Math.exp(-.5 * $absx * $absx) \n\t\t\t/ Math.sqrt(2 * Math.PI) / ($absx + $p);\n\t}\n\n\tif ($x<0)\n        \t$p = 1 - $p;\n\treturn $p;\n}\n\n   \nfunction _subt ($n, $p) {\n\n\tif ($p >= 1 || $p <= 0) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t}\n\n\tif ($p == 0.5) {\n\t\treturn 0;\n\t} else if ($p < 0.5) {\n\t\treturn - _subt($n, 1 - $p);\n\t}\n\n\tvar $u = _subu($p);\n\tvar $u2 = Math.pow($u, 2);\n\n\tvar $a = ($u2 + 1) / 4;\n\tvar $b = ((5 * $u2 + 16) * $u2 + 3) / 96;\n\tvar $c = (((3 * $u2 + 19) * $u2 + 17) * $u2 - 15) / 384;\n\tvar $d = ((((79 * $u2 + 776) * $u2 + 1482) * $u2 - 1920) * $u2 - 945) \n\t\t\t\t/ 92160;\n\tvar $e = (((((27 * $u2 + 339) * $u2 + 930) * $u2 - 1782) * $u2 - 765) * $u2\n\t\t\t+ 17955) / 368640;\n\n\tvar $x = $u * (1 + ($a + ($b + ($c + ($d + $e / $n) / $n) / $n) / $n) / $n);\n\n\tif ($n <= Math.pow(log10($p), 2) + 3) {\n\t\tvar $round;\n\t\tdo { \n\t\t\tvar $p1 = _subtprob($n, $x);\n\t\t\tvar $n1 = $n + 1;\n\t\t\tvar $delta = ($p1 - $p) \n\t\t\t\t/ Math.exp(($n1 * Math.log($n1 / ($n + $x * $x)) \n\t\t\t\t\t+ Math.log($n/$n1/2/Math.PI) - 1 \n\t\t\t\t\t+ (1/$n1 - 1/$n) / 6) / 2);\n\t\t\t$x += $delta;\n\t\t\t$round = round_to_precision($delta, Math.abs(integer(log10(Math.abs($x))-4)));\n\t\t} while (($x) && ($round != 0));\n\t}\n\treturn $x;\n}\n\nfunction _subtprob ($n, $x) {\n\n\tvar $a;\n        var $b;\n\tvar $w = Math.atan2($x / Math.sqrt($n), 1);\n\tvar $z = Math.pow(Math.cos($w), 2);\n\tvar $y = 1;\n\n\tfor (var $i = $n-2; $i >= 2; $i -= 2) {\n\t\t$y = 1 + ($i-1) / $i * $z * $y;\n\t} \n\n\tif ($n % 2 == 0) {\n\t\t$a = Math.sin($w)/2;\n\t\t$b = .5;\n\t} else {\n\t\t$a = ($n == 1) ? 0 : Math.sin($w)*Math.cos($w)/Math.PI;\n\t\t$b= .5 + $w/Math.PI;\n\t}\n\treturn max(0, 1 - $b - $a * $y);\n}\n\nfunction _subf ($n, $m, $p) {\n\tvar $x;\n\n\tif ($p >= 1 || $p <= 0) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t}\n\n\tif ($p == 1) {\n\t\t$x = 0;\n\t} else if ($m == 1) {\n\t\t$x = 1 / Math.pow(_subt($n, 0.5 - $p / 2), 2);\n\t} else if ($n == 1) {\n\t\t$x = Math.pow(_subt($m, $p/2), 2);\n\t} else if ($m == 2) {\n\t\tvar $u = _subchisqr($m, 1 - $p);\n\t\tvar $a = $m - 2;\n\t\t$x = 1 / ($u / $m * (1 +\n\t\t\t(($u - $a) / 2 +\n\t\t\t\t(((4 * $u - 11 * $a) * $u + $a * (7 * $m - 10)) / 24 +\n\t\t\t\t\t(((2 * $u - 10 * $a) * $u + $a * (17 * $m - 26)) * $u\n\t\t\t\t\t\t- $a * $a * (9 * $m - 6)\n\t\t\t\t\t)/48/$n\n\t\t\t\t)/$n\n\t\t\t)/$n));\n\t} else if ($n > $m) {\n\t\t$x = 1 / _subf2($m, $n, 1 - $p)\n\t} else {\n\t\t$x = _subf2($n, $m, $p)\n\t}\n\treturn $x;\n}\n\nfunction _subf2 ($n, $m, $p) {\n\tvar $u = _subchisqr($n, $p);\n\tvar $n2 = $n - 2;\n\tvar $x = $u / $n * \n\t\t(1 + \n\t\t\t(($u - $n2) / 2 + \n\t\t\t\t(((4 * $u - 11 * $n2) * $u + $n2 * (7 * $n - 10)) / 24 + \n\t\t\t\t\t(((2 * $u - 10 * $n2) * $u + $n2 * (17 * $n - 26)) * $u \n\t\t\t\t\t\t- $n2 * $n2 * (9 * $n - 6)) / 48 / $m) / $m) / $m);\n\tvar $delta;\n\tdo {\n\t\tvar $z = Math.exp(\n\t\t\t(($n+$m) * Math.log(($n+$m) / ($n * $x + $m)) \n\t\t\t\t+ ($n - 2) * Math.log($x)\n\t\t\t\t+ Math.log($n * $m / ($n+$m))\n\t\t\t\t- Math.log(4 * Math.PI)\n\t\t\t\t- (1/$n  + 1/$m - 1/($n+$m))/6\n\t\t\t)/2);\n\t\t$delta = (_subfprob($n, $m, $x) - $p) / $z;\n\t\t$x += $delta;\n\t} while (Math.abs($delta)>3e-4);\n\treturn $x;\n}\n\nfunction _subchisqr ($n, $p) {\n\tvar $x;\n\n\tif (($p > 1) || ($p <= 0)) {\n\t\tthrow(\"Invalid p: $p\\n\");\n\t} else if ($p == 1){\n\t\t$x = 0;\n\t} else if ($n == 1) {\n\t\t$x = Math.pow(_subu($p / 2), 2);\n\t} else if ($n == 2) {\n\t\t$x = -2 * Math.log($p);\n\t} else {\n\t\tvar $u = _subu($p);\n\t\tvar $u2 = $u * $u;\n\n\t\t$x = max(0, $n + Math.sqrt(2 * $n) * $u \n\t\t\t+ 2/3 * ($u2 - 1)\n\t\t\t+ $u * ($u2 - 7) / 9 / Math.sqrt(2 * $n)\n\t\t\t- 2/405 / $n * ($u2 * (3 *$u2 + 7) - 16));\n\n\t\tif ($n <= 100) {\n\t\t\tvar $x0;\n                        var $p1;\n                        var $z;\n\t\t\tdo {\n\t\t\t\t$x0 = $x;\n\t\t\t\tif ($x < 0) {\n\t\t\t\t\t$p1 = 1;\n\t\t\t\t} else if ($n>100) {\n\t\t\t\t\t$p1 = _subuprob((Math.pow(($x / $n), (1/3)) - (1 - 2/9/$n))\n\t\t\t\t\t\t/ Math.sqrt(2/9/$n));\n\t\t\t\t} else if ($x>400) {\n\t\t\t\t\t$p1 = 0;\n\t\t\t\t} else {\n\t\t\t\t\tvar $i0\n                                        var $a;\n\t\t\t\t\tif (($n % 2) != 0) {\n\t\t\t\t\t\t$p1 = 2 * _subuprob(Math.sqrt($x));\n\t\t\t\t\t\t$a = Math.sqrt(2/Math.PI) * Math.exp(-$x/2) / Math.sqrt($x);\n\t\t\t\t\t\t$i0 = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$p1 = $a = Math.exp(-$x/2);\n\t\t\t\t\t\t$i0 = 2;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var $i = $i0; $i <= $n-2; $i += 2) {\n\t\t\t\t\t\t$a *= $x / $i;\n\t\t\t\t\t\t$p1 += $a;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$z = Math.exp((($n-1) * Math.log($x/$n) - Math.log(4*Math.PI*$x) \n\t\t\t\t\t+ $n - $x - 1/$n/6) / 2);\n\t\t\t\t$x += ($p1 - $p) / $z;\n\t\t\t\t$x = round_to_precision($x, 5);\n\t\t\t} while (($n < 31) && (Math.abs($x0 - $x) > 1e-4));\n\t\t}\n\t}\n\treturn $x;\n}\n\nfunction log10 ($n) {\n\treturn Math.log($n) / Math.log(10);\n}\n \nfunction max () {\n\tvar $max = arguments[0];\n\tfor (var $i = 0; i < arguments.length; i++) {\n                if ($max < arguments[$i])\n                        $max = arguments[$i];\n\t}\t\n\treturn $max;\n}\n\nfunction min () {\n\tvar $min = arguments[0];\n\tfor (var $i = 0; i < arguments.length; i++) {\n                if ($min > arguments[$i])\n                        $min = arguments[$i];\n\t}\n\treturn $min;\n}\n\nfunction precision ($x) {\n\treturn Math.abs(integer(log10(Math.abs($x)) - SIGNIFICANT));\n}\n\nfunction precision_string ($x) {\n\tif ($x) {\n\t\treturn round_to_precision($x, precision($x));\n\t} else {\n\t\treturn \"0\";\n\t}\n}\n\nfunction round_to_precision ($x, $p) {\n        $x = $x * Math.pow(10, $p);\n        $x = Math.round($x);\n        return $x / Math.pow(10, $p);\n}\n\nfunction integer ($i) {\n        if ($i > 0)\n                return Math.floor($i);\n        else\n                return Math.ceil($i);\n}","import {tdistr} from \"./statistics-distributions\"\r\n\r\nvar su = module.exports.StatisticsUtils ={};\r\nsu.sampleCorrelation = require('../bower_components/simple-statistics/src/sample_correlation');\r\nsu.linearRegression = require('../bower_components/simple-statistics/src/linear_regression');\r\nsu.linearRegressionLine = require('../bower_components/simple-statistics/src/linear_regression_line');\r\nsu.errorFunction = require('../bower_components/simple-statistics/src/error_function');\r\nsu.standardDeviation = require('../bower_components/simple-statistics/src/standard_deviation');\r\nsu.sampleStandardDeviation = require('../bower_components/simple-statistics/src/sample_standard_deviation');\r\nsu.variance = require('../bower_components/simple-statistics/src/variance');\r\nsu.mean = require('../bower_components/simple-statistics/src/mean');\r\nsu.zScore = require('../bower_components/simple-statistics/src/z_score');\r\nsu.standardError= arr => Math.sqrt(su.variance(arr)/(arr.length-1));\r\n\r\n\r\nsu.tValue= (degreesOfFreedom, criticalProbability) => { //as in http://stattrek.com/online-calculator/t-distribution.aspx\r\n    return tdistr(degreesOfFreedom, criticalProbability);\r\n};","export class Utils {\r\n    // usage example deepExtend({}, objA, objB); => should work similar to $.extend(true, {}, objA, objB);\r\n    static deepExtend(out) {\r\n\r\n        var utils = this;\r\n        var emptyOut = {};\r\n\r\n\r\n        if (!out && arguments.length > 1 && Array.isArray(arguments[1])) {\r\n            out = [];\r\n        }\r\n        out = out || {};\r\n\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            var source = arguments[i];\r\n            if (!source)\r\n                continue;\r\n\r\n            for (var key in source) {\r\n                if (!source.hasOwnProperty(key)) {\r\n                    continue;\r\n                }\r\n                var isArray = Array.isArray(out[key]);\r\n                var isObject = utils.isObject(out[key]);\r\n                var srcObj = utils.isObject(source[key]);\r\n\r\n                if (isObject && !isArray && srcObj) {\r\n                    utils.deepExtend(out[key], source[key]);\r\n                } else {\r\n                    out[key] = source[key];\r\n                }\r\n            }\r\n        }\r\n\r\n        return out;\r\n    };\r\n\r\n    static mergeDeep(target, source) {\r\n        let output = Object.assign({}, target);\r\n        if (Utils.isObjectNotArray(target) && Utils.isObjectNotArray(source)) {\r\n            Object.keys(source).forEach(key => {\r\n                if (Utils.isObjectNotArray(source[key])) {\r\n                    if (!(key in target))\r\n                        Object.assign(output, {[key]: source[key]});\r\n                    else\r\n                        output[key] = Utils.mergeDeep(target[key], source[key]);\r\n                } else {\r\n                    Object.assign(output, {[key]: source[key]});\r\n                }\r\n            });\r\n        }\r\n        return output;\r\n    }\r\n\r\n    static cross(a, b) {\r\n        var c = [], n = a.length, m = b.length, i, j;\r\n        for (i = -1; ++i < n;) for (j = -1; ++j < m;) c.push({x: a[i], i: i, y: b[j], j: j});\r\n        return c;\r\n    };\r\n\r\n    static inferVariables(data, groupKey, includeGroup) {\r\n        var res = [];\r\n        if (data.length) {\r\n            var d = data[0];\r\n            if (d instanceof Array) {\r\n                res = d.map(function (v, i) {\r\n                    return i;\r\n                });\r\n            } else if (typeof d === 'object') {\r\n\r\n                for (var prop in d) {\r\n                    if (!d.hasOwnProperty(prop)) continue;\r\n\r\n                    res.push(prop);\r\n                }\r\n            }\r\n        }\r\n        if (!includeGroup) {\r\n            var index = res.indexOf(groupKey);\r\n            if (index > -1) {\r\n                res.splice(index, 1);\r\n            }\r\n        }\r\n        return res\r\n    };\r\n\r\n    static isObjectNotArray(item) {\r\n        return (item && typeof item === 'object' && !Array.isArray(item) && item !== null);\r\n    };\r\n\r\n    static isObject(a) {\r\n        return a !== null && typeof a === 'object';\r\n    };\r\n\r\n    static isNumber(a) {\r\n        return !isNaN(a) && typeof a === 'number';\r\n    };\r\n\r\n    static isFunction(a) {\r\n        return typeof a === 'function';\r\n    };\r\n\r\n    static insertOrAppendSelector(parent, selector, operation, before) {\r\n        var selectorParts = selector.split(/([\\.\\#])/);\r\n        var element = parent[operation](selectorParts.shift(), before);//\":first-child\"\r\n        while (selectorParts.length > 1) {\r\n            var selectorModifier = selectorParts.shift();\r\n            var selectorItem = selectorParts.shift();\r\n            if (selectorModifier === \".\") {\r\n                element = element.classed(selectorItem, true);\r\n            } else if (selectorModifier === \"#\") {\r\n                element = element.attr('id', selectorItem);\r\n            }\r\n        }\r\n        return element;\r\n    }\r\n\r\n    static insertSelector(parent, selector, before) {\r\n        return Utils.insertOrAppendSelector(parent, selector, \"insert\", before);\r\n    }\r\n\r\n    static appendSelector(parent, selector) {\r\n        return Utils.insertOrAppendSelector(parent, selector, \"append\");\r\n    }\r\n\r\n    static selectOrAppend(parent, selector, element) {\r\n        var selection = parent.select(selector);\r\n        if (selection.empty()) {\r\n            if (element) {\r\n                return parent.append(element);\r\n            }\r\n            return Utils.appendSelector(parent, selector);\r\n\r\n        }\r\n        return selection;\r\n    };\r\n\r\n    static selectOrInsert(parent, selector, before) {\r\n        var selection = parent.select(selector);\r\n        if (selection.empty()) {\r\n            return Utils.insertSelector(parent, selector, before);\r\n        }\r\n        return selection;\r\n    };\r\n\r\n    static linearGradient(svg, gradientId, range, x1, y1, x2, y2) {\r\n        var defs = Utils.selectOrAppend(svg, \"defs\");\r\n        var linearGradient = defs.append(\"linearGradient\")\r\n            .attr(\"id\", gradientId);\r\n\r\n        linearGradient\r\n            .attr(\"x1\", x1 + \"%\")\r\n            .attr(\"y1\", y1 + \"%\")\r\n            .attr(\"x2\", x2 + \"%\")\r\n            .attr(\"y2\", y2 + \"%\");\r\n\r\n        //Append multiple color stops by using D3's data/enter step\r\n        var stops = linearGradient.selectAll(\"stop\")\r\n            .data(range);\r\n\r\n        stops.enter().append(\"stop\");\r\n\r\n        stops.attr(\"offset\", (d, i) => i / (range.length - 1))\r\n            .attr(\"stop-color\", d => d);\r\n\r\n        stops.exit().remove();\r\n    }\r\n\r\n    static sanitizeHeight = function (height, container) {\r\n        return (height || parseInt(container.style('height'), 10) || 400);\r\n    };\r\n    \r\n    static sanitizeWidth = function (width, container) {\r\n        return (width || parseInt(container.style('width'), 10) || 960);\r\n    };\r\n\r\n    static availableHeight = function (height, container, margin) {\r\n        return Math.max(0, Utils.sanitizeHeight(height, container) - margin.top - margin.bottom);\r\n    };\r\n\r\n    static availableWidth = function (width, container, margin) {\r\n        return Math.max(0, Utils.sanitizeWidth(width, container) - margin.left - margin.right);\r\n    };\r\n}\r\n"],"sourceRoot":"/source/"}