!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ODCD3=t()}}(function(){return function t(e,i,r){function n(o,l){if(!i[o]){if(!e[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return n(i?i:t)},u,u.exports,t,e,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){"use strict";function r(t){return 0===t.length?NaN:n(t)/t.length}var n=t("./sum");e.exports=r},{"./sum":6}],2:[function(t,e,i){"use strict";function r(t,e){var i=n(t,e),r=a(t),o=a(e);return i/r/o}var n=t("./sample_covariance"),a=t("./sample_standard_deviation");e.exports=r},{"./sample_covariance":3,"./sample_standard_deviation":4}],3:[function(t,e,i){"use strict";function r(t,e){if(t.length<=1||t.length!==e.length)return NaN;for(var i=n(t),r=n(e),a=0,o=0;o<t.length;o++)a+=(t[o]-i)*(e[o]-r);var l=t.length-1;return a/l}var n=t("./mean");e.exports=r},{"./mean":1}],4:[function(t,e,i){"use strict";function r(t){var e=n(t);return isNaN(e)?NaN:Math.sqrt(e)}var n=t("./sample_variance");e.exports=r},{"./sample_variance":5}],5:[function(t,e,i){"use strict";function r(t){if(t.length<=1)return NaN;var e=n(t,2),i=t.length-1;return e/i}var n=t("./sum_nth_power_deviations");e.exports=r},{"./sum_nth_power_deviations":7}],6:[function(t,e,i){"use strict";function r(t){for(var e,i,r=0,n=0,a=0;a<t.length;a++)e=t[a]-n,i=r+e,n=i-r-e,r=i;return r}e.exports=r},{}],7:[function(t,e,i){"use strict";function r(t,e){for(var i=n(t),r=0,a=0;a<t.length;a++)r+=Math.pow(t[a]-i,e);return r}var n=t("./mean");e.exports=r},{"./mean":1}],8:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Chart=i.ChartConfig=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./utils"),o=i.ChartConfig=function l(t){r(this,l),this.cssClassPrefix="odc-",this.svgClass=this.cssClassPrefix+"mw-d3-chart",this.width=void 0,this.height=void 0,this.margin={left:50,right:30,top:30,bottom:50},this.tooltip=!1,t&&a.Utils.deepExtend(this,t)};i.Chart=function(){function t(e,i,n){r(this,t),this.utils=a.Utils,this.plot={margin:{}},this._attached={},this._layers={},this._events={},this._isInitialized=!1,this._isAttached=e instanceof t,this.baseContainer=e,this.setConfig(n),i&&this.setData(i),this.init(),this.postInit()}return n(t,[{key:"setConfig",value:function(t){return t?this.config=t:this.config=new o,this}},{key:"setData",value:function(t){return this.data=t,this}},{key:"init",value:function(){var t=this;return t.initPlot(),t.initSvg(),t.initTooltip(),t.draw(),this._isInitialized=!0,this}},{key:"postInit",value:function(){}},{key:"initSvg",value:function(){var t=this,e=this.config,i=t.plot.width+e.margin.left+e.margin.right,r=t.plot.height+e.margin.top+e.margin.bottom;t._isAttached?(t.svg=t.baseContainer.svg,t.svgG=t.svg.selectOrAppend("g.main-group."+e.svgClass)):(this._isInitialized||d3.select(t.baseContainer).select("svg").remove(),t.svg=d3.select(t.baseContainer).selectOrAppend("svg"),t.svg.attr("width",i).attr("height",r).attr("viewBox","0 0  "+i+" "+r).attr("preserveAspectRatio","xMidYMid meet").attr("class",e.svgClass),t.svgG=t.svg.selectOrAppend("g.main-group")),t.svgG.attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.width&&!e.height||d3.select(window).on("resize",function(){})}},{key:"initTooltip",value:function(){var t=this;t.config.tooltip&&(t._isAttached?t.plot.tooltip=t.baseContainer.plot.tooltip:t.plot.tooltip=d3.select(t.baseContainer).selectOrAppend("div."+t.config.cssClassPrefix+"tooltip").style("opacity",0))}},{key:"initPlot",value:function(){}},{key:"update",value:function(t){t&&this.setData(t);var e;for(var i in this._attached)e=t,this._attached[i].update(e);return this}},{key:"draw",value:function(t){return this.update(t),this}},{key:"attach",value:function(t,e){return 1===arguments.length?this._attached[t]:(this._attached[t]=e,e)}},{key:"on",value:function(t,e,i){var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:i||this,_chart:this}),this}},{key:"once",value:function e(t,i,r){var n=this,e=function a(){n.off(t,a),i.apply(this,arguments)};return this.on(t,e,r)}},{key:"off",value:function(t,e,i){var r,n,a,o,l,s;if(0===arguments.length){for(t in this._events)this._events[t].length=0;return this}if(1===arguments.length)return a=this._events[t],a&&(a.length=0),this;for(r=t?[t]:Object.keys(this._events),l=0;l<r.length;l++)for(n=r[l],a=this._events[n],s=a.length;s--;)o=a[s],(e&&e===o.callback||i&&i===o.context)&&a.splice(s,1);return this}},{key:"trigger",value:function(t){var e,i,r=Array.prototype.slice.call(arguments,1),n=this._events[t];if(void 0!==n)for(e=0;e<n.length;e++)i=n[e],i.callback.apply(i.context,r);return this}},{key:"getBaseContainerNode",value:function(){return this._isAttached?this.baseContainer.svg.node():d3.select(this.baseContainer).node()}},{key:"prefixClass",value:function(t,e){return e?".":""+this.config.cssClassPrefix+t}}]),t}()},{"./utils":16}],9:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0}),i.CorrelationMatrix=i.CorrelationMatrixConfig=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=function d(t,e,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var n=Object.getPrototypeOf(t);return null===n?void 0:d(n,e,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},s=t("./chart"),c=t("./utils"),u=t("./statistics-utils"),f=t("./legend"),p=t("./scatterplot"),h=i.CorrelationMatrixConfig=function(t){function e(t){r(this,e);var i=n(this,Object.getPrototypeOf(e).call(this));return i.svgClass="odc-correlation-matrix",i.guides=!1,i.tooltip=!0,i.legend=!0,i.highlightLabels=!0,i.variables={labels:void 0,keys:[],value:function(t,e){return t[e]},scale:"ordinal"},i.correlation={scale:"linear",domain:[-1,-.75,-.5,0,.5,.75,1],range:["darkblue","blue","lightskyblue","white","orangered","crimson","darkred"],value:function(t,e){return u.StatisticsUtils.sampleCorrelation(t,e)}},i.cell={shape:"ellipse",size:void 0,sizeMin:5,sizeMax:80,padding:1},i.margin={left:60,right:50,top:30,bottom:60},t&&c.Utils.deepExtend(i,t),i}return a(e,t),e}(s.ChartConfig);i.CorrelationMatrix=function(t){function e(t,i,a){return r(this,e),n(this,Object.getPrototypeOf(e).call(this,t,i,new h(a)))}return a(e,t),o(e,[{key:"setConfig",value:function(t){return l(Object.getPrototypeOf(e.prototype),"setConfig",this).call(this,new h(t))}},{key:"initPlot",value:function(){var t=this.config.margin,e=this.config;this.plot={x:{},correlation:{matrix:void 0,cells:void 0,color:{},shape:{}}},this.setupVariables();var i=e.width,r=this.getBaseContainerNode();this.plot.placeholderNode=r;var n=r.getBoundingClientRect().width;i?this.plot.cellSize||(this.plot.cellSize=Math.max(e.cell.sizeMin,Math.min(e.cell.sizeMax,(i-t.left-t.right)/this.plot.variables.length))):(this.plot.cellSize=this.config.cell.size,this.plot.cellSize||(this.plot.cellSize=Math.max(e.cell.sizeMin,Math.min(e.cell.sizeMax,n/this.plot.variables.length))),i=this.plot.cellSize*this.plot.variables.length+t.left+t.right);var a=i;return a||(a=r.getBoundingClientRect().height),this.plot.width=i-t.left-t.right,this.plot.height=this.plot.width,this.setupVariablesScales(),this.setupCorrelationScales(),this.setupCorrelationMatrix(),this}},{key:"setupVariablesScales",value:function(){var t=this.plot,e=t.x,i=this.config.variables;e.value=i.value,e.scale=d3.scale[i.scale]().rangeBands([t.width,0]),e.map=function(t){return e.scale(e.value(t))}}},{key:"setupCorrelationScales",value:function(){var t=this.plot,e=this.config.correlation;t.correlation.color.scale=d3.scale[e.scale]().domain(e.domain).range(e.range);var i=t.correlation.shape={},r=this.config.cell;i.type=r.shape;var n=t.cellSize-2*r.padding;if("circle"==i.type){var a=n/2;i.radiusScale=d3.scale.linear().domain([0,1]).range([2,a]),i.radius=function(t){return i.radiusScale(Math.abs(t.value))}}else if("ellipse"==i.type){var a=n/2;i.radiusScale=d3.scale.linear().domain([0,1]).range([a,2]),i.radiusX=function(t){return i.radiusScale(Math.abs(t.value))},i.radiusY=a,i.rotateVal=function(t){return 0==t?"0":t<0?"-45":"45"}}else"rect"==i.type&&(i.size=n)}},{key:"setupVariables",value:function(){var t=this.config.variables,e=this.data,i=this.plot;i.domainByVariable={},i.variables=t.keys,i.variables&&i.variables.length||(i.variables=c.Utils.inferVariables(e,this.config.groups.key,this.config.includeInPlot)),i.labels=[],i.labelByVariable={},i.variables.forEach(function(r,n){i.domainByVariable[r]=d3.extent(e,function(e){return t.value(e,r)});var a=r;t.labels&&t.labels.length>n&&(a=t.labels[n]),i.labels.push(a),i.labelByVariable[r]=a})}},{key:"setupCorrelationMatrix",value:function(){var t=this,e=this.data,i=this.plot.correlation.matrix=[],r=this.plot.correlation.matrix.cells=[],n=this.plot,a={};n.variables.forEach(function(t,i){a[t]=e.map(function(e){return n.x.value(e,t)})}),n.variables.forEach(function(e,o){var l=[];i.push(l),n.variables.forEach(function(i,n){var s=1;e!=i&&(s=t.config.correlation.value(a[e],a[i]));var c={rowVar:e,colVar:i,row:o,col:n,value:s};l.push(c),r.push(c)})})}},{key:"update",value:function(t){l(Object.getPrototypeOf(e.prototype),"update",this).call(this,t),this.updateCells(),this.updateVariableLabels(),this.config.legend&&this.updateLegend()}},{key:"updateVariableLabels",value:function(){var t=this,e=t.plot,i=t.prefixClass("label"),r=i+"-x",n=i+"-y";e.labelClass=i;var a=t.svgG.selectAll("text."+r).data(e.variables,function(t,e){return e});a.enter().append("text").attr("class",function(t,e){return i+" "+r+" "+r+"-"+e}),a.attr("x",function(t,i){return i*e.cellSize+e.cellSize/2}).attr("y",e.height).attr("dx",-2).attr("transform",function(t,i){return"rotate(-90, "+(i*e.cellSize+e.cellSize/2)+", "+e.height+")"}).attr("text-anchor","end").text(function(t){return e.labelByVariable[t]}),a.exit().remove();var o=t.svgG.selectAll("text."+n).data(e.variables);o.enter().append("text"),o.attr("x",0).attr("y",function(t,i){return i*e.cellSize+e.cellSize/2}).attr("dx",-2).attr("text-anchor","end").attr("class",function(t,e){return i+" "+n+" "+n+"-"+e}).text(function(t){return e.labelByVariable[t]}),o.exit().remove()}},{key:"updateCells",value:function(){var t=this,e=t.plot,i=t.prefixClass("cell"),r=e.correlation.shape.type,n=t.svgG.selectAll("g."+i).data(e.correlation.matrix.cells);n.enter().append("g").classed(i,!0);n.attr("transform",function(t){return"translate("+(e.cellSize*t.col+e.cellSize/2)+","+(e.cellSize*t.row+e.cellSize/2)+")"}),n.classed(t.config.cssClassPrefix+"selectable",!!t.scatterPlot);var a="*:not(.cell-shape-"+r+")",o=n.selectAll(a);o.remove();var l=n.selectOrAppend(r+".cell-shape-"+r);"circle"==e.correlation.shape.type&&l.attr("r",e.correlation.shape.radius).attr("cx",0).attr("cy",0),"ellipse"==e.correlation.shape.type&&l.attr("rx",e.correlation.shape.radiusX).attr("ry",e.correlation.shape.radiusY).attr("cx",0).attr("cy",0).attr("transform",function(t){return"rotate("+e.correlation.shape.rotateVal(t.value)+")"}),"rect"==e.correlation.shape.type&&l.attr("width",e.correlation.shape.size).attr("height",e.correlation.shape.size).attr("x",-e.cellSize/2).attr("y",-e.cellSize/2),l.style("fill",function(t){return e.correlation.color.scale(t.value)});var s=[],c=[];if(e.tooltip&&(s.push(function(t){e.tooltip.transition().duration(200).style("opacity",.9);var i=t.value;e.tooltip.html(i).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px")}),c.push(function(t){e.tooltip.transition().duration(500).style("opacity",0)})),t.config.highlightLabels){var u=t.config.cssClassPrefix+"highlight",f=function(t){return e.labelClass+"-x-"+t.col},p=function(t){return e.labelClass+"-y-"+t.row};s.push(function(e){t.svgG.selectAll("text."+f(e)).classed(u,!0),t.svgG.selectAll("text."+p(e)).classed(u,!0)}),c.push(function(e){t.svgG.selectAll("text."+f(e)).classed(u,!1),t.svgG.selectAll("text."+p(e)).classed(u,!1)})}n.on("mouseover",function(t){s.forEach(function(e){return e(t)})}).on("mouseout",function(t){c.forEach(function(e){return e(t)})}),n.on("click",function(e){t.trigger("cell-selected",e)}),n.exit().remove()}},{key:"updateLegend",value:function(){var t=this.plot,e=this.plot.width+10,i=0,r=10,n=this.plot.height-2,a=t.correlation.color.scale;t.legend=new f.Legend(this.svg,this.svgG,a,e,i).linearGradientBar(r,n)}},{key:"attachScatterPlot",value:function(t,e){var i=this,r=this;e=e||{};var n={height:r.plot.height+r.config.margin.top+r.config.margin.bottom,width:r.plot.height+r.config.margin.top+r.config.margin.bottom,groups:{key:r.config.groups.key,label:r.config.groups.label},guides:!0};r.scatterPlot=!0,n=c.Utils.deepExtend(n,e),this.update(),this.on("cell-selected",function(e){n.x={key:e.rowVar,label:r.plot.labelByVariable[e.rowVar]},n.y={key:e.colVar,label:r.plot.labelByVariable[e.colVar]},r.scatterPlot&&r.scatterPlot!==!0?r.scatterPlot.setConfig(n).init():(r.scatterPlot=new p.ScatterPlot(t,r.data,n),i.attach("ScatterPlot",r.scatterPlot))})}}]),e}(s.Chart)},{"./chart":8,"./legend":12,"./scatterplot":14,"./statistics-utils":15,"./utils":16}],10:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.D3Extensions=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./utils");i.D3Extensions=function(){function t(){r(this,t)}return n(t,null,[{key:"extend",value:function(){d3.selection.enter.prototype.appendSelector=d3.selection.prototype.appendSelector=function(t){return a.Utils.appendSelector(this,t)},d3.selection.enter.prototype.selectOrAppend=d3.selection.prototype.selectOrAppend=function(t){return a.Utils.selectOrAppend(this,t)}}}]),t}()},{"./utils":16}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.StatisticsUtils=i.CorrelationMatrixConfig=i.CorrelationMatrix=i.ScatterPlotMatrixConfig=i.ScatterPlotMatrix=i.ScatterPlotConfig=i.ScatterPlot=void 0;var r=t("./scatterplot");Object.defineProperty(i,"ScatterPlot",{enumerable:!0,get:function(){return r.ScatterPlot}}),Object.defineProperty(i,"ScatterPlotConfig",{enumerable:!0,get:function(){return r.ScatterPlotConfig}});var n=t("./scatterplot-matrix");Object.defineProperty(i,"ScatterPlotMatrix",{enumerable:!0,get:function(){return n.ScatterPlotMatrix}}),Object.defineProperty(i,"ScatterPlotMatrixConfig",{enumerable:!0,get:function(){return n.ScatterPlotMatrixConfig}});var a=t("./correlation-matrix");Object.defineProperty(i,"CorrelationMatrix",{enumerable:!0,get:function(){return a.CorrelationMatrix}}),Object.defineProperty(i,"CorrelationMatrixConfig",{enumerable:!0,get:function(){return a.CorrelationMatrixConfig}});var o=t("./statistics-utils");Object.defineProperty(i,"StatisticsUtils",{enumerable:!0,get:function(){return o.StatisticsUtils}});var l=t("./d3-extensions");l.D3Extensions.extend()},{"./correlation-matrix":9,"./d3-extensions":10,"./scatterplot":14,"./scatterplot-matrix":13,"./statistics-utils":15}],12:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Legend=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("./utils");i.Legend=function(){function t(e,i,n,o,l){r(this,t),this.cssClassPrefix="odc-",this.legendClass=this.cssClassPrefix+"legend",this.scale=n,this.svg=e,this.container=a.Utils.selectOrAppend(i,"g."+this.legendClass,"g").attr("transform","translate("+o+","+l+")").classed(this.legendClass,!0)}return n(t,[{key:"linearGradientBar",value:function(t,e){var i=this.cssClassPrefix+"linear-gradient",r=this.scale;this.linearGradient=a.Utils.linearGradient(this.svg,i,this.scale.range(),0,100,0,0),this.container.append("rect").attr("width",t).attr("height",e).attr("x",0).attr("y",0).style("fill","url(#"+i+")");var n=this.container.selectAll("text").data(r.domain()),o=r.domain().length-1;return n.enter().append("text").attr("x",t).attr("y",function(t,i){return e-i*e/o}).attr("dx",3).attr("alignment-baseline","middle").text(function(t){return t}),n.exit().remove(),this}}]),t}()},{"./utils":16}],13:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0}),i.ScatterPlotMatrix=i.ScatterPlotMatrixConfig=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=function p(t,e,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var n=Object.getPrototypeOf(t);return null===n?void 0:p(n,e,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},s=t("./chart"),c=t("./scatterplot"),u=t("./utils"),f=i.ScatterPlotMatrixConfig=function(t){function e(t){r(this,e);var i=n(this,Object.getPrototypeOf(e).call(this));return i.svgClass=i.cssClassPrefix+"scatterplot-matrix",i.size=200,i.padding=20,i.brush=!0,i.guides=!0,i.tooltip=!0,i.ticks=void 0,i.x={orient:"bottom",scale:"linear"},i.y={orient:"left",scale:"linear"},i.groups={key:void 0,includeInPlot:!1,value:function(t,e){return t[e]},label:""},i.variables={labels:[],keys:[],value:function(t,e){return t[e]}},u.Utils.deepExtend(i,t),i}return a(e,t),e}(c.ScatterPlotConfig);i.ScatterPlotMatrix=function(t){function e(t,i,a){return r(this,e),n(this,Object.getPrototypeOf(e).call(this,t,i,new f(a)))}return a(e,t),o(e,[{key:"setConfig",value:function(t){return l(Object.getPrototypeOf(e.prototype),"setConfig",this).call(this,new f(t))}},{key:"initPlot",value:function(){var t=this,e=this.config.margin,i=this.config;this.plot={x:{},y:{},dot:{color:null}},this.setupVariables(),this.plot.size=i.size;var r=i.width,n=this.getBaseContainerNode().getBoundingClientRect();if(!r){var a=e.left+e.right+this.plot.variables.length*this.plot.size;r=Math.min(n.width,a)}var o=r;o||(o=n.height),this.plot.width=r-e.left-e.right,this.plot.height=o-e.top-e.bottom,void 0===i.ticks&&(i.ticks=this.plot.size/40),this.setupX(),this.setupY(),i.dot.d3ColorCategory&&(this.plot.dot.colorCategory=d3.scale[i.dot.d3ColorCategory]());var l=i.dot.color;return l&&(this.plot.dot.colorValue=l,"string"==typeof l||l instanceof String?this.plot.dot.color=l:this.plot.dot.colorCategory&&(this.plot.dot.color=function(e){return t.plot.dot.colorCategory(t.plot.dot.colorValue(e))})),this}},{key:"setupVariables",value:function(){var t=this.config.variables,e=this.data,i=this.plot;i.domainByVariable={},i.variables=t.keys,i.variables&&i.variables.length||(i.variables=u.Utils.inferVariables(e,this.config.groups.key,this.config.includeInPlot)),i.labels=[],i.labelByVariable={},i.variables.forEach(function(r,n){i.domainByVariable[r]=d3.extent(e,function(e){return t.value(e,r)});var a=r;t.labels&&t.labels.length>n&&(a=t.labels[n]),i.labels.push(a),i.labelByVariable[r]=a}),i.subplots=[]}},{key:"setupX",value:function(){var t=this.plot,e=t.x,i=this.config;e.value=i.variables.value,e.scale=d3.scale[i.x.scale]().range([i.padding/2,t.size-i.padding/2]),e.map=function(t,i){return e.scale(e.value(t,i))},e.axis=d3.svg.axis().scale(e.scale).orient(i.x.orient).ticks(i.ticks),e.axis.tickSize(t.size*t.variables.length)}},{key:"setupY",value:function(){var t=this.plot,e=t.y,i=this.config;e.value=i.variables.value,e.scale=d3.scale[i.y.scale]().range([t.size-i.padding/2,i.padding/2]),e.map=function(t,i){return e.scale(e.value(t,i))},e.axis=d3.svg.axis().scale(e.scale).orient(i.y.orient).ticks(i.ticks),e.axis.tickSize(-t.size*t.variables.length)}},{key:"draw",value:function(){function t(t){var i=e.plot;i.subplots.push(t);var n=d3.select(this);i.x.scale.domain(i.domainByVariable[t.x]),i.y.scale.domain(i.domainByVariable[t.y]);var a=e.prefixClass("frame");n.append("rect").attr("class",a).attr("x",r.padding/2).attr("y",r.padding/2).attr("width",r.size-r.padding).attr("height",r.size-r.padding),t.update=function(){var t=this,r=n.selectAll("circle").data(e.data);r.enter().append("circle"),r.attr("cx",function(e){return i.x.map(e,t.x)}).attr("cy",function(e){return i.y.map(e,t.y)}).attr("r",e.config.dot.radius),i.dot.color&&r.style("fill",i.dot.color),i.tooltip&&r.on("mouseover",function(r){i.tooltip.transition().duration(200).style("opacity",.9);var n="("+i.x.value(r,t.x)+", "+i.y.value(r,t.y)+")";i.tooltip.html(n).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px");var a=e.config.groups.value(r);if(a||0===a){n+="<br/>";var o=e.config.groups.label;o&&(n+=o+": "),n+=a}i.tooltip.html(n).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){i.tooltip.transition().duration(500).style("opacity",0)}),r.exit().remove()},t.update()}var e=this,i=e.plot.variables.length,r=this.config,n=e.prefixClass("axis"),a=n+"-x",o=n+"-y",l="g."+a+"."+n,s="g."+o+"."+n,c=e.prefixClass("no-guides");e.svgG.selectAll(l).data(e.plot.variables).enter().appendSelector(l).classed(c,!r.guides).attr("transform",function(t,r){return"translate("+(i-r-1)*e.plot.size+",0)"}).each(function(t){e.plot.x.scale.domain(e.plot.domainByVariable[t]),d3.select(this).call(e.plot.x.axis)}),e.svgG.selectAll(s).data(e.plot.variables).enter().appendSelector(s).classed(c,!r.guides).attr("transform",function(t,i){return"translate(0,"+i*e.plot.size+")"}).each(function(t){e.plot.y.scale.domain(e.plot.domainByVariable[t]),d3.select(this).call(e.plot.y.axis)});var u=e.prefixClass("cell"),f=e.svgG.selectAll("."+u).data(e.utils.cross(e.plot.variables,e.plot.variables)).enter().appendSelector("g."+u).attr("transform",function(t){return"translate("+(i-t.i-1)*e.plot.size+","+t.j*e.plot.size+")"});r.brush&&this.drawBrush(f),f.each(t),f.filter(function(t){return t.i===t.j}).append("text").attr("x",r.padding).attr("y",r.padding).attr("dy",".71em").text(function(t){return e.plot.labelByVariable[t.x]})}},{key:"update",value:function(){this.plot.subplots.forEach(function(t){t.update()})}},{key:"drawBrush",value:function(t){function e(t){o!==this&&(d3.select(o).call(a.clear()),n.plot.x.scale.domain(n.plot.domainByVariable[t.x]),n.plot.y.scale.domain(n.plot.domainByVariable[t.y]),o=this)}function i(t){var e=a.extent();n.svgG.selectAll("circle").classed("hidden",function(i){return e[0][0]>i[t.x]||i[t.x]>e[1][0]||e[0][1]>i[t.y]||i[t.y]>e[1][1]})}function r(){a.empty()&&n.svgG.selectAll(".hidden").classed("hidden",!1)}var n=this,a=d3.svg.brush().x(n.plot.x.scale).y(n.plot.y.scale).on("brushstart",e).on("brush",i).on("brushend",r);t.append("g").call(a);var o}}]),e}(s.Chart)},{"./chart":8,"./scatterplot":14,"./utils":16}],14:[function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0}),i.ScatterPlot=i.ScatterPlotConfig=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=function f(t,e,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var n=Object.getPrototypeOf(t);return null===n?void 0:f(n,e,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},s=t("./chart"),c=t("./utils"),u=i.ScatterPlotConfig=function(t){function e(t){r(this,e);var i=n(this,Object.getPrototypeOf(e).call(this));i.svgClass=i.cssClassPrefix+"scatterplot",i.guides=!1,i.tooltip=!0,i.x={label:"X",key:0,value:function(t,e){return t[e]},orient:"bottom",scale:"linear"},i.y={label:"Y",key:1,value:function(t,e){return t[e]},orient:"left",scale:"linear"},i.groups={key:2,value:function(t,e){return t[e]},label:""};var a=i;return i.dot={radius:2,color:function(t){return a.groups.value(t,a.groups.key)},d3ColorCategory:"category10"},t&&c.Utils.deepExtend(i,t),i}return a(e,t),e}(s.ChartConfig);i.ScatterPlot=function(t){function e(t,i,a){return r(this,e),n(this,Object.getPrototypeOf(e).call(this,t,i,new u(a)))}return a(e,t),o(e,[{key:"setConfig",value:function(t){return l(Object.getPrototypeOf(e.prototype),"setConfig",this).call(this,new u(t))}},{key:"initPlot",value:function(){var t=this,e=this.config.margin,i=this.config;this.plot={x:{},y:{},dot:{color:null}};var r=i.width,n=this.getBaseContainerNode();r||(r=n.getBoundingClientRect().width);var a=i.height;a||(a=n.getBoundingClientRect().height),this.plot.width=r-e.left-e.right,this.plot.height=a-e.top-e.bottom,this.setupX(),this.setupY(),i.dot.d3ColorCategory&&(this.plot.dot.colorCategory=d3.scale[i.dot.d3ColorCategory]());var o=i.dot.color;return o&&(this.plot.dot.colorValue=o,"string"==typeof o||o instanceof String?this.plot.dot.color=o:this.plot.dot.colorCategory&&(this.plot.dot.color=function(e){return t.plot.dot.colorCategory(t.plot.dot.colorValue(e))})),this}},{key:"setupX",value:function(){var t=this.plot,e=t.x,i=this.config.x;e.value=function(t){return i.value(t,i.key)},e.scale=d3.scale[i.scale]().range([0,t.width]),e.map=function(t){return e.scale(e.value(t))},e.axis=d3.svg.axis().scale(e.scale).orient(i.orient);var r=this.data;t.x.scale.domain([d3.min(r,t.x.value)-1,d3.max(r,t.x.value)+1]),this.config.guides&&e.axis.tickSize(-t.height)}},{key:"setupY",value:function(){var t=this.plot,e=t.y,i=this.config.y;e.value=function(t){return i.value(t,i.key)},e.scale=d3.scale[i.scale]().range([t.height,0]),e.map=function(t){return e.scale(e.value(t))},e.axis=d3.svg.axis().scale(e.scale).orient(i.orient),this.config.guides&&e.axis.tickSize(-t.width);var r=this.data;t.y.scale.domain([d3.min(r,t.y.value)-1,d3.max(r,t.y.value)+1])}},{key:"draw",value:function(){this.drawAxisX(),this.drawAxisY(),this.update()}},{key:"drawAxisX",value:function(){var t=this,e=t.plot,i=this.config.x;t.svgG.selectOrAppend("g."+t.prefixClass("axis-x")+"."+t.prefixClass("axis")+(t.config.guides?"":"."+t.prefixClass("no-guides"))).attr("transform","translate(0,"+e.height+")").call(e.x.axis).selectOrAppend("text."+t.prefixClass("label")).attr("transform","translate("+e.width/2+","+t.config.margin.bottom+")").attr("dy","-1em").style("text-anchor","middle").text(i.label)}},{key:"drawAxisY",value:function(){var t=this,e=t.plot,i=this.config.y;t.svgG.selectOrAppend("g."+t.prefixClass("axis-y")+"."+t.prefixClass("axis")+(t.config.guides?"":"."+t.prefixClass("no-guides"))).call(e.y.axis).selectOrAppend("text."+t.prefixClass("label")).attr("transform","translate("+-t.config.margin.left+","+e.height/2+")rotate(-90)").attr("dy","1em").style("text-anchor","middle").text(i.label)}},{key:"update",value:function(t){var e=this,i=e.plot,r=this.data,n=e.prefixClass("dot"),a=e.svgG.selectAll("."+n).data(r);a.enter().append("circle").attr("class",n),a.attr("r",e.config.dot.radius).attr("cx",i.x.map).attr("cy",i.y.map),i.tooltip&&a.on("mouseover",function(t){i.tooltip.transition().duration(200).style("opacity",.9);var r="("+i.x.value(t)+", "+i.y.value(t)+")",n=e.config.groups.value(t,e.config.groups.key);if(n||0===n){r+="<br/>";var a=e.config.groups.label;a&&(r+=a+": "),r+=n}i.tooltip.html(r).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){i.tooltip.transition().duration(500).style("opacity",0)}),i.dot.color&&a.style("fill",i.dot.color),a.exit().remove()}}]),e}(s.Chart)},{"./chart":8,"./utils":16}],15:[function(t,e,i){"use strict";var r=e.exports.StatisticsUtils={};r.sampleCorrelation=t("../bower_components/simple-statistics/src/sample_correlation")},{"../bower_components/simple-statistics/src/sample_correlation":2}],16:[function(t,e,i){"use strict";function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();i.Utils=function(){function t(){n(this,t)}return o(t,null,[{key:"deepExtend",value:function(t){var e=this;!t&&arguments.length>1&&Array.isArray(arguments[1])&&(t=[]),t=t||{};for(var i=1;i<arguments.length;i++){var r=arguments[i];if(r)for(var n in r)if(r.hasOwnProperty(n)){var a=Array.isArray(t[n]),o=e.isObject(t[n]),l=e.isObject(r[n]);o&&!a&&l?e.deepExtend(t[n],r[n]):t[n]=r[n]}}return t}},{key:"mergeDeep",value:function(e,i){var n=Object.assign({},e);return t.isObjectNotArray(e)&&t.isObjectNotArray(i)&&Object.keys(i).forEach(function(a){t.isObjectNotArray(i[a])&&a in e?n[a]=t.mergeDeep(e[a],i[a]):Object.assign(n,r({},a,i[a]))}),n}},{key:"cross",value:function(t,e){var i,r,n=[],a=t.length,o=e.length;for(i=-1;++i<a;)for(r=-1;++r<o;)n.push({x:t[i],i:i,y:e[r],j:r});return n}},{key:"inferVariables",value:function(t,e,i){
var r=[];if(t.length){var n=t[0];if(n instanceof Array)r=n.map(function(t,e){return e});else if("object"===("undefined"==typeof n?"undefined":a(n)))for(var o in n)n.hasOwnProperty(o)&&r.push(o)}if(!i){var l=r.indexOf(e);l>-1&&r.splice(l,1)}return r}},{key:"isObjectNotArray",value:function(t){return t&&"object"===("undefined"==typeof t?"undefined":a(t))&&!Array.isArray(t)&&null!==t}},{key:"isObject",value:function(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":a(t))}},{key:"isNumber",value:function(t){return!isNaN(t)&&"number"==typeof t}},{key:"isFunction",value:function(t){return"function"==typeof t}},{key:"appendSelector",value:function(t,e){for(var i=e.split(/([\.\#])/),r=t.append(i.shift());i.length>1;){var n=i.shift(),a=i.shift();"."===n?r=r.classed(a,!0):"#"===n&&(r=r.attr("id",a))}return r}},{key:"selectOrAppend",value:function(e,i,r){var n=e.select(i);return n.empty()?r?e.append(r):t.appendSelector(e,i):n}},{key:"linearGradient",value:function e(i,r,n,a,o,l,s){var c=t.selectOrAppend(i,"defs"),e=c.append("linearGradient").attr("id",r);e.attr("x1",a+"%").attr("y1",o+"%").attr("x2",l+"%").attr("y2",s+"%");var u=e.selectAll("stop").data(n);u.enter().append("stop"),u.attr("offset",function(t,e){return e/(n.length-1)}).attr("stop-color",function(t){return t}),u.exit().remove()}}]),t}()},{}]},{},[11])(11)});
//# sourceMappingURL=odc-d3.min.js.map
