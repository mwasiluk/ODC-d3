!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ODCD3=t()}}(function(){return function t(e,i,o){function n(a,l){if(!i[a]){if(!e[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){var i=e[a][1][t];return n(i?i:t)},u,u.exports,t,e,i,o)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Chart=i.ChartConfig=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=t("./utils"),a=i.ChartConfig=function l(t){o(this,l),this.cssClassPrefix="odc-",this.svgClass="mw-d3-chart",this.width=void 0,this.height=void 0,this.margin={left:50,right:30,top:30,bottom:50},this.tooltip=!1,t&&r.Utils.deepExtend(this,t)};i.Chart=function(){function t(e,i,n){o(this,t),this.utils=r.Utils,this.placeholderSelector=e,this.svg=null,this.config=void 0,this.plot={margin:{}},this.setConfig(n),i&&this.setData(i),this.init()}return n(t,[{key:"setConfig",value:function(t){return t?this.config=t:this.config=new a,this}},{key:"setData",value:function(t){return this.data=t,this}},{key:"init",value:function(){var t=this;t.initPlot(),t.initSvg(),t.draw()}},{key:"initSvg",value:function(){var t=this,e=this.config,i=t.plot.width+e.margin.left+e.margin.right,o=t.plot.height+e.margin.top+e.margin.bottom;t.svg=d3.select(t.placeholderSelector).select("svg"),t.svg.empty()||t.svg.remove(),t.svg=d3.select(t.placeholderSelector).append("svg"),t.svg.attr("width",i).attr("height",o).attr("viewBox","0 0  "+i+" "+o).attr("preserveAspectRatio","xMidYMid meet").attr("class",e.svgClass),t.svgG=t.svg.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.tooltip&&(t.plot.tooltip=this.utils.selectOrAppend(d3.select(t.placeholderSelector),"div.mw-tooltip","div").attr("class","mw-tooltip").style("opacity",0)),e.width&&!e.height||d3.select(window).on("resize",function(){})}},{key:"initPlot",value:function(){}},{key:"update",value:function(t){t&&this.setData(t)}},{key:"draw",value:function(){this.update()}}]),t}()},{"./utils":5}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./scatterplot");Object.defineProperty(i,"ScatterPlot",{enumerable:!0,get:function(){return o.ScatterPlot}}),Object.defineProperty(i,"ScatterPlotConfig",{enumerable:!0,get:function(){return o.ScatterPlotConfig}});var n=t("./scatterplot-matrix");Object.defineProperty(i,"ScatterPlotMatrix",{enumerable:!0,get:function(){return n.ScatterPlotMatrix}}),Object.defineProperty(i,"ScatterPlotMatrixConfig",{enumerable:!0,get:function(){return n.ScatterPlotMatrixConfig}})},{"./scatterplot":4,"./scatterplot-matrix":3}],3:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0}),i.ScatterPlotMatrix=i.ScatterPlotMatrixConfig=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),l=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:p(n,e,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)},s=t("./chart"),c=t("./scatterplot"),u=t("./utils"),f=i.ScatterPlotMatrixConfig=function(t){function e(t){o(this,e);var i=n(this,Object.getPrototypeOf(e).call(this));return i.svgClass="mw-d3-scatterplot-matrix",i.size=200,i.padding=20,i.brush=!0,i.guides=!0,i.tooltip=!0,i.ticks=void 0,i.x={orient:"bottom",scale:"linear"},i.y={orient:"left",scale:"linear"},i.groups={key:void 0,includeInPlot:!1,value:function(t,e){return t[e]},label:""},i.variables={labels:[],keys:[],value:function(t,e){return t[e]}},u.Utils.deepExtend(i,t),i}return r(e,t),e}(c.ScatterPlotConfig);i.ScatterPlotMatrix=function(t){function e(t,i,r){return o(this,e),n(this,Object.getPrototypeOf(e).call(this,t,i,new f(r)))}return r(e,t),a(e,[{key:"setConfig",value:function(t){return l(Object.getPrototypeOf(e.prototype),"setConfig",this).call(this,new f(t))}},{key:"initPlot",value:function(){var t=this,e=this.config.margin,i=this.config;this.plot={x:{},y:{},dot:{color:null}},this.setupVariables(),this.plot.size=i.size;var o=i.width,n=d3.select(this.placeholderSelector).node();if(!o){var r=e.left+e.right+this.plot.variables.length*this.plot.size;o=Math.min(n.getBoundingClientRect().width,r)}var a=o;a||(a=n.getBoundingClientRect().height),this.plot.width=o-e.left-e.right,this.plot.height=a-e.top-e.bottom,void 0===i.ticks&&(i.ticks=this.plot.size/40),this.setupX(),this.setupY(),i.dot.d3ColorCategory&&(this.plot.dot.colorCategory=d3.scale[i.dot.d3ColorCategory]());var l=i.dot.color;return l&&(this.plot.dot.colorValue=l,"string"==typeof l||l instanceof String?this.plot.dot.color=l:this.plot.dot.colorCategory&&(this.plot.dot.color=function(e){return t.plot.dot.colorCategory(t.plot.dot.colorValue(e))})),this}},{key:"setupVariables",value:function(){var t=this.config.variables,e=this.data,i=this.plot;i.domainByVariable={},i.variables=t.keys,i.variables&&i.variables.length||(i.variables=u.Utils.inferVariables(e,this.config.groups.key,this.config.includeInPlot)),i.labels=[],i.labelByVariable={},i.variables.forEach(function(o,n){i.domainByVariable[o]=d3.extent(e,function(e){return t.value(e,o)});var r=o;t.labels&&t.labels.length>n&&(r=t.labels[n]),i.labels.push(r),i.labelByVariable[o]=r}),i.subplots=[]}},{key:"setupX",value:function(){var t=this.plot,e=t.x,i=this.config;e.value=i.variables.value,e.scale=d3.scale[i.x.scale]().range([i.padding/2,t.size-i.padding/2]),e.map=function(t,i){return e.scale(e.value(t,i))},e.axis=d3.svg.axis().scale(e.scale).orient(i.x.orient).ticks(i.ticks),e.axis.tickSize(t.size*t.variables.length)}},{key:"setupY",value:function(){var t=this.plot,e=t.y,i=this.config;e.value=i.variables.value,e.scale=d3.scale[i.y.scale]().range([t.size-i.padding/2,i.padding/2]),e.map=function(t,i){return e.scale(e.value(t,i))},e.axis=d3.svg.axis().scale(e.scale).orient(i.y.orient).ticks(i.ticks),e.axis.tickSize(-t.size*t.variables.length)}},{key:"draw",value:function(){function t(t){var i=e.plot;i.subplots.push(t);var n=d3.select(this);i.x.scale.domain(i.domainByVariable[t.x]),i.y.scale.domain(i.domainByVariable[t.y]),n.append("rect").attr("class","mw-frame").attr("x",o.padding/2).attr("y",o.padding/2).attr("width",o.size-o.padding).attr("height",o.size-o.padding),t.update=function(){var t=this,o=n.selectAll("circle").data(e.data);o.enter().append("circle"),o.attr("cx",function(e){return i.x.map(e,t.x)}).attr("cy",function(e){return i.y.map(e,t.y)}).attr("r",e.config.dot.radius),i.dot.color&&o.style("fill",i.dot.color),i.tooltip&&o.on("mouseover",function(o){i.tooltip.transition().duration(200).style("opacity",.9);var n="("+i.x.value(o,t.x)+", "+i.y.value(o,t.y)+")";i.tooltip.html(n).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px");var r=e.config.groups.value(o);if(r||0===r){n+="<br/>";var a=e.config.groups.label;a&&(n+=a+": "),n+=r}i.tooltip.html(n).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){i.tooltip.transition().duration(500).style("opacity",0)}),o.exit().remove()},t.update()}var e=this,i=e.plot.variables.length,o=this.config;e.svgG.selectAll(".mw-axis-x.mw-axis").data(e.plot.variables).enter().append("g").attr("class","mw-axis-x mw-axis"+(o.guides?"":" mw-no-guides")).attr("transform",function(t,o){return"translate("+(i-o-1)*e.plot.size+",0)"}).each(function(t){e.plot.x.scale.domain(e.plot.domainByVariable[t]),d3.select(this).call(e.plot.x.axis)}),e.svgG.selectAll(".mw-axis-y.mw-axis").data(e.plot.variables).enter().append("g").attr("class","mw-axis-y mw-axis"+(o.guides?"":" mw-no-guides")).attr("transform",function(t,i){return"translate(0,"+i*e.plot.size+")"}).each(function(t){e.plot.y.scale.domain(e.plot.domainByVariable[t]),d3.select(this).call(e.plot.y.axis)}),o.tooltip&&(e.plot.tooltip=this.utils.selectOrAppend(d3.select(e.placeholderSelector),"div.mw-tooltip","div").attr("class","mw-tooltip").style("opacity",0));var n=e.svgG.selectAll(".mw-cell").data(e.utils.cross(e.plot.variables,e.plot.variables)).enter().append("g").attr("class","mw-cell").attr("transform",function(t){return"translate("+(i-t.i-1)*e.plot.size+","+t.j*e.plot.size+")"});o.brush&&this.drawBrush(n),n.each(t),n.filter(function(t){return t.i===t.j}).append("text").attr("x",o.padding).attr("y",o.padding).attr("dy",".71em").text(function(t){return e.plot.labelByVariable[t.x]})}},{key:"update",value:function(){this.plot.subplots.forEach(function(t){t.update()})}},{key:"drawBrush",value:function(t){function e(t){a!==this&&(d3.select(a).call(r.clear()),n.plot.x.scale.domain(n.plot.domainByVariable[t.x]),n.plot.y.scale.domain(n.plot.domainByVariable[t.y]),a=this)}function i(t){var e=r.extent();n.svgG.selectAll("circle").classed("hidden",function(i){return e[0][0]>i[t.x]||i[t.x]>e[1][0]||e[0][1]>i[t.y]||i[t.y]>e[1][1]})}function o(){r.empty()&&n.svgG.selectAll(".hidden").classed("hidden",!1)}var n=this,r=d3.svg.brush().x(n.plot.x.scale).y(n.plot.y.scale).on("brushstart",e).on("brush",i).on("brushend",o);t.append("g").call(r);var a}}]),e}(s.Chart)},{"./chart":1,"./scatterplot":4,"./utils":5}],4:[function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0}),i.ScatterPlot=i.ScatterPlotConfig=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),l=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:f(n,e,i)}if("value"in o)return o.value;var r=o.get;if(void 0!==r)return r.call(i)},s=t("./chart"),c=t("./utils"),u=i.ScatterPlotConfig=function(t){function e(t){o(this,e);var i=n(this,Object.getPrototypeOf(e).call(this));i.svgClass="mw-d3-scatterplot",i.guides=!1,i.tooltip=!0,i.x={label:"X",key:0,value:function(t,e){return t[e]},orient:"bottom",scale:"linear"},i.y={label:"Y",key:1,value:function(t,e){return t[e]},orient:"left",scale:"linear"},i.groups={key:2,value:function(t,e){return t[e]},label:""};var r=i;return i.dot={radius:2,color:function(t){return r.groups.value(t,r.groups.key)},d3ColorCategory:"category10"},t&&c.Utils.deepExtend(i,t),i}return r(e,t),e}(s.ChartConfig);i.ScatterPlot=function(t){function e(t,i,r){return o(this,e),n(this,Object.getPrototypeOf(e).call(this,t,i,new u(r)))}return r(e,t),a(e,[{key:"setConfig",value:function(t){return l(Object.getPrototypeOf(e.prototype),"setConfig",this).call(this,new u(t))}},{key:"initPlot",value:function(){var t=this,e=this.config.margin,i=this.config;this.plot={x:{},y:{},dot:{color:null}};var o=i.width,n=d3.select(this.placeholderSelector).node();o||(o=n.getBoundingClientRect().width);var r=i.height;r||(r=n.getBoundingClientRect().height),this.plot.width=o-e.left-e.right,this.plot.height=r-e.top-e.bottom,this.setupX(),this.setupY(),i.dot.d3ColorCategory&&(this.plot.dot.colorCategory=d3.scale[i.dot.d3ColorCategory]());var a=i.dot.color;return a&&(this.plot.dot.colorValue=a,"string"==typeof a||a instanceof String?this.plot.dot.color=a:this.plot.dot.colorCategory&&(this.plot.dot.color=function(e){return t.plot.dot.colorCategory(t.plot.dot.colorValue(e))})),this}},{key:"setupX",value:function(){var t=this.plot,e=t.x,i=this.config.x;e.value=function(t){return i.value(t,i.key)},e.scale=d3.scale[i.scale]().range([0,t.width]),e.map=function(t){return e.scale(e.value(t))},e.axis=d3.svg.axis().scale(e.scale).orient(i.orient);var o=this.data;t.x.scale.domain([d3.min(o,t.x.value)-1,d3.max(o,t.x.value)+1]),this.config.guides&&e.axis.tickSize(-t.height)}},{key:"setupY",value:function(){var t=this.plot,e=t.y,i=this.config.y;e.value=function(t){return i.value(t,i.key)},e.scale=d3.scale[i.scale]().range([t.height,0]),e.map=function(t){return e.scale(e.value(t))},e.axis=d3.svg.axis().scale(e.scale).orient(i.orient),this.config.guides&&e.axis.tickSize(-t.width);var o=this.data;t.y.scale.domain([d3.min(o,t.y.value)-1,d3.max(o,t.y.value)+1])}},{key:"draw",value:function(){this.drawAxisX(),this.drawAxisY(),this.update()}},{key:"drawAxisX",value:function(){var t=this,e=t.plot,i=this.config.x;t.svgG.append("g").attr("class","mw-axis-x mw-axis"+(t.config.guides?"":" mw-no-guides")).attr("transform","translate(0,"+e.height+")").call(e.x.axis).append("text").attr("class","mw-label").attr("transform","translate("+e.width/2+","+t.config.margin.bottom+")").attr("dy","-1em").style("text-anchor","middle").text(i.label)}},{key:"drawAxisY",value:function(){var t=this,e=t.plot,i=this.config.y;t.svgG.append("g").attr("class","mw-axis mw-axis-y"+(t.config.guides?"":" mw-no-guides")).call(e.y.axis).append("text").attr("class","mw-label").attr("transform","translate("+-t.config.margin.left+","+e.height/2+")rotate(-90)").attr("dy","1em").style("text-anchor","middle").text(i.label)}},{key:"update",value:function(t){var e=this,i=e.plot,o=this.data,n=e.svgG.selectAll(".mw-dot").data(o);n.enter().append("circle").attr("class","mw-dot"),n.attr("r",e.config.dot.radius).attr("cx",i.x.map).attr("cy",i.y.map),i.tooltip&&n.on("mouseover",function(t){i.tooltip.transition().duration(200).style("opacity",.9);var o="("+i.x.value(t)+", "+i.y.value(t)+")",n=e.config.groups.value(t,e.config.groups.key);if(n||0===n){o+="<br/>";var r=e.config.groups.label;r&&(o+=r+": "),o+=n}i.tooltip.html(o).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){i.tooltip.transition().duration(500).style("opacity",0)}),i.dot.color&&n.style("fill",i.dot.color),n.exit().remove()}}]),e}(s.Chart)},{"./chart":1,"./utils":5}],5:[function(t,e,i){"use strict";function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();i.Utils=function(){function t(){n(this,t)}return a(t,null,[{key:"deepExtend",value:function(t){var e=this;!t&&arguments.length>1&&Array.isArray(arguments[1])&&(t=[]),t=t||{};for(var i=1;i<arguments.length;i++){var o=arguments[i];if(o)for(var n in o)if(o.hasOwnProperty(n)){var r=Array.isArray(t[n]),a=e.isObject(t[n]),l=e.isObject(o[n]);a&&!r&&l?e.deepExtend(t[n],o[n]):t[n]=o[n]}}return t}},{key:"mergeDeep",value:function(e,i){var n=Object.assign({},e);return t.isObjectNotArray(e)&&t.isObjectNotArray(i)&&Object.keys(i).forEach(function(r){t.isObjectNotArray(i[r])&&r in e?n[r]=t.mergeDeep(e[r],i[r]):Object.assign(n,o({},r,i[r]))}),n}},{key:"cross",value:function(t,e){var i,o,n=[],r=t.length,a=e.length;for(i=-1;++i<r;)for(o=-1;++o<a;)n.push({x:t[i],i:i,y:e[o],j:o});return n}},{key:"inferVariables",value:function(t,e,i){var o=[];if(t.length){var n=t[0];if(n instanceof Array)o=n.map(function(t,e){return e});else if("object"===("undefined"==typeof n?"undefined":r(n)))for(var a in n)n.hasOwnProperty(a)&&o.push(a)}if(!i){var l=o.indexOf(e);l>-1&&o.splice(l,1)}return o}},{key:"isObjectNotArray",value:function(t){return t&&"object"===("undefined"==typeof t?"undefined":r(t))&&!Array.isArray(t)&&null!==t}},{key:"isObject",value:function(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":r(t))}},{key:"isNumber",value:function(t){return!isNaN(t)&&"number"==typeof t}},{key:"isFunction",value:function(t){return"function"==typeof t}},{key:"selectOrAppend",value:function(t,e,i){var o=t.select(e);return o.empty()?t.append(i||e):o}}]),t}()},{}]},{},[2])(2)});
//# sourceMappingURL=odc-d3.min.js.map
